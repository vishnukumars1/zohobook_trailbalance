{% extends 'base.html' %}
{% block content %}
{% load static %}

<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<style>
  .modal{
    z-index: 9999;
    overflow: scroll;
  }

  .form-group{
    width: 100%;
  }

  .row:after {
    content: "";
    display: table;
    clear: both;
  }
  
  @media screen and (max-width: 600px) {
    .col-25, .col-75, input[type=submit] {
      width: 100%;
      margin-top: 0;
    }

    input[type=text], select, textarea {
      width: 100%;
    }
  }

  .dropdown input,
  .dropdown button {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
  }

  .dropdown.open input,
  .dropdown.open button {
    display: block;
  }

  .row a{
    color: rgb(218, 164, 48);
    font-size: 12px;
  }

  .table th a{
    color:rgb(218, 164, 48);
    font-size: 11px;
    margin-left: 100px;
  }

  ::-webkit-scrollbar {
    display: none;
  }

  ::-webkit-scrollbar-track {
    background: #f1f1f1; 
  }

  ::-webkit-scrollbar-thumb {
    background: #888; 
  }

  ::-webkit-scrollbar-thumb:hover {
    background: #555; 
  }

  .item{
    height: auto;
  }

  .labels{
    color: white; 
    font-size:2.5vh; 
    font-weight: bolder;
  }

  .btn-outline-warning:hover {
    color: black !important;
    font-weight: bold;
  }
  .modal{
      z-index: 9999;
      overflow: scroll;
    }
    /* width */
    ::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #888;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }

    .hide {
        display: none;
    }
    .hidden {
      display: none;
  }
  .selectize-input.full {
    background-color:rgb(45, 44, 44) !important;
    color: white !important;
    border: 1px solid rgba(246, 241, 241, 0.35) !important;
   }
   
    .popup-0 {
      height: 17rem;
      width: 20rem;
      background-color: rgb(3, 3, 3);
      border-radius: 1rem;
      position: absolute;
      margin-bottom:70rem;
      left: 0%;
      transform: translate(-50%, -50%)scale(0.1);
      text-align: center;
      padding: 0 5rem 5 rem;
      color: black;
      
      visibility: hidden;
      transform: translate(-50%, -50%)scale(0.1);

    }

    .open-popup-3 {
      margin-top: -30rem;
      visibility: visible;
      transform: translate(-50%, -50%)scale(1);
      transition: transform 0.4s, top 0.4s;
      margin-left: 40rem;
    background-color: #000;
    }
    ::placeholder {
      color: rgb(238, 230, 230); /* Change this to the desired color */
    }
    label {
      color:white; /* Change this to the desired color */
    }
    input[type="text"],
input[type="number"],
input[type="email"],
input[type="date"] {
  color: white; /* Change this to the desired color */
}
label{
        color: white;
    }
    .section-3
    {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
        margin-top: 1rem;
    }
    .section-3 .section-toggle
    {
        margin-bottom: 0.50rem;
    }
     .section-toggle a
    {
  
        color: rgb(230, 171, 45);
        font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
        font-size:1.275rem;
    }
    .add_another
    {
       
        color: rgb(230, 171, 45);
    }
    #tbl thead th{
        font-size: 0.785rem;
    }
    @media (max-width:700px)
    {
    .section-3
    {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr ;  
  
    }
    .section-3 .section-toggle a
    {
  
        color: rgb(230, 171, 45);
        font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
        font-size:0.875rem;
    }
    }

</style>

<div class="body-wrapper">
  <div class="container-fluid">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>
        <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Purchase</a></li>
        <li class="breadcrumb-item"><a href="{% url 'expense' %}" class="text-warning-emphasis">Expense</a></li>
        <li class="breadcrumb-item" aria-current="page">Edit</li>
      </ol>
    </nav>
      <div class="row mt-5">
          <div class="col-md-12">
            <div class="card mb-5 p-5" style="background-color: black; border-radius: 1vh;">
              <h1 class="mb-0 text-uppercase text-right" style="color: white; font-weight: bolder;">Edit &nbsp; Expense</h1><br>
              <hr class="text-warning">
              <form action="{% url 'edit_expense1' edit.id %}" method="post" enctype="multipart/form-data"id="myForm">
                {% csrf_token %}
                <div class="row">
                  <label for="date" class="col-md-3 p-3 labels">Expense Date</label>
                  <div class="col-md-6 p-3">
                    <input type="date" class="form-control text-white bg-black" value="{{edit.date|date:'Y-m-d' }}" id="date" name="date" required>
                  </div>
                </div>
                
                <div class="row">
                    <label for="account" class="col-md-3 p-3 labels">Expense Account</label>
                    <div class="col-md-6 p-3">
                        <select class="form-control form-select text-white bg-black" id="account" name="account" required>
                            <option value="" style="color: white;">Select accounts</option>
                            {% for v in account %}
                            <option value="{{ v.account_name }}" {% if edit.account == v.account_name %}selected{% endif %}>
                                {{ v.account_name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            
                <div class="row">
                    <label for="expense_type" class="col-md-3 p-3 labels">Expense Type</label>
                    <div class="col-md-6 p-3">
                        <select class="form-control text-white bg-black" id="expense_type" name="expense_type" style="color: white;" >
                            <option style="background-color: black;" value="">Select Expense Type</option>
                            <option style="background-color: black;" value="goods" {% if edit.expense_type == 'goods' %} selected {% endif %}>Goods</option>
                            <option style="background-color: black;" value="service" {% if edit.expense_type == 'service' %} selected {% endif %}>Service</option>
                        </select>
                    </div>
                </div>
            
                <div class="row" id="hsnField" style="display: none;">
                    <label for="hsn_code" class="col-md-3 p-3 labels">HSN Code</label>
                    <div class="col-md-6 p-3">
                        <input type="text" class="form-control text-white bg-black" value="{{edit.hsn_code}}" id="hsn_code" name="hsn_code">
                    </div>
                </div>
            
                <div class="row" id="sacField" style="display: none;">
                    <label for="sac_code" class="col-md-3 p-3 labels">SAC Code</label>
                    <div class="col-md-6 p-3">
                        <input type="text" class="form-control text-white bg-black" value="{{edit.sac_code}}" id="sac_code" name="sac_code">
                    </div>
                </div>
            
              
            
                <div class="row">
                    <label for="expense_number" class="col-md-3 p-3 labels">Expense Number</label>
                    <div class="col-md-6 p-3">
                        <input type="text" class="form-control text-white bg-black" id="expense_number" value="{{edit.expense_number}}" name="expense_number">
                    </div>
                </div>
            
                <div class="row">
                    <label for="reference_number" class="col-md-3 p-3 labels">Reference Number</label>
                    <div class="col-md-6 p-3">
                        <input type="text" class="form-control text-white bg-black" id="reference_number" value="{{edit.reference_number}}" name="reference_number">
                    </div>
                </div>
            
                <div class="row">
                    <label for="amount" class="col-md-3 p-3 labels">Amount</label>
                    <div class="col-md-6 p-3">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <select class="form-control form-select text-white bg-black" id="currency" name="currency">
                                    <option value="inr" {% if edit.currency == 'inr' %} selected {% endif %}>INR</option>
                                    <option value="usd" {% if edit.currency == 'usd' %} selected {% endif %}>USD</option>
                                    <option value="srl" {% if edit.currency == 'srl' %} selected {% endif %}>SRL</option>
                                </select>
                            </div>
                           
                            <input type="number" class="form-control text-white bg-black" id="amount" value="{{edit.amount}}" name="amount">
                            
                        </div>
                    </div>
                </div>
            
                <div class="row">
                    <label for="tax_rate" class="col-md-3 p-3 labels">TAX Rate</label>
                    <div class="col-md-6 p-3">
                        <select class="form-control form-select text-white bg-black" id="tax_rate" name="tax_rate">
                            <option value="">-- Select Tax --</option>
                            <option value="0" {% if edit.tax_rate == '0' %}selected{% endif %}>GST0[0%]</option>
                            <option value="3" {% if edit.tax_rate == '3' %}selected{% endif %}>GST3[3%]</option>
                            <option value="5" {% if edit.tax_rate == '5' %}selected{% endif %}>GST5[5%]</option>
                            <option value="12" {% if edit.tax_rate == '12' %}selected{% endif %}>GST12[12%]</option>
                            <option value="18" {% if edit.tax_rate == '18' %}selected{% endif %}>GST18[18%]</option>
                            <option value="28" {% if edit.tax_rate == '28' %}selected{% endif %}>GST28[28%]</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <label for="payment_type" class="col-md-3 p-3 labels">Payment Method</label>
                    <div class="col-md-6 p-3">
                        <select class="form-control form-select" name="payment_type" id="payment_type_select" onchange="showFields()">
                            <option value="cash" {% if edit.payment_type == 'cash' %}selected{% endif %}>Cash</option>
                            <option value="Cheque" {% if edit.payment_type == 'Cheque' %}selected{% endif %}>Cheque</option>
                            <option value="UPI" {% if edit.payment_type == 'UPI' %}selected{% endif %}>UPI</option>
                            {% for i in bank %}
                            <option value="{{ i.bnk_name }}" {% if edit.payment_type == i.bnk_name %}selected{% endif %}>{{ i.bnk_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                
                <div class="row dynamic-row" id="cheque_no_row" style="display: none;">
                    <label for="cheque_no" class="col-md-3 p-3 labels">Cheque Number</label>
                    <div class="col-md-6 p-3">
                        <input type="text" class="form-control" id="cheque_no" name="check_no" value="{{ edit.checkno }}">
                    </div>
                </div>
                
                <div class="row dynamic-row" id="upi_id_row" style="display: none;">
                    <label for="upi_id" class="col-md-3 p-3 labels">UPI ID</label>
                    <div class="col-md-6 p-3">
                        <input type="text" class="form-control" id="upi_id" name="upi_id" value="{{ edit.upi }}">
                    </div>
                </div>
                
                <div class="row dynamic-row" id="acc_no_row" style="display: none;">
                    <label for="acc_no" class="col-md-3 p-3 labels">Ac/Number</label>
                    <div class="col-md-6 p-3">
                        
                        <input type="text" class="form-control" id="acc_no" name="acc_no" value="{{ edit.bankaccno }}">
                      
                    </div>
                </div>
                
                
                <script>
                 document.addEventListener("DOMContentLoaded", function() {
    showFields();
});

function showFields() {
    var paymentType = document.getElementById("payment_type_select").value;
    document.getElementById("cheque_no_row").style.display = paymentType === "Cheque" ? "flex" : "none";
    document.getElementById("upi_id_row").style.display = paymentType === "UPI" ? "flex" : "none";
    document.getElementById("acc_no_row").style.display = (paymentType !== "cash" && paymentType !== "Cheque" && paymentType !== "UPI") ? "flex" : "none";
}

                </script>
                <br>
                <h5 class="mb-0 text-uppercase text-right" style="color: white; font-weight: bolder;">Vendor &nbsp; Details</h5>
                <hr class="text-warning">
                <div class="row">
                  <div class="col-md-3">
                      <label for="" class="labels">Vendor</label>
                      <br>
                      <span class="text-danger" id="vendErr"></span>
                  </div>
                  <div class="col-md-6">
                      <input type="hidden" name="vendorId" id="vendorId" value="">
                      <div class="d-flex">
                          <div class="w-100">
                              <div class="p-0 border-0 bg-none position-relative drop-box">
                                  <input  type="text" id="vendor"  value="{{edit.vendor_name }}"  name="vendor_name" class="dropdown-toggle form-control text-white customers-display" onkeyup="filtervendor()" data-bs-toggle="dropdown" aria-expanded="false" placeholder="Select Vendor.." autocomplete="off">
                                  <ul class="dropdown-menu w-100 customers-available position-absolute bg-black text-white" id="vend_drop" style="overflow-y: auto; height: fit-content; max-height: 40vh; border: 1px solid rgb(245, 242, 242);">
                                      <li class="dropdown-item customers-options text-white" onclick="getvendorDetails('', '')">Select Vendor</li>
                                      {% for cust in v %}
                                      <li class="dropdown-item customers-options text-white" onclick="getvendorDetails('{{ cust.id }}', this.innerHTML)">{{ cust.title }} {{ cust.first_name }} {{ cust.last_name }}</li>
                                      {% endfor %}
                                  </ul>
                              </div>
                          </div>
                          <button type="button" data-toggle="modal" data-target="#newVendor" class="btn btn-outline-warning py-2 ms-1">+</button>
                      </div>
                  </div>
              </div>
              
              <div class="row mt-2">
                  <label for="" class="col-md-3 labels">Email</label>
                  <div class="col-md-6">
                      <input type="text" class="form-control text-white bg-black" id="vendorEmail" value="{{edit.vendor_email }}" name="vendor_email" readonly>
                  </div>
              </div>
              
              <div class="row mt-2">
                  <label for="" class="col-md-3 labels">GST Type</label>
                  <div class="col-md-6">
                      <input type="text" class="form-control text-white bg-black" value="{{edit.vendor_gst_type }}" id="vendorGstType" name="vendor_gst_type" readonly>
                  </div>
              </div>
              
              <div class="row mt-2" id="vendorGstInDisplay" style="display: flex;">
                  <label for="" class="col-md-3 labels">GSTIN</label>
                  <div class="col-md-6">
                      <input type="text" class="form-control text-white bg-black" value="{{edit.vendor_gstin }}" id="vendorGSTIN" name="vendor_gstin" readonly>
                  </div>
              </div>
              
              <div class="row mt-2" id="vbillAddressSection">
                <label for="" class="col-md-3 labels">Billing Address</label>
                <div class="col-md-6">
                    <textarea class="form-control text-white bg-black" name="vendor_billing_address" id="vbillAddress" rows="4" readonly>{{ edit.vendor_billing_address }}</textarea>
                </div>
            </div>
              
              
      <div class="row mt-2">
        <label for="" class="col-md-3 labels">Source of Supply</label>
        <div class="col-md-6">
            <input type="hidden" value="{{ cmp.state }}" id="cmpstate">
            <select name="vendor_source_of_supply" id="sourceOfSupply" class="form-control bg-black text-white">
                <option value="" {% if not edit.vendor_source_of_supply %}selected{% endif %}>Select Place of Supply</option>
                <option value="[AN]-Andaman And Nicobar Islands" {% if edit.vendor_source_of_supply == "[AN]-Andaman And Nicobar Islands" %}selected{% endif %}>[AN]-Andaman And Nicobar Islands</option>
                <option value="[AD]-Andhra Pradesh" {% if edit.vendor_source_of_supply == "[AD]-Andhra Pradesh" %}selected{% endif %}>[AD]-Andhra Pradesh</option>
                <option value="[AR]-Arunachal Pradesh" {% if edit.vendor_source_of_supply == "[AR]-Arunachal Pradesh" %}selected{% endif %}>[AR]-Arunachal Pradesh</option>
                <option value="[AS]-Assam" {% if edit.vendor_source_of_supply == "[AS]-Assam" %}selected{% endif %}>[AS]-Assam</option>
                <option value="[BR]-Bihar" {% if edit.vendor_source_of_supply == "[BR]-Bihar" %}selected{% endif %}>[BR]-Bihar</option>
                <option value="[CH]-Chandhigarh" {% if edit.vendor_source_of_supply == "[CH]-Chandhigarh" %}selected{% endif %}>[CH]-Chandhigarh</option>
                <option value="[CG]-Chattisgarh" {% if edit.vendor_source_of_supply == "[CG]-Chattisgarh" %}selected{% endif %}>[CG]-Chattisgarh</option>
                <option value="[DD]-Daman Diu" {% if edit.vendor_source_of_supply == "[DD]-Daman Diu" %}selected{% endif %}>[DD]-Daman Diu</option>
                <option value="[DL]-Delhi" {% if edit.vendor_source_of_supply == "[DL]-Delhi" %}selected{% endif %}>[DL]-Delhi</option>
                <option value="[GA]-Goa" {% if edit.vendor_source_of_supply == "[GA]-Goa" %}selected{% endif %}>[GA]-Goa</option>
                <option value="[GJ]-Gujarat" {% if edit.vendor_source_of_supply == "[GJ]-Gujarat" %}selected{% endif %}>[GJ]-Gujarat</option>
                <option value="[HR]-Haryana" {% if edit.vendor_source_of_supply == "[HR]-Haryana" %}selected{% endif %}>[HR]-Haryana</option>
                <option value="[HP]-Himachal Pradesh" {% if edit.vendor_source_of_supply == "[HP]-Himachal Pradesh" %}selected{% endif %}>[HP]-Himachal Pradesh</option>
                <option value="[JK]-Jammu And Kashmir" {% if edit.vendor_source_of_supply == "[JK]-Jammu And Kashmir" %}selected{% endif %}>[JK]-Jammu And Kashmir</option>
                <option value="[JH]-Jharkand" {% if edit.vendor_source_of_supply == "[JH]-Jharkand" %}selected{% endif %}>[JH]-Jharkand</option>
                <option value="[KA]-Karnataka" {% if edit.vendor_source_of_supply == "[KA]-Karnataka" %}selected{% endif %}>[KA]-Karnataka</option>
                <option value="[KL]-Kerala" {% if edit.vendor_source_of_supply == "[KL]-Kerala" %}selected{% endif %}>[KL]-Kerala</option>
                <option value="[LA]-Ladakh" {% if edit.vendor_source_of_supply == "[LA]-Ladakh" %}selected{% endif %}>[LA]-Ladakh</option>
                <option value="[LD]-Lakshadweep" {% if edit.vendor_source_of_supply == "[LD]-Lakshadweep" %}selected{% endif %}>[LD]-Lakshadweep</option>
                <option value="[MP]-Madhyapradesh" {% if edit.vendor_source_of_supply == "[MP]-Madhyapradesh" %}selected{% endif %}>[MP]-Madhyapradesh</option>
                <option value="[MH]-Maharashtra" {% if edit.vendor_source_of_supply == "[MH]-Maharashtra" %}selected{% endif %}>[MH]-Maharashtra</option>
                <option value="[MN]-Manipur" {% if edit.vendor_source_of_supply == "[MN]-Manipur" %}selected{% endif %}>[MN]-Manipur</option>
                <option value="[ML]-Meghalaya" {% if edit.vendor_source_of_supply == "[ML]-Meghalaya" %}selected{% endif %}>[ML]-Meghalaya</option>
                <option value="[MZ]-Mizoram" {% if edit.vendor_source_of_supply == "[MZ]-Mizoram" %}selected{% endif %}>[MZ]-Mizoram</option>
                <option value="[NL]-Nagaland" {% if edit.vendor_source_of_supply == "[NL]-Nagaland" %}selected{% endif %}>[NL]-Nagaland</option>
                <option value="[OD]-Odisha" {% if edit.vendor_source_of_supply == "[OD]-Odisha" %}selected{% endif %}>[OD]-Odisha</option>
                <option value="[PY]-Puducherry" {% if edit.vendor_source_of_supply == "[PY]-Puducherry" %}selected{% endif %}>[PY]-Puducherry</option>
                <option value="[PB]-Punjab" {% if edit.vendor_source_of_supply == "[PB]-Punjab" %}selected{% endif %}>[PB]-Punjab</option>
                <option value="[RL]-Rajasthan" {% if edit.vendor_source_of_supply == "[RL]-Rajasthan" %}selected{% endif %}>[RL]-Rajasthan</option>
                <option value="[SK]-Sikkim" {% if edit.vendor_source_of_supply == "[SK]-Sikkim" %}selected{% endif %}>[SK]-Sikkim</option>
                <option value="[TN]-Tamilnadu" {% if edit.vendor_source_of_supply == "[TN]-Tamilnadu" %}selected{% endif %}>[TN]-Tamilnadu</option>
                <option value="[TS]-Telenghana" {% if edit.vendor_source_of_supply == "[TS]-Telenghana" %}selected{% endif %}>[TS]-Telenghana</option>
                <option value="[TR]-Tripura" {% if edit.vendor_source_of_supply == "[TR]-Tripura" %}selected{% endif %}>[TR]-Tripura</option>
                <option value="[UP]-Uttar Pradesh" {% if edit.vendor_source_of_supply == "[UP]-Uttar Pradesh" %}selected{% endif %}>[UP]-Uttar Pradesh</option>
                <option value="[UK]-Utharakhand" {% if edit.vendor_source_of_supply == "[UK]-Utharakhand" %}selected{% endif %}>[UK]-Utharakhand</option>
                <option value="[WB]-West Bengal" {% if edit.vendor_source_of_supply == "[WB]-West Bengal" %}selected{% endif %}>[WB]-West Bengal</option>
                <option value="[OT]-Other Territory" {% if edit.vendor_source_of_supply == "[OT]-Other Territory" %}selected{% endif %}>[OT]-Other Territory</option>
            </select>
        </div>
    </div>
              <script>
                
             function getvendorDetails(vendId, name) {
            $('#vendor').val(name);
            console.log('name', name);
            if ($('#vendor').val() != "") {
                $('#vendErr').text('');
                $.ajax({
                    type: 'POST',
                    url: "{% url 'getvendorDetailsAjax' %}",
                    data: {
                        id: vendId,
                        csrfmiddlewaretoken: '{{ csrf_token }}',
                    },
                    success: function(data) {
                        console.log('AJAX-Response-->', data);
                        document.getElementById('vendorId').value = data.idv;
                        document.getElementById('vendorEmail').value = data.vemail; 
                        document.getElementById('sourceOfSupply').value = data.vshipState;
                        document.getElementById('vendorGstType').value = data.vgstType;
                        document.getElementById('vendorGSTIN').value = data.vgstNo;

                        // Handle Billing Address
                        if (data.vstreet || data.vcity || data.vstate) {
                            $('#vbillAddressSection').show();
                            document.getElementById('vbillAddress').value = 
                                (data.vstreet ? data.vstreet + ', ' : '') + 
                                (data.vcity ? data.vcity + '\n' : '') + 
                                (data.vstate ? data.vstate + '\n' : '') + 
                                (data.vcountry ? data.vcountry + '\n' : '') + 
                                (data.vpincode ? data.vpincode : '');
                        } else {
                            $('#vbillAddressSection').hide();
                        }

                        // Handle GSTIN
                        if (data.vgstNo) {
                            $('#vendorGstInDisplay').show();
                        } else {
                            $('#vendorGstInDisplay').hide();
                        }

                        // Handle Source of Supply
                        if (data.vshipState) {
                            $('#vendorsourceOfSupplySection').show();
                        } else {
                            $('#vendorsourceOfSupplySection').hide();
                        }

                        $('#applyPriceList').prop('checked', false); // Uncheck the applyPriceList checkbox
                        refreshTax();
                        checkPriceList();
                    }
                });
            } else {
                document.getElementById('vendorEmail').value = "";
                document.getElementById('sourceOfSupply').value = "";
                document.getElementById('vendorGstType').value = "";
                document.getElementById('vbillAddress').value = "";
                document.getElementById('vendorGSTIN').value = "";
                $('#vendErr').text('Select a customer..');
            }
        }


              
              
              </script>
              <script>
                window.onload = function() {
                  // Check if fields are null and hide them if necessary
                  if (!document.getElementById('vendorEmail').value) {
                    document.getElementById('vendorEmailSection').style.display = 'none';
                  }
                  if (!document.getElementById('vendorGstType').value) {
                    document.getElementById('vendorGstTypeSection').style.display = 'none';
                  }
                  if (!document.getElementById('vendorGSTIN').value) {
                    document.getElementById('vendorGstInDisplay').style.display = 'none';
                  }
                  if (!document.getElementById('vbillAddress').value) {
                    document.getElementById('vbillAddressSection').style.display = 'none';
                  }
                  if (!document.getElementById('sourceOfSupply').value) {
                    document.getElementById('sourceOfSupplySection').style.display = 'none';
                  }
                  if (!document.getElementById('customerEmail').value) {
            document.getElementById('customerEmailSection').style.display = 'none';
        }
        if (!document.getElementById('customerGstType').value) {
            document.getElementById('customerGstTypeSection').style.display = 'none';
        }
        if (!document.getElementById('customerGSTIN').value) {
            document.getElementById('customerGstInDisplay').style.display = 'none';
        }
        if (!document.getElementById('billAddress').value) {
            document.getElementById('billAddressSection').style.display = 'none';
        }
        if (!document.getElementById('placeOfSupply').value) {
            document.getElementById('sourceOfSupplySection').style.display = 'none';
        }
    };
              </script>
              
              
              
                              
                            
                              <br>
              
                <br>
                <h5 class="mb-0 text-uppercase text-right" style="color: white; font-weight: bolder;">Customer &nbsp; Details</h5>
                <hr class="text-warning">
                <div class="row mt-2">
                  <div class="col-md-3">
                      <label for="" class="labels">Customer</label>
                      <br>
                      <span class="text-danger" id="custErr"></span>
                  </div>
                  <div class="col-md-6">
                      <input type="hidden" name="customerId" id="customerId" value="">
                      <div class="d-flex">
                          <div class="w-100">
                              <div class="p-0 border-0 bg-none position-relative drop-box">
                                  <input  type="text" id="customer" value="{{edit.customer_name }}" name="customer_name" class="dropdown-toggle form-control text-white customers-display" onkeyup="filterCustomers()" data-bs-toggle="dropdown" aria-expanded="false" placeholder="Select Customer.." autocomplete="off">
                                  <ul class="dropdown-menu w-100 customers-available position-absolute bg-black text-white" id="cust_drop" style="overflow-y: auto; height: fit-content; max-height: 40vh; border: 1px solid rgb(245, 242, 242);">
                                      <li class="dropdown-item customers-options text-white" onclick="getCustomerDetails('', '')">Select Customer</li>
                                      {% for cust in c %}
                                      <li class="dropdown-item customers-options text-white" onclick="getCustomerDetails('{{ cust.id }}', this.innerHTML)">{{ cust.title }} {{ cust.first_name }} {{ cust.last_name }}</li>
                                      {% endfor %}
                                  </ul>
                              </div>
                          </div>
                          <button type="button" data-toggle="modal" data-target="#newCustomer" class="btn btn-outline-warning py-2 ms-1">+</button>
                      </div>
                  </div>
              </div>
              
              <div class="row mt-2">
                  <label for="" class="col-md-3 labels">Email</label>
                  <div class="col-md-6">
                      <input type="text" class="form-control text-white bg-black" id="customerEmail" value="{{edit.customer_email }}" name="customer_email" readonly>
                  </div>
              </div>
              
              <div class="row mt-2">
                  <label for="" class="col-md-3 labels">GST Type</label>
                  <div class="col-md-6">
                      <input type="text" class="form-control text-white bg-black" id="customerGstType" value="{{edit.customer_gst_type }}" name="customer_gst_type" readonly>
                  </div>
              </div>
              
              <div class="row mt-2" id="customerGstInDisplay" style="display: flex;">
                  <label for="" class="col-md-3 labels">GSTIN</label>
                  <div class="col-md-6">
                      <input type="text" class="form-control text-white bg-black" value="{{edit.customer_gstin }}" id="customerGSTIN" name="customer_gstin" readonly>
                  </div>
              </div>
              
              <div class="row mt-2" id="billAddressSection">
                <label for="" class="col-md-3 labels">Billing Address</label>
                <div class="col-md-6">
                    <textarea class="form-control text-white bg-black" name="customer_billing_address" id="billAddress" rows="4" readonly>{{ edit.customer_billing_address }}</textarea>
                </div>
            </div>
              
              <div class="row mt-2">
                <label for="" class="col-md-3 labels">Place of Supply</label>
                <div class="col-md-6">
                    <input type="hidden" value="{{ cmp.state }}" id="cmpstate">
                    <select name="customer_price_of_supply" id="placeOfSupply" class="form-control bg-black text-white">
                        <option value="" {% if not edit.customer_price_of_supply %}selected{% endif %}>Select Place of Supply</option>
                        <option value="[AN]-Andaman And Nicobar Islands" {% if edit.customer_price_of_supply == "[AN]-Andaman And Nicobar Islands" %}selected{% endif %}>[AN]-Andaman And Nicobar Islands</option>
                        <option value="[AD]-Andhra Pradesh" {% if edit.customer_price_of_supply == "[AD]-Andhra Pradesh" %}selected{% endif %}>[AD]-Andhra Pradesh</option>
                        <option value="[AR]-Arunachal Pradesh" {% if edit.customer_price_of_supply == "[AR]-Arunachal Pradesh" %}selected{% endif %}>[AR]-Arunachal Pradesh</option>
                        <option value="[AS]-Assam" {% if edit.customer_price_of_supply == "[AS]-Assam" %}selected{% endif %}>[AS]-Assam</option>
                        <option value="[BR]-Bihar" {% if edit.customer_price_of_supply == "[BR]-Bihar" %}selected{% endif %}>[BR]-Bihar</option>
                        <option value="[CH]-Chandhigarh" {% if edit.customer_price_of_supply == "[CH]-Chandhigarh" %}selected{% endif %}>[CH]-Chandhigarh</option>
                        <option value="[CG]-Chattisgarh" {% if edit.customer_price_of_supply == "[CG]-Chattisgarh" %}selected{% endif %}>[CG]-Chattisgarh</option>
                        <option value="[DD]-Daman Diu" {% if edit.customer_price_of_supply == "[DD]-Daman Diu" %}selected{% endif %}>[DD]-Daman Diu</option>
                        <option value="[DL]-Delhi" {% if edit.customer_price_of_supply == "[DL]-Delhi" %}selected{% endif %}>[DL]-Delhi</option>
                        <option value="[GA]-Goa" {% if edit.customer_price_of_supply == "[GA]-Goa" %}selected{% endif %}>[GA]-Goa</option>
                        <option value="[GJ]-Gujarat" {% if edit.customer_price_of_supply == "[GJ]-Gujarat" %}selected{% endif %}>[GJ]-Gujarat</option>
                        <option value="[HR]-Haryana" {% if edit.customer_price_of_supply == "[HR]-Haryana" %}selected{% endif %}>[HR]-Haryana</option>
                        <option value="[HP]-Himachal Pradesh" {% if edit.customer_price_of_supply == "[HP]-Himachal Pradesh" %}selected{% endif %}>[HP]-Himachal Pradesh</option>
                        <option value="[JK]-Jammu And Kashmir" {% if edit.customer_price_of_supply == "[JK]-Jammu And Kashmir" %}selected{% endif %}>[JK]-Jammu And Kashmir</option>
                        <option value="[JH]-Jharkand" {% if edit.customer_price_of_supply == "[JH]-Jharkand" %}selected{% endif %}>[JH]-Jharkand</option>
                        <option value="[KA]-Karnataka" {% if edit.customer_price_of_supply == "[KA]-Karnataka" %}selected{% endif %}>[KA]-Karnataka</option>
                        <option value="[KL]-Kerala" {% if edit.customer_price_of_supply == "[KL]-Kerala" %}selected{% endif %}>[KL]-Kerala</option>
                        <option value="[LA]-Ladakh" {% if edit.customer_price_of_supply == "[LA]-Ladakh" %}selected{% endif %}>[LA]-Ladakh</option>
                        <option value="[LD]-Lakshadweep" {% if edit.customer_price_of_supply == "[LD]-Lakshadweep" %}selected{% endif %}>[LD]-Lakshadweep</option>
                        <option value="[MP]-Madhyapradesh" {% if edit.customer_price_of_supply == "[MP]-Madhyapradesh" %}selected{% endif %}>[MP]-Madhyapradesh</option>
                        <option value="[MH]-Maharashtra" {% if edit.customer_price_of_supply == "[MH]-Maharashtra" %}selected{% endif %}>[MH]-Maharashtra</option>
                        <option value="[MN]-Manipur" {% if edit.customer_price_of_supply == "[MN]-Manipur" %}selected{% endif %}>[MN]-Manipur</option>
                        <option value="[ML]-Meghalaya" {% if edit.customer_price_of_supply == "[ML]-Meghalaya" %}selected{% endif %}>[ML]-Meghalaya</option>
                        <option value="[MZ]-Mizoram" {% if edit.customer_price_of_supply == "[MZ]-Mizoram" %}selected{% endif %}>[MZ]-Mizoram</option>
                        <option value="[NL]-Nagaland" {% if edit.customer_price_of_supply == "[NL]-Nagaland" %}selected{% endif %}>[NL]-Nagaland</option>
                        <option value="[OD]-Odisha" {% if edit.customer_price_of_supply == "[OD]-Odisha" %}selected{% endif %}>[OD]-Odisha</option>
                        <option value="[PY]-Puducherry" {% if edit.customer_price_of_supply == "[PY]-Puducherry" %}selected{% endif %}>[PY]-Puducherry</option>
                        <option value="[PB]-Punjab" {% if edit.customer_price_of_supply == "[PB]-Punjab" %}selected{% endif %}>[PB]-Punjab</option>
                        <option value="[RL]-Rajasthan" {% if edit.customer_price_of_supply == "[RL]-Rajasthan" %}selected{% endif %}>[RL]-Rajasthan</option>
                        <option value="[SK]-Sikkim" {% if edit.customer_price_of_supply == "[SK]-Sikkim" %}selected{% endif %}>[SK]-Sikkim</option>
                        <option value="[TN]-Tamilnadu" {% if edit.customer_price_of_supply == "[TN]-Tamilnadu" %}selected{% endif %}>[TN]-Tamilnadu</option>
                        <option value="[TS]-Telenghana" {% if edit.customer_price_of_supply == "[TS]-Telenghana" %}selected{% endif %}>[TS]-Telenghana</option>
                        <option value="[TR]-Tripura" {% if edit.customer_price_of_supply == "[TR]-Tripura" %}selected{% endif %}>[TR]-Tripura</option>
                        <option value="[UP]-Uttar Pradesh" {% if edit.customer_price_of_supply == "[UP]-Uttar Pradesh" %}selected{% endif %}>[UP]-Uttar Pradesh</option>
                        <option value="[UK]-Utharakhand" {% if edit.customer_price_of_supply == "[UK]-Utharakhand" %}selected{% endif %}>[UK]-Utharakhand</option>
                        <option value="[WB]-West Bengal" {% if edit.customer_price_of_supply == "[WB]-West Bengal" %}selected{% endif %}>[WB]-West Bengal</option>
                        <option value="[OT]-Other Territory" {% if edit.customer_price_of_supply == "[OT]-Other Territory" %}selected{% endif %}>[OT]-Other Territory</option>
                    </select>
                </div>
            </div>
            
              <script>
                function filterCustomers() {
                    var options = $('#cust_drop').children();
                    var search_text = $("#customer").val().toLowerCase();
                    options.each(function() {
                        if ($(this).text().toLowerCase().includes(search_text)) {
                            $(this).show();
                        } else {
                            $(this).hide();
                        }
                    });
                }
            
                function getCustomerDetails(custId, name) {
    $('#customer').val(name);
    console.log('name', name);
    if ($('#customer').val() != "") {
        $('#custErr').text('');
        $.ajax({
            type: 'POST',
            url: "{% url 'getCustomerDetailsAjax' %}",
            data: {
                id: custId,
                csrfmiddlewaretoken: '{{ csrf_token }}',
            },
            success: function(data) {
                console.log('AJAX-Response-->', data);
                $('#customerId').val(data.id);
                $('#customerEmail').val(data.email);
                $('#placeOfSupply').val(data.shipState);
                $('#customerGstType').val(data.gstType);

                // Always show the billing address section
                $('#billAddressSection').show();
                if (data.street || data.city || data.state) {
                    $('#billAddress').val(data.street + ', ' + data.city + '\n' + data.state + '\n' + data.country + '\n' + data.pincode);
               
                } else {
                    $('#billAddressSection').hide();
                    $('#billAddress').val('');
                }


                if (data.gstin) {
                    $('#customerGstInDisplay').show();
                    $('#customerGSTIN').val(data.gstNo);
                } else {
                    $('#customerGstInDisplay').hide();
                    $('#customerGSTIN').val('');
                }

                $('#applyPriceList').prop('checked', false);
                refreshTax();
                checkPriceList();
            }
        });
    } else {
        $('#customerEmail').val("");
        $('#placeOfSupply').val("");
        $('#customerGstType').val("");
        $('#billAddress').val("");
        $('#customerGSTIN').val("");
        $('#billAddressSection').show(); // Always show the billing address section
        $('#customerGstInDisplay').hide();
        $('#custErr').text('Select a customer..');
    }
}



            </script>
            
                <div class="row">
                  <label for="avatar" class="col-md-3 p-3 labels">Choose File:</label>
                  <div class="col-md-6 p-3">
                  <input type="file" id="avatar" name="avatar" class="form-control">
                </div>
                </div>
                <div class="row ">
                  <label for="branch" class="col-md-3 p-3 labels">Note</label>
                  <div class="col-md-6 p-3">
                    <input type="text" class="form-control text-white bg-black" value="{{edit.note}}" id="note" name="note">
                  </div>
                </div>
                <br>
                <div class="mb-3 form-check">
                  <input type="checkbox" id="agree" name="agree" class="form-check-input" required>
                  <label class="form-check-label" for="agree">I agree to the terms and conditions</label>
                </div>
                
                

                <br>
                <div class="row">
                    <div class="col-md-6 p-3">
                        <input type="submit" class="btn save_btn mt-2 my-4 mx-2" style="background-color: chocolate; color: white;" value="SAVE" id="save">
                        <button type="button" class="btn save_btn mt-2 my-4 mx-2" style="background-color: chocolate; color: white;" onclick="window.location.href=''" id="cancel">CANCEL</button>
                    </div>
                </div>
              </form>
            </div>
          </div>
      </div>
  </div>
</div>
<!-- vendor creation -->

<div class="modal fade" id="newVendor">
    <div class="modal-dialog modal-xl">
      <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-header px-3" style="background: rgb(32, 35, 37);">
            <h3 class="text-uppercase" style="color: white;">Add Vendor</h3>
            <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="background: rgb(32, 35, 37);">
          <div class="card px-2 py-4" style="background-color: #000;">
            <form id="newVendorForm">
              {% csrf_token %}
              <div class="form-group row mt-3">
                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color: white;">vendor Type</label>
                
                <div class=" col-sm-12 col-md-3 col-lg-3">
                    <input type="radio"  value="Business" name="vendortype" >
                    <label for="Business"> Business</label>
                    &nbsp;&nbsp;&nbsp;
                    <input  type="radio"  value="Individual" name="vendortype" >
                    <label for="Business">Individual</label>
                </div>
              </div>
  
              <div class=" form-group row">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                    <label class="labels">Primary Contact*</label>
                </div>
                <div class="col-sm-12 col-md-1 col-lg-1" >
                    <select id="vendorselect1"  name="vendorsalutation" class="form-control bg-light text-dark mt-2 " >
                    
                        <option value="Mr">Mr</option>
                        <option value="Mrs">Mrs</option>
                        <option value="Ms">Ms</option>
                        <option value="Dr">Dr</option>
  
                    </select> 
                </div>
                <div class="col-sm-12 col-md-2 col-lg-3" >
                    <input  type="text" class="form-control bg-light text-dark mt-2 change-disply " id="vendorfname" name="vendorfirst_name" placeholder="first name" required >
  
                </div>
                <div class="col-sm-12 col-md-2 col-lg-3" >
                    <input type="text" class="form-control bg-light text-dark mt-2 " id="vendorlname" name="vendorlast_name" placeholder="last name" required >
                </div>
              </div>
              <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label class="labels">Customer Display Name</label></div>
                <div class="col-sm-12 col-md-6 col-lg-7">
                    <select class="form-control bg-light text-dark "  name="vvendor_display_name" id="vendorv_display_name">
                    </select> 
                </div>
            </div>
            <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                    <label class="labels">Company Name</label>
                </div>
                <div class="col-sm-12 col-md-6 col-lg-7">
                    <input  type="text" class="form-control bg-light text-dark " id="vendorcompanyName" name="vcompany_name" required>     
                    <div class="invalid-feedback">Please fill out this field.</div>   
                </div>
            </div>
            <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label class="labels">Vendor Email*</label></div>
                <div class="col-sm-12 col-md-6 col-lg-7">
                    <input  type="email" class="form-control bg-light text-dark" name="vvendor_email"  id="vvendor-email"  required> 
                    <span class=" text-danger mt-1" id="vendoremail-message-id" style="font-size: 10px;"></span>   
                </div>
            </div>
  
            
            <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 ">
                    <label class="col-form-label text-white">Vendor phone*</label>
                </div>
                <div class="col-sm-12 col-md-3 col-lg-3">
                    <input id="vendorworkphone"  type="text" class="form-control bg-light text-dark mt-2" pattern="[0-9]{7}"  name="vendorw_phone" placeholder="work phone" required>
                    <span id="vendorwork-phone-message" class="mt-2 " style="font-size: 10px;"></span >
                    <span id="vendorworkphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                    <div class="invalid-feedback"></div>   
                </div>
            
                <div class=" col-sm-12 col-md-3 col-lg-4">
                    <input id="vendormphone"  type="text" pattern="[0-9]{10}" class="form-control bg-light text-dark mt-2"  name="vendorm_phone" placeholder="mobile number" required>
                    <span id="vendorphone-message" class="mt-2 " style="font-size: 10px;"></span >
                    <span id="vendormphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                    <div class="invalid-feedback"></div>
                </div>
  
                <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
  
                <div class="toggle1 section-toggle">
                    <a href="">Add More Details</a>
                </div>
              </div>
  
              <fieldset1 id="more_detail" class="more details" style="display: none;">
                <div class="form-group row mt-4">
                  <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                      <label>Skype name/Number</label>
                  </div>
                  <div class="col-sm-12 col-md-6 col-lg-6">
                      <input  type="text" class="form-control bg-light text-dark" id="vendorskypeNumber" name="vendorskype_number">      
                  </div>
                </div>
  
                <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                        <label>Designation</label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <input  type="text" id="vendordesign" class="form-control bg-light text-dark" name="vendordesignation">      
                    </div>
                </div>
  
                <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                        <label>Department</label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <input  type="text" class="form-control bg-light text-dark" id="vendordept" name="vendordepartment">      
                    </div>
                </div>
       
                <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Website</label></div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <input id="vendorweb" type="text" class="form-control bg-light text-dark" onclick="mobile_phone()"    name="vendorwebsite">      
                    </div>
                </div>
              </fieldset1>
  
              <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
  
              <div class="section-3">
  
                  <div class="toggle2 section-toggle"> <a href="" >Other Details </a> </div>
                  <div class="toggle3 section-toggle" > <a href="">Address </a> </div>
                  <div class="toggle4 section-toggle"><a href="" >Contact Persons </a></div>
                  <div class="toggle7 section-toggle"><a href="">Remarks</a></div>
  
              </div>
  
              <fieldset2 class="other details">
                <div class="form-group row mt-2">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > GST Treatment*</label>
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <select name="vendorgst" id="vendorGSTT" class="form-control bg-light text-dark" onclick="vendorgstPan_function()">
                            <option value="" selected>Select a Gst Treatment</option>
                            <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                            <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">
                                Registered Business-Composition Business that is registered under the Composition schemen in GST
                            </option>
                            <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                            <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                            <option value="Special Economic Zone">Special Economic Zone</option>
                        </select><br>
                    </div>
                </div>
  
                <fieldset3 id="vendorgst" style="display: none;">
                    <div class="row mt-4">
                        <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white">GSTIN/UIN*</label>
                        <div class="col-sm-12 col-md-3 col-lg-3">
                            <input type="text" class="form-control bg-light text-dark" name="vendorgst_number" id="vendorgstInput">
                            <span id="vendorgstMessage"></span>
                        </div>
                    </div>
                </fieldset3>
                
  
                <fieldset4 id="vendorpan" style="display: none;">
                    <div class="row mt-4">
                        <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white">PAN*</label>
                        <div class="col-sm-12 col-md-3 col-lg-3">
                            <input type="text" class="form-control bg-light text-dark" id="vendorpanInput" name="vendorpan_number">
                            <span id="vendorpanMessage" style="color: red; font-size: 12px;"></span>
                        </div>
                    </div>
                </fieldset4>
                <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Source of Supply*</label>
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <select name="vendorsource_supply" id="vendorPLACE" class="form-control bg-light text-dark">
                            <option value="value" selected></option>
                            <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option>
                            <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                            <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> 
                            <option value="volvo">[AS]-Assam</option>
                            <option value="[BR]-Bihar">[BR]-Bihar</option> 
                            <option value="volvo">[CH]-	Chandhigarh</option>
                            <option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                            <option value="[DD]-Daman Diu">[DD]-Daman Diu</option>
                            <option value="volvo">[DL]-	Delhi</option>
                            <option value="[GA]-Goa">[GA]-Goa</option> 
                            <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                            <option value="[HR]-Haryana">[HR]-Haryana</option> 
                            <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                            <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option>
                            <option value="[JH]-Jharkand">[JH]-Jharkand</option>
                            <option value="[KA]-Karnataka">[KA]-Karnataka</option>
                            <option value="[KL]-Kerala">[KL]-Kerala</option>
                            <option value="[LA]-Ladakh">[LA]-Ladakh</option>
                            <option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                            <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                            <option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                            <option value="[MN]-Manipur">[MN]-Manipur</option>  
                            <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                            <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                            <option value="[NL]-Nagaland">[NL]-Nagaland</option> 
                            <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                            <option value="[OD]-Odisha">[OD]-Odisha</option>
                            <option value="[PY]-Puducherry">[PY]-Puducherry</option>
                            <option value="[PB]-Punjab">[PB]-Punjab.</option>
                            <option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                            <option value="[SK]-Sikkim">[SK]-Sikkim</option>
                            <option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                            <option value="[TS]-Telenghana">[TS]-Telenghana</option>
                            <option value="[TR]-Tripura">[TR]-Tripura</option>
                            <option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                            <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                            <option value="[WB]-West Bengal">[WB]-West Bengal</option>
                            <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                        </select>
                    </div>
                  </div>
    
                 
                  
                  <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Currency</label>
                      
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <select name="vendorcurrency" id="vendorcrncy" class="form-control bg-light text-dark">
                              <option value="Indian Rupee" selected>Indian Rupee</option>
                          </select>
                      </div>
                  </div>
    
                  <div class="form-group row mt-2">
                    <div class="col-sm-12 col-md-3 col-lg-3 ">
                        <label class="col-form-label text-white mb-3"> Opening Balance Type</label>
                    </div>
                    <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="vendorop_type" id="vendordebit" value="debit">
                            <label class="form-check-label text-white" for="debit">Debit</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="vendorop_type" id="vendorcredit" value="credit">
                            <label class="form-check-label text-white" for="credit">Credit</label>
                        </div>
                    </div>
                  </div>
    
                  <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Opening Balance Amount</label>                    
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input  type="number" class="form-control bg-light text-dark" name="vendoropening_bal" id="vendoropa" value="0.00">      
                      </div>
                  </div>
    
                  <div class="form-group row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" >Credit Limit</label>                    
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input  type="number" class="form-control bg-light text-dark" name="vendorcredit_lm" id="vendorcl" value="0.00">      
                      </div>
                  </div>
              
                  <div id="custom-alert" class="customalert">
                      <span class="close-btn">&times;</span>
                      <div class="custom-alert-content">
                        Credit limit should not exceed opening balance amount.
                      </div>
                  </div>
                    <style>
                      .customalert {
                              display: none;
                              position: fixed;
                              top: 30%;
                              left: 50%;
                              transform: translate(-50%, -50%);
                              background-color: #f44336;
                              color: white;
                              padding: 15px;
                              border-radius: 5px;
                              }
    
                              .close-btn {
                              float: right;
                              cursor: pointer;
                              }
    
                              .custom-alert-content {
                              margin-bottom: 10px;
                              }
                    </style>
                  <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Payment Terms</label>
                    
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <select name="vendorpayment_terms" id="vendorpaytearm-select" class="form-control bg-light text-dark">
                            {% for pay_terms in p %}
                            <option value="{{pay_terms.id}}" >{{pay_terms.term_name}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4 ">
                        <a href="#" class="btn btn-outline-warning py-2 my-1" data-target="#newvendorpayment" data-toggle="modal">+</a>
                    </div>
                  </div>
    
                 
                </fieldset2>
    
                <fieldset5 id="vendoraddress" style="display: none;">
                  <div>
                      <div class="row">
                          <div class="col-sm-12 col-md-6 col-lg-6">
                              <div class="row">
                                  <div class="col-sm-12 col-md-6 col-lg-6">
                                      <label for="">BILLING ADDRESS</label>
                                  </div>
                                  <div class="col"></div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark" name="vendorbattention" id="vendorbatten">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <select name="vendorbcountry" id="vendorbtry" class="form-control bg-light text-dark">
                                          <option value="India" selected>India</option>
                                      </select>      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <textarea class="form-control bg-light " style="border: none;color: rgb(7, 7, 7);" cols="26" rows="4" name="vendorbaddress" id="vendorbadd1"></textarea>
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark" name="vendorbcity" id="vendorbcty">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input type="text" class="form-control bg-light text-dark" name="vendorbstate" id="vendorbste">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="vendorbzip" id="vendorbzp">      
                                  </div>
                              </div>
                          
                              <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" for="vendorbphone_num">Phone</label>                    
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input id="vendorbphone_num" type="tel" class="form-control bg-light text-dark" name="vendorbphone">
                                    <span id="vendorbphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span>
                                </div>
                            </div>
                            <script>
                                document.getElementById('vendorbphone_num').addEventListener('input', function() {
                                    const phoneInput = this.value;
                                    const errorSpan = document.getElementById('vendorbphone_label');
                                
                                    const phonePattern = /^[0-9]{10}$/;
                                
                                    if (phonePattern.test(phoneInput)) {
                                        errorSpan.textContent = 'Valid phone number';
                                        errorSpan.classList.remove('text-danger');
                                        errorSpan.classList.add('text-success');
                                    } else {
                                        errorSpan.textContent = 'Phone number must be exactly 10 digits';
                                        errorSpan.classList.remove('text-success');
                                        errorSpan.classList.add('text-danger');
                                    }
                                });
                                </script>
                                
                            
                                <div class="form-group row mt-4">
                                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" for="vendorbfx">Fax</label>                    
                                    <div class="col-sm-12 col-md-6 col-lg-6">
                                        <input type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" name="vendorbfax" id="vendorbfx">  
                                        <span id="fax_message" class="mt-2" style="font-size: 10px;"></span>
                                    </div>
                                </div>
                                <script>
                                    document.getElementById('vendorbfx').addEventListener('input', function() {
                                        const faxInput = this.value;
                                        const messageSpan = document.getElementById('fax_message');
                                    
                                        const faxPattern = /^[0-9]{7}$/;
                                    
                                        if (faxPattern.test(faxInput)) {
                                            messageSpan.textContent = 'Valid fax number';
                                            messageSpan.classList.remove('text-danger');
                                            messageSpan.classList.add('text-success');
                                        } else {
                                            messageSpan.textContent = 'Fax number must be exactly 7 digits';
                                            messageSpan.classList.remove('text-success');
                                            messageSpan.classList.add('text-danger');
                                        }
                                    });
                                    </script>
    
                          </div>
                          <div class="col-sm-12 col-md-6 col-lg-6">
                              <div class="row">
                                  <div class="col-sm-12 col-md-6 col-lg-6">
                                      <label for="">SHIPPING ADDRESS</label>
                                  </div>
                                  <div class="col-sm-12 col-md-6 col-lg-6">
                                      <input  type="checkbox" id="vendormyCheckT" onclick="vendormyCopyAddressFunction()">&nbsp;
                                      <label for="myCheck">Same as Billing Address:</label>
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark " style="color: white;" name="vendorsattention" id="vendorsatten">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <select name="vendors_country" id="vendorsctry" class="form-control bg-light text-dark">
                                          <option value="India" selected>India</option>
                                      </select>      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <textarea class="form-control bg-light" style="border: none;color: rgb(10, 10, 10);" id="vendorsadd1" cols="26" rows="4" name="vendorsaddress"></textarea>
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="text" class="form-control bg-light text-dark" name="vendorscity" id="vendorscty">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input type="text" class="form-control bg-light text-dark" name="vendorsstate" id="vendorsste">      
                                  </div>
                              </div>
                              <div class="form-group row mt-4">
                                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                  <div class=" col-sm-12 col-md-6 col-lg-6">
                                      <input  type="number" class="form-control bg-light text-dark" name="vendorszip" id="vendorszp">      
                                  </div>
                              </div>
                          
    
                              <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{10}" style="color: white;" name="vendorsphone" id="vendorsphone_num" >  
                                    <label for="" id="vendorsphone_label"></label>    
                                    <span id="vendorwork-phone-message" class="mt-2 " style="font-size: 10px;"></span >
                                      <span id="vendorsphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                                </div>
                            </div>
                            <script>
                              document.getElementById('vendorsphone_num').addEventListener('input', function() {
      const phoneInput = this.value;
      const errorSpan = document.getElementById('vendorsphone_label');
      
      const phonePattern = /^[0-9]{10}$/;
      
      if (phonePattern.test(phoneInput)) {
          errorSpan.textContent = 'Valid phone number';
          errorSpan.classList.remove('text-danger');
          errorSpan.classList.add('text-success');
      } else {
          errorSpan.textContent = 'Phone number must be exactly 10 digits';
          errorSpan.classList.remove('text-success');
          errorSpan.classList.add('text-danger');
      }
  });
                            </script>
                            
                              
                           
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" style="color: white;" name="vendorsfax" onclick="vendorsphone_number()" onmouseout="vendorsfax_number()" id="vendorsfx"> 
                                    <label for="" id="vendorsfax_label"></label>     
                                </div>
                            </div>
                            <script>
                                 document.getElementById('vendorsfx').addEventListener('input', function() {
          const faxInput = this.value;
          const errorSpan = document.getElementById('vendorsfax_label');
          
          const faxPattern = /^[0-9]{7}$/;
          
          if (faxPattern.test(faxInput)) {
              errorSpan.textContent = 'Valid fax number';
              errorSpan.classList.remove('text-danger');
              errorSpan.classList.add('text-success');
          } else {
              errorSpan.textContent = 'Fax number must be exactly 7 digits';
              errorSpan.classList.remove('text-success');
              errorSpan.classList.add('text-danger');
          }
      });
                            </script>
  
                          </div>
                      </div>
                  </div>
                </fieldset5>
                <script>
                    function vendormyCopyAddressFunction() {
                        var checkBox = document.getElementById("vendormyCheckT");
                        var textvatn = document.getElementById("vendorbatten");
                        var txtvcry = document.getElementById("vendorbtry");
                        var txtvadrs11 = document.getElementById("vendorbadd1");
                        var txtvcty = document.getElementById("vendorbcty");
                        var txtvstat = document.getElementById("vendorbste");
                        var txtvzip = document.getElementById("vendorbzp");
                        var txtvphone = document.getElementById("vendorbphone_num");
                        var txtvfx = document.getElementById("vendorbfx");
            
                        var textvatn1 = document.getElementById("vendorsatten");
                        var txtvcry1 = document.getElementById("vendorsctry");
                        var txtvadrs21 = document.getElementById("vendorsadd1");
                        var txtvcty1 = document.getElementById("vendorscty");
                        var txtvstat1 = document.getElementById("vendorsste");
                        var txtvzip1 = document.getElementById("vendorszp");
                        var txtvphone1 = document.getElementById("vendorsphone_num");
                        var txtvfx1 = document.getElementById("vendorsfx");
            
                        if (checkBox.checked) {
                            textvatn1.value = textvatn.value;
                            txtvadrs21.value = txtvadrs11.value;
                            txtvcty1.value = txtvcty.value;
                            txtvstat1.value = txtvstat.value;
                            txtvzip1.value = txtvzip.value;
                            txtvphone1.value = txtvphone.value;
                            txtvfx1.value = txtvfx.value;
                            txtvcry1.value = txtvcry.value;
                        } else {
                            txtvadrs21.value = "";
                            txtvcty1.value = "";
                            txtvstat1.value = "";
                            txtvzip1.value = "";
                            txtvphone1.value = "";
                            txtvfx1.value = "";
                            txtvcry1.value = "";
                            textvatn1.value = "";
                        }
                    }
                </script>
                
                
                <fieldset6 id="vendorcontact_person" style="display: none;">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="table-responsive">
                                <table id="vendortbl" class="table text-white" style="background-color: rgba(250, 227, 198, 0.5);">
                                    <thead>
                                        <tr>
                                            <th>Salutation</th>
                                            <th>First Name</th>
                                            <th>Last Name</th>
                                            <th>Email Address</th>
                                            <th>Work Phone <br><span id="vendortwph_label"></span></th>
                                            <th>Mobile <br><span id="vendortlabel"></span></th>
                                            <th>Skype Name/No</th>
                                            <th>Designation</th>
                                            <th>Department</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <select name="salutation[]" class="vendorsalutation form-control bg-transparent border-1 text-white">
                                                    <option value="" class="text-dark">Select</option>
                                                    <option class="text-dark" value="Mr">Mr.</option>
                                                    <option class="text-dark" value="Mrs">Mrs.</option>
                                                    <option class="text-dark" value="Ms">Ms.</option>
                                                    <option class="text-dark" value="Miss">Miss.</option>
                                                    <option class="text-dark" value="Dr">Dr.</option>
                                                </select>
                                            </td>
                                            <td><input type="text" class="vendorfirst_name form-control border-1 bg-transparent text-white" name="first_name[]"></td>
                                            <td><input type="text" class="vendorlast_name form-control border-1 bg-transparent text-white" name="last_name[]"></td>
                                            <td><input type="email" class="vendoremail form-control border-1 bg-transparent text-white" name="email[]"></td>
                                            <td><input type="tel" pattern="[0-9]{7}" class="vendorwork_phone form-control border-1 bg-transparent text-white" name="wphone[]"></td>
                                            <td><input type="tel" pattern="[0-9]{10}" class="vendormobile_phone form-control border-1 bg-transparent text-white" name="mobile[]"></td>
                                            <td><input type="text" class="vendorskype_number form-control border-1 bg-transparent text-white" name="skype[]"></td>
                                            <td><input type="text" class="vendordesignation form-control border-1 bg-transparent text-white" name="designation[]"></td>
                                            <td><input type="text" class="vendordepartment form-control border-1 bg-transparent text-white" name="department[]"></td>
                                            <td><button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="button add_another mt-3">
                                <i class="fa fa-user-plus" aria-hidden="true"></i>
                                <span class="text-small" style="margin-left: 0.30rem;">Add Contact Person</span>
                            </div>
                        </div>
                    </div>
                </fieldset6>
                
                <script>
                $(document).ready(function() {
                    // Function to add a new contact person row
                    $('.add_another').click(function() {
                        var newRow = `<tr>
                            <td>
                                <select name="salutation[]" class="vendorsalutation form-control bg-transparent border-1 text-white">
                                    <option value="" class="text-dark">Select</option>
                                    <option class="text-dark" value="Mr">Mr.</option>
                                    <option class="text-dark" value="Mrs">Mrs.</option>
                                    <option class="text-dark" value="Ms">Ms.</option>
                                    <option class="text-dark" value="Miss">Miss.</option>
                                    <option class="text-dark" value="Dr">Dr.</option>
                                </select>
                            </td>
                            <td><input type="text" class="vendorfirst_name form-control border-1 bg-transparent text-white" name="first_name[]"></td>
                            <td><input type="text" class="vendorlast_name form-control border-1 bg-transparent text-white" name="last_name[]"></td>
                            <td><input type="email" class="vendoremail form-control border-1 bg-transparent text-white" name="email[]"></td>
                            <td><input type="tel" pattern="[0-9]{7}" class="vendorwork_phone form-control border-1 bg-transparent text-white" name="wphone[]"></td>
                            <td><input type="tel" pattern="[0-9]{10}" class="vendormobile_phone form-control border-1 bg-transparent text-white" name="mobile[]"></td>
                            <td><input type="text" class="vendorskype_number form-control border-1 bg-transparent text-white" name="skype[]"></td>
                            <td><input type="text" class="vendordesignation form-control border-1 bg-transparent text-white" name="designation[]"></td>
                            <td><input type="text" class="vendordepartment form-control border-1 bg-transparent text-white" name="department[]"></td>
                            <td><button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button></td>
                        </tr>`;
                        $('#vendortbl tbody').append(newRow);
                    });
                });
                
                // Function to delete a contact person row
                function deleteContact(button) {
                    $(button).closest('tr').remove();
                }
                </script>
                
      
                  <!---------------------Contact Person Section End -------------->
                  <fieldset7 class="vendorrmrk" style="display: block;">
                    <div class="row">
                        <div class="col-sm-12 col-md-8 col-lg-8">
                            <div class="form-group row mt-4">
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <label for="vendorrmrk">Remarks:</label>
                                    <textarea class="bg-light w-100" style="border: none; color: rgb(5, 5, 5);" id="vendorrmrk" rows="5" name="vendorremark"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-2 col-lg-2"></div>
                    </div>
                </fieldset7>
              
                
  
  
               
  
             
  
             
            
            
          
          <div class="row mt-5">
            <div class="col-lg-12 col-md-12 col-sm-12">
              <div class="d-flex justify-content-center">
                <button class="btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning" type="button" id="newVendorSave">Save</button>
                <button type="button" class="close btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning close_Vendor_modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Cancel</span></button>
              </div>
            </div>
          </div>
        </form>
          </div>
        </div>
      </div>
    </div>  
  </div>
  
  
  <!-- New vendor Payment Term -->
  <div class="modal fade" id="newvendorpayment">
    <div class="modal-dialog modal-md">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-header " style="background: rgb(32, 35, 37);">
            <h3 class="m-3 text-uppercase" style="color: white;">aAdd Payment Term</h3>
            <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3" style="background-color: #141414a2;">
            <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalPayment_terms">
            
  
  
            <div class="row mt-2">
  
                <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                    <label for="termname" style="color: white">Term Name *</label>
  
                <input type="text " class="form-control text-dark bg-light mt-2" id="vendortname" name="term_name" autocapitalize="characters" required> 
                <span id="vendormessage-id" class="mt-1 text-danger" style="font-size: 10px;"></span> 
                <span id="vendorsuccess-message-id" class=" mt-1 text-success" style="font-size: 10px;"></span>    
                </div>
  
                <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                    <label for="termdays" style="color: white">Number of Days *</label>
  
                <input type="number" class="form-control text-dark bg-light mt-2" id="vendortdays" name="term_days" autocapitalize="characters" required>
                </div>
                <div class="col-md-2 mt-2"></div>
  
            </div>
            
            <div class="row mt-5">
                <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="d-flex">
                    <button class="btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning "
                    type="submit" data-dismiss="modal" id="vendorPaymentTermSave">Save
                    </button> 
                    
  
                    <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning" 
                    data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Cancel</span>
                    </button>
                </div>
                </div>
            </div>
            </form>
        </div>
        </div>
    </div>
    </div>  
  </div>

<!-- New Customer Modal -->
<div class="modal fade" id="newCustomer">
    <div class="modal-dialog modal-xl">
      <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-header px-3" style="background: rgb(32, 35, 37);">
            <h3 class="text-uppercase" style="color: white;">Add Customer</h3>
            <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="background: rgb(32, 35, 37);">
          <div class="card px-2 py-4" style="background-color: #000;">
            <form id="newCustomerForm">
              {% csrf_token %}
              <div class="form-group row mt-3">
                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color: white;">Customer Type</label>
                
                <div class=" col-sm-12 col-md-3 col-lg-3">
                    <input type="radio"  value="Business" name="type" >
                    <label for="Business"> Business</label>
                    &nbsp;&nbsp;&nbsp;
                    <input  type="radio"  value="Individual" name="type" >
                    <label for="Business">Individual</label>
                </div>
              </div>
  
              <div class=" form-group row">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                    <label class="labels">Primary Contact*</label>
                </div>
                <div class="col-sm-12 col-md-1 col-lg-1" >
                    <select id="select1"  name="salutation" class="form-control bg-light text-dark mt-2 " >
                    
                        <option value="Mr">Mr</option>
                        <option value="Mrs">Mrs</option>
                        <option value="Ms">Ms</option>
                        <option value="Dr">Dr</option>
  
                    </select> 
                </div>
                <div class="col-sm-12 col-md-2 col-lg-3" >
                    <input  type="text" class="form-control bg-light text-dark mt-2 change-disply " id="fname" name="first_name" placeholder="first name" required >
  
                </div>
                <div class="col-sm-12 col-md-2 col-lg-3" >
                    <input type="text" class="form-control bg-light text-dark mt-2 " id="lname" name="last_name" placeholder="last name" required >
                </div>
              </div>
              <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label class="labels">Customer Display Name</label></div>
                <div class="col-sm-12 col-md-6 col-lg-7">
                    <select class="form-control bg-light text-dark "  name="v_display_name" id="v_display_name">
                    </select> 
                </div>
            </div>
            <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                    <label class="labels">Company Name</label>
                </div>
                <div class="col-sm-12 col-md-6 col-lg-7">
                    <input  type="text" class="form-control bg-light text-dark " id="companyName" name="company_name" required>     
                    <div class="invalid-feedback">Please fill out this field.</div>   
                </div>
            </div>
            <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label class="labels">Customer Email*</label></div>
                <div class="col-sm-12 col-md-6 col-lg-7">
                    <input  type="email" class="form-control bg-light text-dark" name="vendor_email"  id="vendor-email"  required> 
                    <span class=" text-danger mt-1" id="email-message-id" style="font-size: 10px;"></span>   
                </div>
            </div>
  
            <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 ">
                    <label class="col-form-label text-white">Customer phone*</label>
                </div>
                <div class="col-sm-12 col-md-3 col-lg-3">
                    <input id="workphone"  type="text" class="form-control bg-light text-dark mt-2" pattern="[0-9]{7}"  name="w_phone" placeholder="work phone" required>
                    <span id="work-phone-message" class="mt-2 " style="font-size: 10px;"></span >
                    <span id="workphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                    <div class="invalid-feedback"></div>   
                </div>
                <div class=" col-sm-12 col-md-3 col-lg-4">
                    <input id="mphone"  type="text" pattern="[0-9]{10}" class="form-control bg-light text-dark mt-2"  name="m_phone" placeholder="mobile number" required>
                    <span id="phone-message" class="mt-2 " style="font-size: 10px;"></span >
                    <span id="mphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                    <div class="invalid-feedback"></div>
                </div>
  
                <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
  
                <div class="toggle1 section-toggle">
                    <a href="">Add More Details</a>
                </div>
              </div>
  
              <fieldset1 id="more_detail" class="more details" style="display: none;">
                <div class="form-group row mt-4">
                  <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                      <label>Skype name/Number</label>
                  </div>
                  <div class="col-sm-12 col-md-6 col-lg-6">
                      <input  type="text" class="form-control bg-light text-dark" id="skypeNumber" name="skype_number">      
                  </div>
                </div>
  
                <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                        <label>Designation</label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <input  type="text" id="design" class="form-control bg-light text-dark" name="designation">      
                    </div>
                </div>
  
                <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                        <label>Department</label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <input  type="text" class="form-control bg-light text-dark" id="dept" name="department">      
                    </div>
                </div>
       
                <div class="form-group row mt-4">
                    <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Website</label></div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <input id="web" type="text" class="form-control bg-light text-dark" onclick="mobile_phone()"    name="website">      
                    </div>
                </div>
              </fieldset1>
  
              <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">
  
              <div class="section-3">
  
                  <div class="toggle2 section-toggle"> <a href="" >Other Details </a> </div>
                  <div class="toggle3 section-toggle" > <a href="">Address </a> </div>
                  <div class="toggle4 section-toggle"><a href="" >Contact Persons </a></div>
                  <div class="toggle7 section-toggle"><a href="">Remarks</a></div>
  
              </div>
  
              <fieldset2 class="other details">
                <div class="form-group row mt-2">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > GST Treatment*</label>
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <select name="gst" id="GSTT" class="form-control bg-light text-dark" onclick="gstPan_function()">
                            <option value="" selected>Select a Gst Treatment</option>
                            <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                            <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">
                                Registered Business-Composition Business that is registered under the Composition schemen in GST
                            </option>
                            <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                            <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                            <option value="Special Economic Zone">Special Economic Zone</option>
                        </select><br>
                    </div>
                </div>
  
                <fieldset3 id="gst" style="display: none;">
                    <div class="row mt-4">
                        <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white"  > GSTIN/UIN*</label>
                        
                        <div class=" col-sm-12 col-md-3 col-lg-3">
                            <input type="text" class="form-control bg-light text-dark" name="gst_number" id="gstInput" > 
                            <span id="gstMessage"></span>       
                        </div>
                    </div>
  
                </fieldset3>
  
                <fieldset4 id="pan" style="display: none;">
                  <div class=" row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > PAN*</label>
                      
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input type="text" class="form-control bg-light text-dark"  id="panInput"  name="pan_number">  
                          <span id="panMessage"></span>    
                      </div>
                  </div>
                </fieldset4>
  
  
                <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Source of Supply*</label>
                  <div class=" col-sm-12 col-md-3 col-lg-3">
                      <select name="source_supply" id="PLACE" class="form-control bg-light text-dark">
                          <option value="value" selected></option>
                          <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option>
                          <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                          <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> 
                          <option value="volvo">[AS]-Assam</option>
                          <option value="[BR]-Bihar">[BR]-Bihar</option> 
                          <option value="volvo">[CH]-	Chandhigarh</option>
                          <option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                          <option value="[DD]-Daman Diu">[DD]-Daman Diu</option>
                          <option value="volvo">[DL]-	Delhi</option>
                          <option value="[GA]-Goa">[GA]-Goa</option> 
                          <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                          <option value="[HR]-Haryana">[HR]-Haryana</option> 
                          <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                          <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option>
                          <option value="[JH]-Jharkand">[JH]-Jharkand</option>
                          <option value="[KA]-Karnataka">[KA]-Karnataka</option>
                          <option value="[KL]-Kerala">[KL]-Kerala</option>
                          <option value="[LA]-Ladakh">[LA]-Ladakh</option>
                          <option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                          <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                          <option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                          <option value="[MN]-Manipur">[MN]-Manipur</option>  
                          <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                          <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                          <option value="[NL]-Nagaland">[NL]-Nagaland</option> 
                          <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                          <option value="[OD]-Odisha">[OD]-Odisha</option>
                          <option value="[PY]-Puducherry">[PY]-Puducherry</option>
                          <option value="[PB]-Punjab">[PB]-Punjab.</option>
                          <option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                          <option value="[SK]-Sikkim">[SK]-Sikkim</option>
                          <option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                          <option value="[TS]-Telenghana">[TS]-Telenghana</option>
                          <option value="[TR]-Tripura">[TR]-Tripura</option>
                          <option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                          <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                          <option value="[WB]-West Bengal">[WB]-West Bengal</option>
                          <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                      </select>
                  </div>
                </div>
  
                <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:rgb(214, 75, 75) ;">Tax Preference*</label>
                    
                  <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="tax1" id="Taxable" value="Taxable" required>
                        <label class="form-check-label text-white" for="vehicle1">Taxable</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="tax1" id="Tax_Exempt" value="Tax Exempt" required>
                        <label class="form-check-label text-white" for="vehicle2">Tax Exempt</label>
                    </div>
                  </div>
                </div>
                
                <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Currency</label>
                    
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <select name="currency" id="crncy" class="form-control bg-light text-dark">
                            <option value="Indian Rupee" selected>Indian Rupee</option>
                        </select>
                    </div>
                </div>
  
                <div class="form-group row mt-2">
                  <div class="col-sm-12 col-md-3 col-lg-3 ">
                      <label class="col-form-label text-white mb-3"> Opening Balance Type</label>
                  </div>
                  <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                      <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="op_type" id="debit" value="debit">
                          <label class="form-check-label text-white" for="debit">Debit</label>
                      </div>
                      <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="op_type" id="credit" value="credit">
                          <label class="form-check-label text-white" for="credit">Credit</label>
                      </div>
                  </div>
                </div>
  
                <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Opening Balance Amount</label>                    
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <input  type="number" class="form-control bg-light text-dark" name="opening_bal" id="opa" value="0.00">      
                    </div>
                </div>
  
                <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" >Credit Limit</label>                    
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <input  type="number" class="form-control bg-light text-dark" name="credit_lm" id="cl" value="0.00">      
                    </div>
                </div>
            
                <div id="custom-alert" class="customalert">
                    <span class="close-btn">&times;</span>
                    <div class="custom-alert-content">
                      Credit limit should not exceed opening balance amount.
                    </div>
                </div>
                  <style>
                    .customalert {
                            display: none;
                            position: fixed;
                            top: 30%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            background-color: #f44336;
                            color: white;
                            padding: 15px;
                            border-radius: 5px;
                            }
  
                            .close-btn {
                            float: right;
                            cursor: pointer;
                            }
  
                            .custom-alert-content {
                            margin-bottom: 10px;
                            }
                  </style>
                <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Payment Terms</label>
                  
                  <div class=" col-sm-12 col-md-3 col-lg-3">
                      <select name="payment_terms" id="paytearm-select" class="form-control bg-light text-dark">
                          {% for pay_terms in pTerms %}
                          <option value="{{pay_terms.id}}" >{{pay_terms.term_name}}</option>
                          {% endfor %}
                      </select>
                  </div>
                  <div class="col-md-4 ">
                      <a href="#" class="btn btn-outline-warning py-2 my-1" data-target="#newpayment" data-toggle="modal">+</a>
                  </div>
                </div>
  
                <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white">Price List </label>
                    
                  <div class=" col-sm-12 col-md-3 col-lg-3">
                      <select name="plst" id="priceLs" class="form-control bg-light text-dark">
                          <option value="0">Not selected</option>
                          {% for price_list in priceListItems %}
                          <option value="{{price_list.id}}">{{price_list.name}}</option>    
                          {% endfor %}
                      </select>
                  </div>
                </div>
             
                <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">
                        Portal Language</label>
                        <div class=" col-sm-12 col-md-3 col-lg-3">
                            <select name="plang" id="plang" style="width: 100%;" class="form-control bg-light text-dark">
                                <option selected value="0" >Choose..</option>
                                <option value="ENGLISH">ENGLISH</option>
                              </select>
                    </div>
                </div>   
                <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">Facebook </label>
                      <div class=" col-sm-12 col-md-3 col-lg-3"> 
                        <input type="text" id="fbk" name="fbk" class="form-control bg-light text-dark" >    
                    </div>
                </div>
                <div class="form-group row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">Twitter</label>
                        <div class=" col-sm-12 col-md-3 col-lg-3">
                            <input type="text" id="twtr" name="twtr" class="form-control bg-light text-dark" >
                          
                    </div>
                </div>
              </fieldset2>
  
              <fieldset5 id="address" style="display: none;">
                <div>
                    <div class="row">
                        <div class="col-sm-12 col-md-6 col-lg-6">
                            <div class="row">
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <label for="">BILLING ADDRESS</label>
                                </div>
                                <div class="col"></div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="battention" id="batten">      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <select name="bcountry" id="btry" class="form-control bg-light text-dark">
                                        <option value="India" selected>India</option>
                                    </select>      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <textarea class="form-control bg-light " style="border: none;color: rgb(7, 7, 7);" cols="26" rows="4" name="baddress" id="badd1"></textarea>
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="bcity" id="bcty">      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input type="text" class="form-control bg-light text-dark" name="bstate" id="bste">      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="number" class="form-control bg-light text-dark" name="bzip" id="bzp">      
                                </div>
                            </div>
                        
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input id="bphone_num"  type="tel" pattern="[0-9]{10}" class="form-control bg-light text-dark" name="bphone" >
                                    <label for="" id="bphone_label"></label>      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" onmouseout="fax_number()"  onclick="bphone_number()" name="bfax" id="bfx">  
                                
                                    <label for="" id="fax_label"></label> 
                                </div>
                            </div>
  
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-6">
                            <div class="row">
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <label for="">SHIPPING ADDRESS</label>
                                </div>
                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <input  type="checkbox" id="myCheckT" onclick="myCopyAddressFunction()">&nbsp;
                                    <label for="myCheck">Same as Billing Address:</label>
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark " style="color: white;" name="sattention" id="satten">      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <select name="s_country" id="sctry" class="form-control bg-light text-dark">
                                        <option value="India" selected>India</option>
                                    </select>      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <textarea class="form-control bg-light" style="border: none;color: rgb(10, 10, 10);" id="sadd1" cols="26" rows="4" name="saddress"></textarea>
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="text" class="form-control bg-light text-dark" name="scity" id="scty">      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input type="text" class="form-control bg-light text-dark" name="sstate" id="sste">      
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="number" class="form-control bg-light text-dark" name="szip" id="szp">      
                                </div>
                            </div>
                        
  
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{10}" style="color: white;" name="sphone" id="sphone_num">  
                                    <label for="" id="sphone_label"></label>    
                                </div>
                            </div>
                            <div class="form-group row mt-4">
                                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                                <div class=" col-sm-12 col-md-6 col-lg-6">
                                    <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" style="color: white;" name="sfax" onclick="sphone_number()" onmouseout="sfax_number()" id="sfx"> 
                                    <label for="" id="sfax_label"></label>     
                                </div>
                            </div>
  
                        </div>
                    </div>
                </div>
              </fieldset5>
  
              <fieldset6 id="contact_person" style="display: none;" >
                <div class="row">
                    <div class="col-sm-12 ">
                        
                        <div class="table-responsive">
                        
                            <table id="tbl" class="table text-white" style="background-color: rgba(250, 227, 198, 0.5);">
                                <thead>
                                    <tr>
                                        
                                    <th>Salutation</th>
                                    <th>First Name</th>
                                    <th>Last Name</th>
                                    <th>Email Address</th>
                                    <th >Work Phone <br><span id="twph_label"></span></th>
                                    <th >Mobile <br><span id="tlabel"></span>    </th>
                                    <th >Skype Name/No</th>
                                    <th >Designation</th>
                                    <th >Department</th>
                                    <th>Action</th>
  
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                <td><select name="salutation[]" class="salutation form-control bg-transparent border-1 text-white" >
                                  <option value="" class="text-dark">Select</option>
                                    <option class="text-dark" value="Mr">Mr.</option>
                                    <option class="text-dark" value="Mrs">Mrs.</option>
                                    <option class="text-dark" value="Ms">Ms.</option>
                                    <option class="text-dark" value="Miss">Miss.</option>
                                    <option class="text-dark" value="Dr">Dr.</option>
                                    </select></td>
                                <td><input type="text" class="first_name form-control border-1 bg-transparent text-white"    name="first_name[]"  ></td>
                                <td><input type="text"class="last_name form-control border-1 bg-transparent text-white"  name="last_name[]" /></td>
                                <td>
                                    <input type="text" class="email form-control border-1 bg-transparent text-white" name="email[]" />
                                    
                                    
                                </td>
                                
                                <td>
                                    <input type="tel" pattern="[0-9]{7}" class="work_phone form-control border-1 bg-transparent text-white"  id="twphone" name="wphone[]"/>
                                   
                                </td>
                                <td>
                                    <input type="tel" pattern="[0-9]{10}"  class="mobile_phone form-control border-1 bg-transparent text-white"  id="tmobile" onclick="sample1()"   name="mobile[]" />
                                    
                                </td>
                                <td><input type="number" class="skype_number form-control border-1 bg-transparent text-white"  onclick="sample()" name="skype[]" /></td>
                                <td><input type="text" class="designation form-control border-1 bg-transparent text-white"  name="designation[]" /></td>
                                <td><input type="text" class="department form-control border-1 bg-transparent text-white"  name="department[]" /></td>
                                <td><button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button></td>
                                </tr>
                            </tbody>
                            </table>
                            
                        </div>
                        
                        <div class="button add_another mt-3 ">
                            <i class="fa fa-user-plus" aria-hidden="true"></i> 
                            <span class="text-small" style="margin-left: 0.30rem;">
                                Add Contact Person
                            </span>
                        </div>
                           
                        
                    </div>
                    
                </div>
  
              </fieldset6>
  
              <!---------------------Contact Person Section End -------------->
  
  
              <!------------------ Remark Section Start------------- -->
  
              <fieldset7 class="remarks" style="display: none;">
                  <div class="row">
                      <div class="col-sm-12 col-md-8 col-lg-8">
                          <div class="form-group row mt-4">
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <textarea class="bg-light w-100" style="border: none;color: rgb(5, 5, 5);" id="rmrk"  rows="5" name="remark"></textarea>
                              </div>
                          </div>
                      </div>
                      <div class="col-sm-12 col-md-2 col-lg-2"></div>
                  </div>
  
              </fieldset7>
            
            
          </form>
          <div class="row mt-5">
            <div class="col-lg-12 col-md-12 col-sm-12">
              <div class="d-flex justify-content-center">
                <button class="btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning" type="button" id="newCustomerSave">Save</button>
                <button type="button" class="close btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning close_customer_modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Cancel</span></button>
              </div>
            </div>
          </div>
          </div>
        </div>
      </div>
    </div>  
  </div>
  
  
  <!-- New Customer Payment Term -->
  <div class="modal fade" id="newpayment">
    <div class="modal-dialog modal-md">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-header " style="background: rgb(32, 35, 37);">
            <h3 class="m-3 text-uppercase" style="color: white;">Add Payment Term</h3>
            <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3" style="background-color: #141414a2;">
            <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalPayment_terms">
            
  
  
            <div class="row mt-2">
  
                <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                    <label for="termname" style="color: white">Term Name *</label>
  
                <input type="text " class="form-control text-dark bg-light mt-2" id="tname" name="term_name" autocapitalize="characters" required> 
                <span id="message-id" class="mt-1 text-danger" style="font-size: 10px;"></span> 
                <span id="success-message-id" class=" mt-1 text-success" style="font-size: 10px;"></span>    
                </div>
  
                <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                    <label for="termdays" style="color: white">Number of Days *</label>
  
                <input type="number" class="form-control text-dark bg-light mt-2" id="tdays" name="term_days" autocapitalize="characters" required>
                </div>
                <div class="col-md-2 mt-2"></div>
  
            </div>
            
            <div class="row mt-5">
                <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="d-flex">
                    <button class="btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning "
                    type="submit" data-dismiss="modal" id="customerPaymentTermSave">Save
                    </button> 
                    
  
                    <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning" 
                    data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Cancel</span>
                    </button>
                </div>
                </div>
            </div>
            </form>
        </div>
        </div>
    </div>
    </div>  
  </div>



<script>
  $('#opn_bal').change(function (){
    val = $('#opn_bal').val()
    if($('#bal_type').val() == 'Credit'){
      $('#opn_bal').val(-val)
    }else{
      if(val<0){
        $('#opn_bal').val(-val)
      }
    }
  })

  $('#bal_type').change(function (){
    val = $('#opn_bal').val()
    $('#opn_bal').val(-val)
  })
  $(document).ready(function(){
            // Show/Hide HSN or SAC field based on Expense Type
            $('#expense_type').change(function(){
                var selectedexpense_type = $(this).val();
                if(selectedexpense_type === 'goods'){
                    $('#hsnField').show();
                    $('#sacField').hide();
                } else if(selectedexpense_type === 'service'){
                    $('#hsnField')
                    .hide();
                    $('#sacField').show();
                } else {
                    $('#hsnField').hide();
                    $('#sacField').hide();
                }
            });
        });
        function checkCustomerEmail(email){
    var custEmail = email;
    if (custEmail != ""){
        $.ajax({
            type : 'POST',
            url:"{% url 'checkCustomerEmail' %}",
            data:{
                'email' : custEmail,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            
            success: function(response) {
                if(response.is_exist){
                    alert(response.message)
                }
            },         
        });
    }
}


        
</script>
<!--add vendor modal-->

<!--add vendor modal-->
<script>
    // Name display 
 
       
    const vendorTitle = document.getElementById('vendorselect1');
 const vendorfname = document.getElementById('vendorfname');
 const vendorlaname = document.getElementById('vendorlname');
 const vendorvDisplayName = document.getElementById('vendorv_display_name');
 
 // Listen for input events on the initial input fields
 vendorTitle.addEventListener('input', updateOutputFields);
 vendorfname.addEventListener('input', updateOutputFields);
 vendorlaname.addEventListener('input', updateOutputFields);
 
 // Function to update the output fields
 function updateOutputFields() {
   const selectedvendorTitle = vendorTitle.value;
   const selectedvendorFname = vendorfname.value;
   const selectedvendorLname = vendorlaname.value;
 
   // Clear existing options
   vendorvDisplayName.innerHTML = '';
 // Add new options based on input field values
 const option1 = document.createElement('option');
   option1.text = selectedvendorTitle + ' ' + selectedvendorFname + ' ' + selectedvendorLname;
   vendorvDisplayName.add(option1);
 
  
 
   const option2 = document.createElement('option');
   option2.text = selectedvendorFname + ' ' + selectedvendorLname;
   vendorvDisplayName.add(option2);
 
   const option3 = document.createElement('option');
   option3.text = selectedvendorLname + ' ' + selectedvendorFname;
   vendorvDisplayName.add(option3);
 }
 // Work Phone Number Validation 
 $(document).ready(function () {
       $('#vendorworkphone').on('input', function () {
           var inputVal = $(this).val();
           var expr = /^[0-9]{7}$/;
           if (expr.test(inputVal)) {
               $('#vendorwork-phone-message').text('Valid work phone number').css('color', 'green');
           } else {
               $('#vendorwork-phone-message').text('Invalid work phone number').css('color', 'red');
           }
       });
   });
 
   // Phone Number Validation
   $(document).ready(function () {
       $('#vendormphone').on('input', function () {
           var inputVal = $(this).val();
           var expr=/^[0-9]{10}$/;
           if (expr.test(inputVal)) {
               $('#vendorphone-message').text('Valid  phone number').css('color', 'green');
           } else {
               $('#vendorphone-message').text('Invalid  phone number').css('color', 'red');
           }
       });
   });


  $(document).ready(function() {
   $('#vendorworkphone').on('change', function() {
       var vendorwPhone = $(this).val();
       $.ajax({
           type: 'GET',
           url: '{% url "check_vendor_work_phone_exist" %}',
           data: {
               vendorw_Phone: vendorwPhone
           },
           success: function(response) {
               if (response.exists) {
                   $('#vendorworkphone_label').text('Work phone number already exists!');
                   $('#vendorworkphone').val('');
               } else {
                   $('#vendorworkphone_label').text('');
               }
           },
           error: function(xhr, status, error) {
               console.error('Error:', error);
           }
       });
   });
});
$('#vendormphone').on('input', function() {
       
       var vendormPhone = $(this).val();
       
       $.ajax({
           type: 'GET',
           url:'{% url "check_vendor_phonenumber_exist" %}',
           data: {
               vendorm_Phone: vendormPhone
           },
           success: function(response) {
               if (response.exists) {
                   $('#vendormphone_label').text('Phone number already exists !');
                   $('#vendormphone').val('');
               }
               else{
                   $('#vendormphone_label').text('');
               }
               
           },
           error: function(xhr, status, error) {
               console.error('Error:', error);
           }
       });
     });
     
     $('#vvendor-email').on('input', function() {
       
       var vvendorEmail = $(this).val();
       console.log(vvendorEmail)
       $.ajax({
           type: 'GET',
           url:'{% url "check_vendor_email_exist" %}',
           data: {
               vvendor_email: vvendorEmail
           },
           success: function(response) {
               if (response.exists) {
                   $('#vendoremail-message-id').text('Email id already exists !');
                   $('#vvendor-email').val('');
               }
               else{
                   $('#vendoremail-message-id').text('');
               }
               
           },
           error: function(xhr, status, error) {
               console.error('Error:', error);
           }
       });
     });
    
     function vendorgstPan_function(){
       var x=document.getElementById('vendorGSTT').value
       if(x=="Unregistered Business-not Registered under GST")
       {
           document.getElementById("vendorpan").style.display="block";
           document.getElementById("vendorgst").style.display="none";
 
           
       }
       else if((x=="Registered Business-Regular Business that is registered under GST") || (x=="Registered Business-Composition Business that is registered under the Composition scheme in GST") || (x=="Overseas- Persons with who you do import or exports of supplies outside india") || (x=="Special Economic Zone"))
       {
           document.getElementById("vendorgst").style.display="block";
           document.getElementById("vendorpan").style.display="block";
 
 
       }
   
   }

   // PAN Number Check
   $('#vendorpanInput').on('input', function(){
       var vpanNumber = $(this).val().toUpperCase(); // Convert to uppercase for consistency
       var regex = /[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
       if(regex.test(vpanNumber)) {
           $('#vendorpanMessage').text('PAN number format is valid.').css({
               'color': 'green',
               'font-size': '12px'
           });
           // PAN number is valid, call AJAX to check if it exists
           $.ajax({
               url: "{% url 'vendor_check_pan' %}",
               headers: {'X-CSRFToken': $('input[name="csrfmiddlewaretoken"]').val()}, 
               type: 'POST',
               data: {vendorpan_number: vpanNumber},
               success: function(response) {
                   if (response.status == 'exists') {
                       $('#vendorpanMessage').text('PAN number already exists.').css({
                           'color': 'red',
                           'font-size': '12px'
                       });
                   } else {
                       $('#vendorpanMessage').text('');
                   }
               },
               error: function(xhr, status, error) {
                   console.error(xhr.responseText);
                   $('#vendorpanMessage').text('Error checking PAN number. Please try again.').css({
                       'color': 'red',
                       'font-size': '12px'
                   });
               }
           });
       } else {
           $('#vendorpanMessage').text('Please enter a valid PAN number.').css({
               'color': 'red',
               'font-size': '12px'
           });
       }
   });
       // Pna Number Check End 
 
  // GST Number Check 
 
  $(document).ready(function() {
   $('#vendorgstInput').on('input', function() {
       var vgstNumber = $(this).val();
       var regex = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
       
       if (regex.test(vgstNumber)) {
           $('#vendorgstMessage').text('GST number is valid.').css('color', 'green');
           // GST number is valid, call AJAX to check if it exists
           $.ajax({
               url: "{% url 'vendor_check_gst' %}",
               headers: {'X-CSRFToken': $('input[name="csrfmiddlewaretoken"]').val()},
               type: 'POST',
               data: {vendorgst_number: vgstNumber},  // Ensure the key matches the backend
               success: function(response) {
                   if (response.status === 'exists') {
                       $('#vendorgstMessage').text('GST number already exists.').css({
                           'color': 'red',
                           'font-size': '12px'
                       });
                   } else {
                       $('#vendorgstMessage').text('GST number is valid .').css({
                           'color': 'green',
                           'font-size': '12px'
                       });
                   }
               }
           });
       } else {
           $('#vendorgstMessage').text('Please enter a valid GST number.').css({
               'color': 'red',
               'font-size': '12px'
           });
       }
   });
});

       // GST Number Check End 

       function filtervendor() {
    var options = $('#vend_drop').children();
    var search_text = $("#vendor").val().toLowerCase();
    options.each(function() {
        if ($(this).text().toLowerCase().includes(search_text)) {
            $(this).show();
        } else {
            $(this).hide();
        }
    });
}

      
     
       $(document).on("click", "#vendorPaymentTermSave", function() {
   var trm = $('#vendortname').val();
   var dys = $("#vendortdays").val();
   if (trm !== "" && dys !== "") {
       $.ajax({
           type: 'POST',
           url: "{% url 'newPaymentTermAjax' %}",
           data: {
               'term': trm,
               'days': dys,
               csrfmiddlewaretoken: '{{ csrf_token }}'
           },
           success: function(response) {
               if (response.status) {
                   var newTermForm = document.getElementById("newTermForm");
                   if (newTermForm) {
                       newTermForm.reset();
                   } else {
                       console.error("Form element with ID 'newTermForm' not found.");
                   }
                   var dropdown = $('#paytearm-select');
                   dropdown.empty();
                   dropdown.append(`<option value="" selected>Choose</option>`);
                   $.each(response, function(key, value) {
                       for (let i = 0; i < value.length; i++) {
                           if (value[i].name == trm) {
                               dropdown.append($('<option selected></option>').text(value[i].name).val(value[i].id))
                           } else {
                               dropdown.append($('<option></option>').text(value[i].name).val(value[i].id))
                           }
                       }
                   });
               } else {
                   alert("Something went wrong!");
               }
           },
           error: function() {
               alert("Something went wrong with the AJAX request!");
           }
       });
   } else {
       alert('Invalid');
   }
});

$(document).on("click", "#newVendorSave", function() {
   var vtype = $('input[name="vendortype"]:checked').val();
   var vtitle = $('#vendorselect1').val();
   var vfName = $('#vendorfname').val();
   var vlName = $('#vendorlname').val();
   var cmpName = $('#vendorcompanyName').val();
   var disName = $('#vendorv_display_name').val();
   var vEmail = $("#vvendor-email").val();
   var vphone = $("#vendorworkphone").val();
   var vMob = $("#vendormphone").val();
   var vgstType = $("#vendorGSTT").val();
   var vgstIN = $("#vendorgstInput").val();
   var vpanNo = $("#vendorpanInput").val();
   var Skypename = $("#vendorskypeNumber").val();
   var Desg = $("#vendordesign").val();
   var Dept = $("#vendordept").val();
   var Vweb = $("#vendorweb").val();
   var vatten = $('#vendorbatten').val();
   var vcountry = $('#vendorbtry').val();
   var vaddress = $('#vendorbadd1').val();
   var vcity = $('#vendorbcty').val();
   var vstate = $('#vendorbste').val();
   var vzip = $('#vendorbzp').val();
   var vphoneBilling = $('#vendorbphone_num').val();
   var vfax = $('#vendorbfx').val();
   var vsatten = $('#vendorsatten').val();
   var vscountry = $('#vendorsctry').val();
   var vsaddress = $('#vendorsadd1').val();
   var vscity = $('#vendorscty').val();
   var vsstate = $('#vendorsste').val();
   var vszip = $('#vendorszp').val();
   var vsphone = $('#vendorsphone_num').val();
   var vsfax = $('#vendorsfx').val();
   var source = $('#vendorPLACE').val();
   var CURE = $('#vendorcrncy').val();
   var optypeDebit = $('#vendordebit').val();
   var optypeCredit = $('#vendorcredit').val();
   var opblnc = $('#vendoropa').val();
   var credit = $('#vendorcl').val();
   var pay = $('#vendorcl').val();
   var vremark = $('#vendorrmrk').val();

   // Contact person details
   var vtSalutation = [];
   var vtFirstName = [];
   var vtLastName = [];
   var vtEmail = [];
   var vtWork = [];
   var vtMobile = [];
   var vtSkype = [];
   var vtDesignation = [];
   var vtDepartment = [];

   $('#vendortbl tbody tr').each(function() {
       var row = $(this);
       var vsal = row.find('.vendorsalutation').val();
       var vfn = row.find('.vendorfirst_name').val();
       var vln = row.find('.vendorlast_name').val();
       var veml = row.find('.vendoremail').val();
       var vwrk = row.find('.vendorwork_phone').val();
       var vmob = row.find('.vendormobile_phone').val();
       var vsky = row.find('.vendorskype_number').val();
       var vdep = row.find('.vendordepartment').val();
       var vdes = row.find('.vendordesignation').val();

       // Only add non-empty rows
       if (vsal || vfn || vln || veml || vwrk || vmob || vsky || vdep || vdes) {
           vtSalutation.push(vsal);
           vtFirstName.push(vfn);
           vtLastName.push(vln);
           vtEmail.push(veml);
           vtWork.push(vwrk);
           vtMobile.push(vmob);
           vtSkype.push(vsky);
           vtDesignation.push(vdes);
           vtDepartment.push(vdep);
       }
   });

   var cols = [vtSalutation, vtFirstName, vtLastName, vtEmail, vtWork, vtMobile, vtSkype, vtDesignation, vtDepartment];
   var nullExists = false;
   for (var i = 0; i < cols.length; i++) {
       for (var j = 0; j < cols[i].length; j++) {
           if (!cols[i][j]) {
               nullExists = true;
               break;
           }
       }
       if (nullExists) break;
   }

   if (nullExists) {
       alert('Fill all fields of Contact persons table.');
       return;
   }

   // Check if all required fields are filled
   if (vtype && vtitle && vfName && vlName && vEmail && vMob) {
       $.ajax({
           type: 'POST',
           url: '{% url "newVendorAjax" %}',
           data: {
               'type': vtype,
               'title': vtitle,
               'first_name': vfName,
               'last_name': vlName,
               'company_name': cmpName,
               'vendor_display_name': disName,
               'vendor_email': vEmail,
               'mobile': vMob,
               'phone': vphone,
               'gst_treatment': vgstType,
               'gst_number': vgstIN,
               'pan_number': vpanNo,
               'skype_name_number': Skypename,
               'designation': Desg,
               'department': Dept,
               'website': Vweb,
               'billing_attention': vatten,
               'billing_country': vcountry,
               'billing_address': vaddress,
               'billing_city': vcity,
               'billing_state': vstate,
               'billing_pin_code': vzip,
               'billing_phone': vphoneBilling,
               'billing_fax': vfax,
               'shipping_attention': vsatten,
               'shipping_country': vscountry,
               'shipping_address': vsaddress,
               'shipping_city': vscity,
               'shipping_state': vsstate,
               'shipping_pin_code': vszip,
               'shipping_phone': vsphone,
               'shipping_fax': vsfax,
               'source_of_supply': source,
               'currency': CURE,
               'opening_balance_type': optypeDebit || optypeCredit,
               'opening_balance': opblnc,
               'credit_limit': credit,
               'remark': vremark,
               'vendorcontact_person': JSON.stringify({
                   'title': vtSalutation,
                   'first_name': vtFirstName,
                   'last_name': vtLastName,
                   'email': vtEmail,
                   'work_phone': vtWork,
                   'mobile': vtMobile,
                   'skype_name_number': vtSkype,
                   'designation': vtDesignation,
                   'department': vtDepartment
               }),
               'csrfmiddlewaretoken': $('input[name="csrfmiddlewaretoken"]').val(),
           },
           success: function(response) {
               console.log("AJAX Success", response);
               // Reset the form
               $('#newVendorForm')[0].reset();
               // Close modal if open
               if ($('#newVendor').hasClass('show')) {
                   $("#newVendor .close").click();
               }
               // Reload or update vendor-related data
               reloadVendor(vtitle, vfName, vlName);
           },
           error: function(xhr, status, error) {
               console.error("AJAX Error:", xhr.responseText);
               alert('An error occurred while processing your request.');
           }
       });
   } else {
       // Inform user to fill all required fields
       alert('Please fill out all required fields.');
   }
});



function reloadVendor(title, fName, lName) {
   const fullName = `${title} ${fName} ${lName}`;
   $.ajax({
       url: "{% url 'get_vendor_data' %}",
       type: "GET",
       dataType: "json",
       success: function(data) {
           console.log('Ajax Response ->', data);
           var vendDrpDwn = $('#vend_drop');
           vendDrpDwn.empty();
           vendDrpDwn.append('<li class="dropdown-item customers-options text-white" onclick="getvendorDetails(\'\', \'\')">Select Vendor</li>');
           $.each(data, function(key, value) {
               const vendorDetails = `${value.title} ${value.first_name} ${value.last_name}`;
               const ID = value.id;
               const vendorlistItem = $('<li class="dropdown-item customers-options text-white"></li>')
                   .text(vendorDetails)
                   .attr('onclick', `getvendorDetails('${ID}', '${vendorDetails}')`);
               vendDrpDwn.append(vendorlistItem);

               // Automatically select the newly added vendor
               if (vendorDetails === fullName) {
                   getvendorDetails(ID, vendorDetails);
               }
           });
           console.log('Vendors RELOADED');
       },
       error: function(xhr, status, error) {
           console.error('Error:', xhr.responseText);
       }
   });
}




 
</script>
<script>
   console.log('Vendor Data URL:', "{% url 'get_vendor_data' %}");
</script>
<!--add customer modal-->
<script>
    function deleteContact(button) {
        var row = button.parentNode.parentNode;
        row.parentNode.removeChild(row);
    }
  
    document.querySelector('.add_another').addEventListener('click', function() {
        var table = document.getElementById('tbl').getElementsByTagName('tbody')[1];
        var newRow = table.insertRow(table.rows.length);
  
        for (var i = 1; i < 9; i++) {
            var cell = newRow.insertCell(i);
            cell.innerHTML = '<input type="text" class="form-control border-1 bg-transparent text-white" name="dynamic[]">';
        }
  
        var deleteCell = newRow.insertCell(9);
        deleteCell.innerHTML = '<button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button>';
    });
  
   
  
    $(document).ready(function() {
    // Attach event listener to input fields
    $('#opa, #cl').on('input', function() {
        // Get values of the input fields
        var openingBal = parseFloat($('#opa').val());
        var creditLimit = parseFloat($('#cl').val());
  
        // Check if credit limit is greater than opening balance amount
        if (creditLimit > openingBal) {
            // Show custom alert
            $('#custom-alert').fadeIn();
  
            // Clear the value of #cl
            $('#cl').val('');
        }
    });
  
    // Close custom alert when close button is clicked
    $('.close-btn').on('click', function() {
        $('#custom-alert').fadeOut();
    });
  });
  
  
    $(document).ready(function(){
  
    // Get the CSRF token from the cookie
        function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
        }
        var csrftoken = getCookie('csrftoken');
  
        // Pan Number Check
  
        $('#panInput').on('input', function(){
        var panNumber = $(this).val();
        var regex = /[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
        if(regex.test(panNumber)) {
            $('#panMessage').text('PAN number is valid.').css('color', 'green');
            // PAN number is valid, call AJAX to check if it exists
            $.ajax({
            url: "{% url 'customer_check_pan' %}",
            headers: {'X-CSRFToken': csrftoken}, 
            type: 'POST',
            data: {panNumber: panNumber},
            success: function(response) {
                if (response.status == 'exists') {
                    $('#panMessage').text('PAN number already exists.').css({
                        'color': 'red',
                        'font-size': '12px'
                    });
                    
                }
            }
            });
        } else {
            $('#panMessage').text('Please enter a valid PAN number.').css({
                'color': 'red',
                'font-size': '12px'
            });
        }
        });
  
        // Pna Number Check End 
  
  
        // GST Number Check 
  
        $('#gstInput').on('input', function(){
            var gstNumber = $(this).val();
            var regex = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
            if(regex.test(gstNumber)) {
                $('#gstMessage').text('GST number is valid.').css('color', 'green');
                // GST number is valid, call AJAX to check if it exists
                $.ajax({
                    url: "{% url 'customer_check_gst' %}",
                    headers: {'X-CSRFToken': csrftoken}, 
                    type: 'POST',
                    data: {gstNumber: gstNumber},
                    success: function(response) {
                        if (response.status == 'exists') {
                            $('#gstMessage').text('GST number already exists.').css({
                                'color': 'red',
                                'font-size': '12px'
                            });
                            
                        }
                    }
                    });
            } 
            else {
                $('#gstMessage').text('Please enter a valid GST number.').css({
                    'color': 'red',
                    'font-size': '12px'
                });
            }
            });
    
        // GST Number Check End 
  
    });
  
      // Name display 
  
        
      const Title = document.getElementById('select1');
  const fname = document.getElementById('fname');
  const laname = document.getElementById('lname');
  const vDisplayName = document.getElementById('v_display_name');
  
  // Listen for input events on the initial input fields
  Title.addEventListener('input', updateOutputFields);
  fname.addEventListener('input', updateOutputFields);
  laname.addEventListener('input', updateOutputFields);
  
  // Function to update the output fields
  function updateOutputFields() {
    const selectedTitle = Title.value;
    const selectedFname = fname.value;
    const selectedLname = laname.value;
  
    // Clear existing options
    vDisplayName.innerHTML = '';
  // Add new options based on input field values
  const option1 = document.createElement('option');
    option1.text = selectedTitle + ' ' + selectedFname + ' ' + selectedLname;
    vDisplayName.add(option1);
  
   
  
    const option2 = document.createElement('option');
    option2.text = selectedFname + ' ' + selectedLname;
    vDisplayName.add(option2);
  
    const option3 = document.createElement('option');
    option3.text = selectedLname + ' ' + selectedFname;
    vDisplayName.add(option3);
  }
  
  
    function gstPan_function(){
        var x=document.getElementById('GSTT').value
        if(x=="Unregistered Business-not Registered under GST")
        {
            document.getElementById("pan").style.display="block";
            document.getElementById("gst").style.display="none";
  
            
        }
        else if((x=="Registered Business-Regular Business that is registered under GST") || (x=="Registered Business-Composition Business that is registered under the Composition scheme in GST") || (x=="Overseas- Persons with who you do import or exports of supplies outside india") || (x=="Special Economic Zone"))
        {
            document.getElementById("gst").style.display="block";
            document.getElementById("pan").style.display="block";
  
  
        }
    
    }
  
  
  
    $(document).ready(function () {
        $(".toggle1").click(function (e) {
          e.preventDefault();
          $("fieldset1").toggle();
        })
      })
      $(document).ready(function () {
        $(".toggle2").click(function (e) {
          e.preventDefault();
         
          $("fieldset2").toggle(); 
          $("fieldset5").hide();
          $("fieldset6").hide();
          $("fieldset7").hide();
  
  
      
        })
      })
  
      $(document).ready(function () {
        $(".toggle3").click(function (e) {
          e.preventDefault();
          $("fieldset5").toggle();
          $("fieldset2").hide();
          $("fieldset6").hide();
          $("fieldset7").hide();
  
        })
      })
      $(document).ready(function () {
        $(".toggle4").click(function (e) {
          e.preventDefault();
          $("fieldset6").toggle();
          $("fieldset2").hide();
          $("fieldset5").hide();
          $("fieldset7").hide();
                
        })
      })
      $(document).ready(function () {
        $(".toggle7").click(function (e) {
          e.preventDefault();
          $("fieldset7").toggle();
          $("fieldset2").hide();
          $("fieldset6").hide();
          $("fieldset5").hide();
         
  
         
        })
      })
  
  
  
    $('document').ready(function () {
        $('.add_another').click(function () {
          $("#tbl").append(`<tr>
            <td>
                <select name="salutation[]" class="salutation form-control bg-transparent border-1 text-white">
                  <option value="" class="text-dark">Select</option>
                    <option value="Mr" class="text-dark">Mr.</option>
                    <option class="text-dark" value="Mrs">Mrs.</option>
                    <option class="text-dark" value="Ms">Ms.</option>
                    <option class="text-dark" value="Miss">Miss.</option>
                    <option class="text-dark" value="Dr">Dr.</option>
                </select>  
            </td>
            <td>
                <input type="text" name="first_name[]" class="first_name form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="text" name="last_name[]" class="last_name form-control border-1 bg-transparent text-white"   value="" />
            </td>
            <td>
                <input type="email" name="email[]" class="email form-control border-1 bg-transparent text-white" value="" />
            </td>
            <td>
                <input type="tel" pattern="[0-9]{7}" id="twphone" name="wphone[]" class="work_phone form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="tel" pattern="[0-9]{10}" id="tmobile" onclick="sample1()" name="mobile[]" class="mobile_phone form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="number" onclick="sample()" name="skype[]" class="skype_number form-control border-1 bg-transparent text-white"  value="" />
            </td>
            <td>
                <input type="text" name="designation[]" class="designation form-control border-1 bg-transparent text-white" value="" />
            </td>
            <td>
                <input type="text" name="department[]" class="department form-control border-1 bg-transparent text-white" value="" />
            </td>
            <td><button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button></td>
        </tr>`);
        });
      })
  
      function fieldset5_function()
      {
        document.getElementById("address").style.display="block";
      }
  
    
  
    function myCopyAddressFunction() {
        var checkBox = document.getElementById("myCheckT");
        var textatn = document.getElementById("batten");
        var txtcry = document.getElementById("bctry");
        var txtadrs11 = document.getElementById("badd1");
        var txtcty = document.getElementById("bcty");
        var txtstat = document.getElementById("bste");
        var txtzip = document.getElementById("bzp");
        var txtphone = document.getElementById("bphone_num");
        var txtfx = document.getElementById("bfx");
  
        var textatn1 = document.getElementById("satten");
        var txtcry1 = document.getElementById("sctry");
        var txtadrs21 = document.getElementById("sadd1");
        var txtcty1 = document.getElementById("scty");
        var txtstat1 = document.getElementById("sste");
        var txtzip1 = document.getElementById("szp");
        var txtphone1 = document.getElementById("sphone_num");
        var txtfx1 = document.getElementById("sfx");
        if (checkBox.checked == true) {
          textatn1.value = textatn.value;
          txtadrs21.value = txtadrs11.value;
          txtcty1.value = txtcty.value;
          txtstat1.value = txtstat.value;
          txtzip1.value = txtzip.value; 
          txtphone1.value = txtphone.value;
          txtfx1.value = txtfx.value;
          
  
  
  
          
  
        } else {
          txtadrs21.value = "";
          txtcty1.value = "";
          txtstat1.value = "";
          txtzip1.value = "";
          txtphone1.value = "";
          txtfx1.value = "";
          txtcry1.value = "";
          textatn1.value = "";
  
  
        }
      }
  
  
      function open_table()
      {
        document.getElementById("hid").style.display="block";
        
      }
  
  
  
    
  
      function bphone_number()
      {
        var a1=document.getElementById("bphone_num").value;
        var b1=document.getElementById("bphone_label");
        var expr=/^[0-9]{10}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Phone Number. Please Enter 10 digit Number";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Phone Number.";
  
        }
      }
  
      function sphone_number()
      {
        var a1=document.getElementById("sphone_num").value;
        var b1=document.getElementById("sphone_label");
        var expr=/^[0-9]{10}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Phone Number.";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Phone Number.";
  
        }
      }
  
      function fax_number()
      {
        var a1=document.getElementById("bfx").value;
        var b1=document.getElementById("fax_label");
        var expr=/^[0-9]{7}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Fax Number.Please Enter 7 digit Number";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Fax Number.";
  
        }
      }
  
      function sfax_number()
      {
        var a1=document.getElementById("sfx").value;
        var b1=document.getElementById("sfax_label");
        var expr=/^[0-9]{7}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Invalid Fax Number.";
        }
        else{
            b1.style.color="green";
            b1.style.fontSize="0.750rem";
            b1.innerHTML = "Valid Fax Number.";
  
        }
      }
  
    
      function sample()
      {
  
        var tbldata = document.getElementById("tbl");
        var total_rows = tbldata.rows.length;
        x=document.getElementById("tbl");
        var a1=x.rows[total_rows-1].cells[5].getElementsByTagName('input')[0].value;
  
        var b1=document.getElementById("tlabel");
  
        b1.innerHTML = "";
  
        var expr=/^[0-9]{10}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.innerHTML = "Invalid";
            b1.style.fontSize="0.750rem";
        }
        else{
            b1.style.color="green";
            b1.innerHTML = "Valid";
            b1.style.fontSize="0.750rem";
  
        }
  
       
  
      }
  
      function sample1()
      {
  
        var tbldata = document.getElementById("tbl");
        var total_rows = tbldata.rows.length;
        x=document.getElementById("tbl");
        var a1=x.rows[total_rows-1].cells[4].getElementsByTagName('input')[0].value;
  
        var b1=document.getElementById("twph_label");
  
        b1.innerHTML = "";
  
        var expr=/^[0-9]{7}$/;
        if (!expr.test(a1)) {
            b1.style.color="red";
            b1.innerHTML = "Invalid";
            b1.style.fontSize="0.750rem";
        }
        else{
            b1.style.color="green";
            b1.innerHTML = "valid";
            b1.style.fontSize="0.750rem";
  
        }
  
  
      }
  
  
  
    function vendor_display()
    {
        var x=document.getElementById("select1").value;
        var y=document.getElementById("fname").value;
        var z=document.getElementById("lname").value;
  
        document.getElementById("select2").innerHTML=x+" "+y+" "+z
    
        
    }
  
  
    // Get the input element
    const inputElement = document.getElementById("tname");
  
    // Add event listener for input event
    inputElement.addEventListener("input", function() {
        // Convert the input value to uppercase
        this.value = this.value.toUpperCase();
    });
  
  
  $(document).ready(function() {
    $('#tname').on('blur', function() {
        
        var termName = $(this).val();
       
        $.ajax({
            type: 'GET',
            url:'{% url "check_customer_term_exist" %}',
            data: {
                term_name: termName
            },
            success: function(response) {
                if (response.exists) {
                  alert('Term already exists !')
                    $('#message-id').text('Term already exists !');
                    $('#success-message-id').text('');
                  
                    $('#tname').val('');
                } else {
                    $('#success-message-id').text('Term name available !');
                    $('#message-id').text('');
                }
                
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
            }
        });
    });
  });
  
  $('#vendor-email').on('input', function() {
        
    var vendorEmail = $(this).val();
    console.log(vendorEmail)
    $.ajax({
        type: 'GET',
        url:'{% url "check_customer_email_exist" %}',
        data: {
            vendor_email: vendorEmail
        },
        success: function(response) {
            if (response.exists) {
                $('#email-message-id').text('Email id already exists !');
                $('#vendor-email').val('');
            }
            else{
                $('#email-message-id').text('');
            }
            
        },
        error: function(xhr, status, error) {
            console.error('Error:', error);
        }
    });
  });
  
  $('#workphone').on('input', function() {
        
    var wPhone = $(this).val();
    
    $.ajax({
        type: 'GET',
        url:'{% url "check_customer_work_phone_exist" %}',
        data: {
            w_Phone: wPhone
        },
        success: function(response) {
            if (response.exists) {
                $('#workphone_label').text('Work phone number already exists !');
                $('#workphone').val('');
            }
            else{
                $('#workphone_label').text('');
            }
            
        },
        error: function(xhr, status, error) {
            console.error('Error:', error);
        }
    });
  });
  
  
  $('#mphone').on('input', function() {
        
    var mPhone = $(this).val();
    
    $.ajax({
        type: 'GET',
        url:'{% url "check_customer_phonenumber_exist" %}',
        data: {
            m_Phone: mPhone
        },
        success: function(response) {
            if (response.exists) {
                $('#mphone_label').text('Phone number already exists !');
                $('#mphone').val('');
            }
            else{
                $('#mphone_label').text('');
            }
            
        },
        error: function(xhr, status, error) {
            console.error('Error:', error);
        }
    });
  });
  
    // Work Phone Number Validation 
    $(document).ready(function () {
        $('#workphone').on('input', function () {
            var inputVal = $(this).val();
            var expr = /^[0-9]{7}$/;
            if (expr.test(inputVal)) {
                $('#work-phone-message').text('Valid work phone number').css('color', 'green');
            } else {
                $('#work-phone-message').text('Invalid work phone number').css('color', 'red');
            }
        });
    });
  
    // Phone Number Validation
    $(document).ready(function () {
        $('#mphone').on('input', function () {
            var inputVal = $(this).val();
            var expr=/^[0-9]{10}$/;
            if (expr.test(inputVal)) {
                $('#phone-message').text('Valid  phone number').css('color', 'green');
            } else {
                $('#phone-message').text('Invalid  phone number').css('color', 'red');
            }
        });
    });
  
    $(document).on("click","#customerPaymentTermSave",function(){
          var trm = $('#tname').val();
          var dys = $("#tdays").val();
          if (trm !="" && dys !=""){
              $.ajax({
                  type : 'POST',
                  url:"{% url 'newPaymentTermAjax' %}",
                  data:{
                      'term' : trm,
                      'days' : dys,
                      csrfmiddlewaretoken: '{{ csrf_token }}'
                  },
                  
                  success: function(response) {
                      if(response.status){
                          document.getElementById("newTermForm").reset();
                          
                          var dropdown = $('#paytearm-select');
                          dropdown.empty();
                          dropdown.append(`<option value="" selected>Choose</option>`);
                          $.each(response, function(key, value) {
                              for(let i=0; i<value.length; i++){
                                  if(value[i].name == trm){
                                      dropdown.append($('<option selected></option>').text(value[i].name).val(value[i].id))
                                  }else{
                                      dropdown.append($('<option></option>').text(value[i].name).val(value[i].id))
                                  }   
                              }
                          });
  
                      }else{
                          alert("Something went wrong.!")
                      }
                  },         
              });
          }
          else{
              alert('Invalid')
          }
      });
  
  
    $(document).on("click", "#newCustomerSave", function(){
        var type = $('input[name="type"]:checked').val();
        var title = $('#select1').val();
        var fName = $('#fname').val();
        var lName = $('#lname').val();
        var placeSupply = $('#PLACE').val();
        var gstType = $("#GSTT").val();
        var gstIN = $("#gstInput").val();
        var panNo = $("#panInput").val();
        var Email = $("#vendor-email").val();
        var Mob = $("#mphone").val();
        var street = $("#badd1").val();
        var city = $("#bcty").val();
        var state = $("#bste").val();
        var pin = $("#bzp").val();
        var country = $("#btry").val();
        var tax_ref = $('input[name="tax1"]:checked').val();
        var tSalutation = []
        var tFirstName = []
        var tLastName = []
        var tEmail = []
        var tWork = []
        var tMobile = []
        var tSkype = []
        var tDesignation = []
        var tDepartment = []
  
        if(gstType != "" && gstType != "Unregistered Business-not Registered under GST" && gstType != 'Overseas- Persons with who you do import or exports of supplies outside india' && gstIN == ""){
            alert('Fill Enter GSTIN..!')
            return
        }
  
        $('#tbl tbody tr').each(function(){
          var row = $(this)
          if(row != ""){
              var sal = row.find('.salutation').val();
              var fn = row.find('.first_name').val();
              var ln = row.find('.last_name').val();
              var eml = row.find('.email').val();
              var wrk = row.find('.work_phone').val();
              var mob = row.find('.mobile_phone').val();
              var sky = row.find('.skype_number').val();
              var dep = row.find('.department').val();
              var des = row.find('.designation').val();
              console.log(sal,fn,ln, eml,wrk, mob, sky, dep, des)
              // if(sal == "" && fn == "" && ln == "" && eml == "" && wrk == "" && mob == "" && sky == "" && dep == "" && des == ""){
              //     console.log('No table data')
              // }else{
              //     if(sal == "" || fn == "" || ln == "" || eml == "" || wrk == "" || mob == "" || sky == "" || dep == "" || des == ""){
              //         // alert('Fill All Fields of Contact persons table')
              //         // return
              //     }
              // }
              tSalutation.push(sal);
              tFirstName.push(fn);
              tLastName.push(ln);
              tEmail.push(eml);
              tWork.push(wrk);
              tMobile.push(mob);
              tSkype.push(sky);
              tDesignation.push(des);
              tDepartment.push(dep);
          }
      })
      var cols = [tSalutation,tFirstName,tLastName,tEmail,tWork,tMobile,tSkype,tDesignation,tDepartment]
      var cntactTableLength = $('#tbl tbody tr').length
      var nullExists = false
      if(cntactTableLength == 1 && tSalutation[0] == "" && tFirstName[0] == "" && tLastName[0] == "" && tEmail[0] == "" && tWork[0] == "" && tMobile[0] == "" && tSkype[0] == "" && tDesignation[0] == "" && tDepartment[0] == ""){
          console.log('No table data')
      }else{
          for(i=0; i<cols.length; i++){
              for(j=0; j<cols[i].length; j++){
                  if(cols[i][j] == ''){
                      nullExists = true
                  }
              }
          }
          // if(sal == "" || fn == "" || ln == "" || eml == "" || wrk == "" || mob == "" || sky == "" || dep == "" || des == ""){
          //     // alert('Fill All Fields of Contact persons table')
          //     // return
          // }
      }
      if(nullExists){
          alert('Fill All Fields of Contact persons table')
          return
      }
  
        if(fName != "" && lName != "" && placeSupply != "" && gstType != "" && panNo != "" && Email != "" && Mob != "" && tax_ref != undefined){
            $.ajax({
                type : 'POST',
                url:"{% url 'newSalesCustomerAjax' %}",
                data:{
                  'type': type,
                  'salutation' : title,
                  'first_name' : fName,
                  'last_name' : lName,
                  'company_name' : $('#companyName').val(),
                  'v_display_name' : $('#v_display_name').val(),
                  'vendor_email' : Email,
                  'w_phone' : $('#workphone').val(),
                  'm_phone' : Mob,
                  'skype_number' : $('#skypeNumber').val(),
                  'designation' : $('#design').val(),
                  'department' : $('#dept').val(),
                  'website' : $('#web').val(),
                  'gst' : gstType,
                  'remark' : $('#rmrk').val(),
                  'pan_number' : panNo,
                  'gst_number' : gstIN,
                  'source_supply' : placeSupply,
                  'currency' : $('#crncy').val(),
                  'op_type' : $('input[name="op_type"]:checked').val(),
                  'opening_bal' : $('#opa').val(),
                  'payment_terms' : $('#paytearm-select').val(),
                  'plst' : $('#priceLs').val(),
                  'plang' : $('#plang').val(),
                  'fbk' : $('#fbk').val(),
                  'twtr' : $('#twtr').val(),
                  'tax1' : tax_ref,
                  'battention' : $('#batten').val(),
                  'bcountry' : country,
                  'baddress' : street,
                  'bcity' : city,
                  'bstate' : state,
                  'bzip' : pin,
                  'bphone' : $('#bphone_num').val(),
                  'bfax' : $('#bfx').val(),
                  'sattention' : $('#satten').val(),
                  's_country' : $('#sctry').val(),
                  'saddress' : $('#sadd1').val(),
                  'scity' : $('#scty').val(),
                  'sstate' : $('#sste').val(),
                  'szip' : $('#szp').val(),
                  'sphone' : $('#sphone_num').val(),
                  'sfax' : $('#sfx').val(),
                  'tsalutation[]' : tSalutation,
                  'tfirstName[]' : tFirstName,
                  'tlastName[]' : tLastName,
                  'tEmail[]' : tEmail,
                  'tWorkPhone[]' : tWork,
                  'tMobilePhone[]' : tMobile,
                  'tSkype[]' : tSkype,
                  'tDesignation[]' : tDesignation,
                  'tDepartment[]' : tDepartment,
                  csrfmiddlewaretoken: '{{ csrf_token }}',
                },
  
                success: function(response) {
                  if(response.status){
                      console.log("AJAX Success",response)
                      document.getElementById("newCustomerForm").reset();
                      if($('#newCustomer').hasClass('show')){
                          $("#newCustomer .close_customer_modal").click()
                      }
                      reloadCustomer(title, fName, lName);
                  }else{
                      alert(response.message)
                  }
                },
            });
        }else{
            alert('Fill all required fields..!')
            return
        }
    });
  
  
    function reloadCustomer(title,fName,lName) {
        const fullName = title+' '+fName+' '+lName
        $.ajax({
            url: "{% url 'getCustomersAjax' %}",
            type: "GET",
            dataType: "json",
            data: {},
  
            success: function(data) {
                console.log('Ajax Response ->',data);
                var custDrpDwn = $('#cust_drop');
                custDrpDwn.empty();
                custDrpDwn.append(`<li class="dropdown-item customers-options text-white" onclick="getCustomerDetails('','')">Select Customer</li>`);
  
                $.each(data, function (key, value) {
                    const customerDetails = `${value[1]} ${value[2]} ${value[3]}`;
                    const ID = `${value[0]}`
  
                    if(customerDetails == fullName){
                        getCustomerDetails(value[0], customerDetails)
                    }
                    const listItem = $(`
                        <li class="dropdown-item customers-options text-white" onclick="getCustomerDetails('${ID}', '${customerDetails}')">${customerDetails}</li>`
                    );
                    custDrpDwn.append(listItem);
                });
                console.log('Customers RELOADED');
  
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
  
        });
        // refreshCustomerDetails();
  
        if ($('#newpayment').hasClass('show')){
            $('#newpayment .cust_payment_modal_close').click();
        }
    }
  </script>









{%endblock%}