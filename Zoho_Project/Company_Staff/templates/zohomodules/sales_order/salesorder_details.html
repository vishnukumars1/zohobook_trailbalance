{% extends 'base.html' %}
{% block content %}
{% load static %}
{% load social_shareÂ %}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Title</title>
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-xxxxxx" crossorigin="anonymous" />
    
</head>


    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"> -->
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<style>
    .hidden {
        display: none;
    }
    .bs{
        box-shadow: 2px 2px 10px 3px rgba(0, 0, 0, 0.397);
    }

    .bs_sm{
        box-shadow: inset 2px 2px 5px 3px rgba(0, 0, 0, 0.199);
    }

    .paiddiv{
        color: black;
        height: 10vh;
        width: 20vh;
        padding-left: 2vh;
        padding-top: 1vh;
        padding-bottom: 1vh;
        margin-left: 7vh;
        border-radius: 8px;
        background-color: rgb(0, 0, 0);
    }

    .unpaiddiv{
        color: black;
        height: 10vh;
        width: 20vh;
        padding-left: 2vh;
        padding-top: 1vh;
        padding-bottom: 1vh;
        margin-left: 7vh;
        border-radius: 8px;
        background-color: lightsteelblue;
    }

    .totaldiv{
        color: black;
        height: 10vh;
        width: 20vh;
        padding-left: 2vh;
        padding-top: 1vh;
        padding-bottom: 1vh;
        margin-left: 7vh;
        border-radius: 8px;
        background-color: lightgreen;
    }

    #billtable tbody{
        cursor: pointer;
    }

    #emptyMessage {
        display: none;
        font-size: x-large;
        font-weight: bold;
        color: red;
    }

    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        border-radius: 5px;
        padding: 10px;
        z-index: 1;
        width: 15%;
    }

    .dropdown-content label {
        display: block;
        margin-bottom: 5px;
    }

    .dropdown-content input {
        width: 100%;
        padding: 5px;
        box-sizing: border-box;
        margin-bottom: 10px;
    }

    .tplus{
        margin-top: 3vh;
        margin-left: 5vh;
        margin-right: -2vh;
    }

    .tequal{
        margin-top: 3vh;
        margin-left: 5vh;
        margin-right: -2vh;
    }

    .tg{
        color: rgb(0, 140, 7);
    }

    .tr{
        color: rgb(218, 0, 0);
    }

    .tj{
        color:#E4A11B;
    }

    .th{
        color: rgb(247, 227, 100);
    }

    @media print{
        body{
            visibility: hidden !important; /* hide everything in body when in print mode*/
        }

        .printContainer {
            visibility: visible !important; /* Override the rule above to only show the printables*/
            position: absolute;
            z-index: 99999;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            font-size: large;
        } 

        #calcdiv{
            visibility: visible;
            margin-top: -30vh;
            margin-left: -9vh;
            margin-bottom: 30vh;
        }

        #billtable{
            margin-top: 20vh;
            margin-bottom: 20vh;
        }

        #billtable th{
            font-size: medium;
        }

        .extra{
            display: none;
        }
    }
    
    ::-webkit-scrollbar{
        display: none
    }
</style>

<style>
    .modal {
    z-index: 9999;
    overflow: scroll;
    }

    .modal-content {
    background-color: #f9f8f8;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    }

    /* Add your CSS styles here */
    /* Styling for the filter input window */
/* Styling for the filter input window */
.filter-window {
    display: none;
    position: absolute;
    padding: 10px;
    color: rgb(6, 9, 11);
    width: 10%;
    background-color: rgb(19, 24, 24);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    z-index: 1; /* Ensures the window is on top */
}

/* Additional styling for the filter input */
.filter-window label, .filter-window input, .filter-window button {
    display: block;
    margin-bottom: 5px;
}
.filter-window button {
    display: inline-block;
    margin-right: 5px;
    padding: 5px 10px;
    background-color: #4CAF50; /* Green background color */
    color: white; /* White text color */
    border: none; /* Remove border */
    border-radius: 3px; /* Optional: Add rounded corners */
    cursor: pointer; /* Add a pointer cursor on hover */
}

.filter-window button:hover {
    background-color: #45a049; /* Darker green on hover */
}
    .filterTable-column .dropdown-toggle::after{
        content: none;
    }
    .filterTable-column .btn:focus{
        box-shadow: none;
    }
    .card-registration .select-input.form-control[readonly]:not([disabled]) {
        font-size: 1rem;
        line-height: 2.15;
        padding-left: .75em;
        padding-right: .75em;
    }

    .card-registration .select-arrow {
        top: 13px;
    }

    .bg-grey {
        background-color: rgba(0, 0, 0, 0.4);
    }

    @media (min-width: 992px) {
        .card-registration-2 .bg-grey {
            border-top-right-radius: 16px;
            border-bottom-right-radius: 16px;
        }
    }

    @media (max-width: 991px) {
        .card-registration-2 .bg-grey {
            border-bottom-left-radius: 16px;
            border-bottom-right-radius: 16px;
        }
    }

    .vl {
        border-left: 6px solid rgb(15, 11, 11);
    }

    .table-row {
        cursor: pointer;
    }
    .submitShareEmailBtn, #commentSaveBtn {
        border: 1px solid #3a4b5a;
        border-radius: 4px;
        color: white;
        font-weight: 600;
        padding: 0.5rem 1rem;
    }
   
    .print-only {
        /* display: none; */
        height: auto;
        width: auto;
        overflow-y: auto;
        border: none;
        
        /* box-shadow: 5px 2px 5px 2px  grey; */
    }
    .ribbon .ribbon-inner {
        text-align: center;
        color: #fff;
        top: -20px;
        left: -90px;
        width: 120px;
        padding: 3px;
        /* position: relative;
        transform: rotate(-45deg); */
    }
    .ribbon .ribbon-open {
        background-color: #eeae24;
        border-color: #664f11;
    }
    :root {
        --body-bg: rgb(204, 204, 204);
        --white: #ffffff;
        --darkWhite: #ccc;
        --black: #000000;
        --dark: #615c60;
        --themeColor: #eec554;
        --pageShadow: 0 0 0.5cm rgba(0, 0, 0, 0.5);
    }
    @media print {
        body{
            visibility: hidden !important;
            /* background-color: white; */

        }

        #slip{
            margin-left: 2vh;
            margin-right: 2vh;
        }

        .printContainer {
            visibility: visible !important;
            position: absolute;
            z-index: 99999;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            font-size: large;
        }

    }
    /* Font Include */
    @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@600&display=swap');

    .page {
        background: var(--white);
        display: block;
        margin: 0 auto;
        position: relative;
        box-shadow: var(--pageShadow);
    }

    .page[size="A4"] {
        width: 21cm;
        height: 29.7cm;
        overflow: hidden;
    }

    .bb {
        border-bottom: 3px solid var(--darkWhite);
    }

    /* Top Section */
    .top-content {
        padding-bottom: 15px;
    }

    .logo img {
        height: 60px;
    }

    .top-left p {
        margin: 0;
        color: #000000;
    }

    .top-left .graphic-path {
        height: 40px;
        position: relative;
    }

    .top-left .graphic-path::before {
        content: "";
        height: 20px;
        background-color: var(--dark);
        position: absolute;
        left: 15px;
        right: 0;
        top: -15px;
        z-index: 2;
    }

    .top-left .graphic-path::after {
        content: "";
        height: 22px;
        width: 17px;
        background: var(--black);
        position: absolute;
        top: -13px;
        left: 6px;
        transform: rotate(45deg);
    }

    .top-left .graphic-path p {
        /* color: var(--white); */
        height: 40px;
        left: 0;
        right: 0;
        text-transform: uppercase;
        background-color: var(--themeColor);
        /* font: 26px; */
        z-index: 3;
        position: absolute;
        padding-left: 10px;
    }
    
    /* User Store Section */
    .store-user {
        padding-bottom: 25px;
    }

    .store-user p {
        margin: 0;
        font-weight: 600;
        color: #000000;
    }

    .store-user .address {
        font-weight: 400;
    }

    .store-user h5 {
        color: var(--themeColor);
        font-family: 'Rajdhani', sans-serif;
    }

    .extra-info p span {
        font-weight: 400;
    
    }

    /* Product Section */
    thead {
        color: var(--white);
    }

    .table td,
    .table th {
        text-align: center;
        vertical-align: middle;
    }

    tr th:first-child,
    tr td:first-child {
        text-align: left;
    }

    /* Balance Info Section */
    .balance-info .table td,
    .balance-info .table th {
        padding: 0;
        border: 0;
    }

    .balance-info tr td:first-child {
        font-weight: 600;
    }

    /* SLIP VIEW STYLINGS */
    .slip h5{
        font-family: serif;
    }
    p {
        font-size: 1.2em;
    }
    .address{
        display: flex;
        flex-direction: column;
    }
    .address p,.slip-footer p{
        font-size: 1rem;
        margin: 0;
    }
    .slip-container{
        width: 105mm;
        margin: 2rem auto;
        padding: 2rem;
        border: 1px dotted black;
        box-shadow: rgba(60, 64, 67, 0.5) 0px 1px 2px 0px, rgba(60, 64, 67, 0.35) 0px 2px 6px 2px;
    }
    .divider{
        margin: 1rem 0;
        border-bottom: 3px dotted black;
    }
    .trns-id p,.datetime p, .createdby p{
        font-size: 0.85rem;
        margin: 0;
    }
    .equal-length-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 100%;
        margin-left: 2vh;
        margin-right: 2vh;
    }

    .equal-length-item {
        flex: 1;
        text-align: center;
    }


    .scrollable-container {
        border-right: 1px solid white;
        overflow-y: scroll;
        height: 84vh;
    }
    
    .scrollable-container::-webkit-scrollbar {
        width: 0; /* Set width to 0 to hide the scrollbar */
    }
    </style>
    <body>

        <!-- Your HTML content goes here -->
        
        <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
        <script src="https://raw.githack.com/eKoopmans/html2pdf/master/dist/html2pdf.bundle.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script src="https://unpkg.com/htmx.org@1.9.6" integrity="sha384-FhXw7b6AlE/jyjlZH5iHa/tTe9EpJ1Y55RjcgPbjeWMskSxZt1v9qkxLJWNJaGni" crossorigin="anonymous"></script>
        <script src="https://kit.fontawesome.com/274ee977b7.js" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.debug.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
        
                                              
        
                                              
<div class="body-wrapper" >
    <div class="container-fluid">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>
          <li class="breadcrumb-item"><a href="{% url 'salesorder_list' %}" class="text-warning-emphasis"> Salesorder list</a></li>
          <li class="breadcrumb-item" aria-current="page" id="over">Overview</li>
          <li class="breadcrumb-item" aria-current="page" id="tran" style="display: none;">Transaction</li>
          <li class="breadcrumb-item" aria-current="page" id="state" style="display: none;">Statement</li>
        </ol>
      </nav>
      <div class="row pt-3">
        <div class="col-md-12">
          <div class="card mb-5">
            <div class="row" style="background-color: #252525;" >
              <!-- Left Side: Table -->
              <div class="col-md-12 col-lg-4" style="background-color: black; border-radius: 1vh;" >
                <div class="p-4"> 
                  <h6 class="pt-3" style="font-size: 1.8rem; color: white;">All Sales Orders</h6>
                  <div class="d-flex justify-content-between gap-1 mt-2 mr-4">
                    <input class="form-control text-black bg-light mt-4" type="text" id="search" placeholder="Search..." style="margin-right: 10%;">
  
                    <a class="btn btn-outline-warning small_btn mt-4" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                    <i class="fa fa-sort mt-1" style="font-size: small;"></i>
                    </a>
                    <div class="dropdown-menu ">
                        <a class="dropdown-item text-black" href="{% url 'sort_salesorder' 0 sale.id %}" >All</a>
                        <a class="dropdown-item" style="height: 40px; font-size: 15px;cursor: pointer;" href="{% url 'sort_salesorder' 1 sale.id %}">Customer Name</a>
                        <a class="dropdown-item" style="height: 40px; font-size: 15px;cursor: pointer;" href="{% url 'sort_salesorder' 2 sale.id %}">Sales Order No</a> 
                    </div>


                    <div class="dropdown">
                        <button class="btn btn-outline-warning small_btn mt-4 dropdown-toggle" type="button" id="statusFilter" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-filter" style="font-size: small;"></i>
                        </button>
                        <div class="dropdown-menu" aria-labelledby="statusFilter">
                          <a class="dropdown-item" href="{% url 'salesorder_status_change' 0 sale.id  %}">All</a>
                          <a class="dropdown-item" href="{% url 'salesorder_status_change' 1 sale.id  %}">Draft</a>
                          <a class="dropdown-item" href="{% url 'salesorder_status_change' 2 sale.id  %}">Saved</a>
                        </div>
                      </div>
    
                    <a class="btn btn-outline-warning small_btn mt-4" role="button" href="{% url 'salesorder' %}">
                      <i class="fa fa-plus"></i>
                    </a>
                  </div>
        
                  <div class="row">
                    <div class="col-md-12 mt-2">
                      <div class="table-responsive">
                        <table class="table text-white" id="table2">
                            <tbody>
                            {% for s in sales_objs %}
                            <tr class='clickable-row' data-href="{% url 'view_salesorder_details' s.id %}" style="cursor: pointer;">
                              <td>
                                <span class="name"><b>{{s.customer.first_name}} {{s.customer.last_name}}</b></span><br><br>
                                
                                <span class="invNo">{{ s.sales_order_number }}</span>
                              </td>
                              <td>
                                <span style="float: right;" class="amt">&#8377;{{ s.balance }}</span><br><br>
                                <span style="float: right;" class="stat">{{s.status}}</span>
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
              <script>
                function sortinvno() {
                  var table = $('#table2');
                  var rows = table.find('tr').toArray().slice(1); // Skip the header row
                  rows.sort(function(a, b) {
                    var invANum = $(a).find('.invNo').text().toLowerCase();
                    var invBNum = $(b).find('.invNo').text().toLowerCase();
                    return invANum.localeCompare(invBNum);
                  });
                  table.find('tbody').empty().append(rows);
                }
              </script>
              <script>
                function sortByName() {
                  var table = $('#table2');
                  var rows = table.find('tr').toArray().slice(1); // Skip the header row
                  rows.sort(function(a, b) {
                    var nameA = $(a).find('.name').text().toLowerCase();
                    var nameB = $(b).find('.name').text().toLowerCase();
                    return nameA.localeCompare(nameB);
                  });
                  table.find('tbody').empty().append(rows);
                }
              </script>
              <script>
                function filterByStatus(status) {
                  $('#table2 tbody tr').each(function() {
                    var rowStatus = $(this).find('.stat').text().toLowerCase();
                    if (status === 'all' || rowStatus === status) {
                      $(this).show();
                    } else {
                      $(this).hide();
                    }
                  });
                }
              </script>
              <script>
                $(document).ready(function() {
                  $('#search').on('keyup', function() {
                    var searchText = $(this).val().toLowerCase();
                    $('#table2 tbody tr').each(function() {
                      var itemData = $(this).text().toLowerCase();
                      if (itemData.indexOf(searchText) === -1) {
                        $(this).hide();
                      } else {
                        $(this).show();
                      }
                    });
                  });
                });
              </script>
              

   <div class="col-md-12 col-lg-8">
    <div style="background-color: black; border-radius: 1vh;">
      <div class="card-header p-4">
        <h6 class="mt-3" style="font-size: 1.8rem; color: white;">Sales Order</h6><br>
        {% for message in messages %}
        <h5>
          <div class="alert alert-danger message text-center" style="color: black;" id="alert_danger">
            {{ message }}
            <a type="button" id="alert_close" class="close" data-dismiss="alert" aria-label="Close" style="float: right;">
              <span aria-hidden="true" style="font-size: large; color: #68020F;">&times;</span>
            </a>
          </div>
        </h5>
        {% endfor %}
       
    <div class="row">
        <div class="col-md-6">
          <a class="btn btn-outline-warning xsmall_btn" onclick="overview()" id="overviewBtn">
            <i class="fa fa-eye" style="font-weight: bold; font-size: small;" id="overview_icon"></i> 
            <span style="font-size: small;">Overview</span>
          </a>
          <a class="btn btn-outline-warning xsmall_btn ms-1" onclick="template()" id="templateBtn">
            <span class="fa fa-file-invoice" style="font-weight: bold;  font-size: small;" id="templates_icon"></span> 
            <span style="font-size: small;">Templates</span>
          </a>
          <a class="btn btn-outline-warning xsmall_btn ms-1"  onclick="slip()" id="slipBtn">
            <i class="fa fa-receipt" style="font-weight: bold;  font-size: small;" id="slip_icon"></i>
            <span style="font-size: small;">Slip</span> 
          </a>
        </div>

    <div class="col-md-6">
        <div class="d-sm-flex" style="float: right;">
          {% if sale.status == 'Draft' %}
            <a class="btn btn-outline-warning small_btn mt-2 ms-1" onclick="return confirm('Do you want to convert this Draft to Saved ?')" title="CONVERT" id="convert_btn" href="{% url 'salesorder_status' sale.id %}">
            <i class="fa fa-exchange"></i>
            </a>
         {% endif %}

          <a class="btn btn-outline-warning small_btn mt-2 ms-1" title="EDIT" id="edit_btn" href="{% url 'edit_salesorder_page' sale.id %}">
            <i class="fa fa-pencil"></i>
          </a>
          <a class="btn btn-outline-warning small_btn mt-2 ms-1" href="{% url 'delete_salesorder' sale.id %}"  title="DELETE" id="delete_btn">
            <i class="fa fa-trash"></i>
          </a>
          <a class="btn btn-outline-warning small_btn mt-2 ms-1" style="display: none;" title="SHARE" id="shareBtn" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-share"></i>
        </a>
        <div class="dropdown-menu" aria-labelledby="share_btn">
            <li class="text-black">{% post_to_whatsapp object_or_url "WhatsApp" %}</li>
            <!-- <a class="dropdown-item text-black">{% post_to_whatsapp object_or_url "WhatsApp" %}</a> -->
            <a class="dropdown-item text-black" data-toggle="modal" data-target="#shareToEmail">Email</a>
        </div>
        
        <a class="btn btn-outline-warning small_btn mt-2 ms-1" id="attach_btn" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-paperclip"></i>
        </a>
        <div class="dropdown-menu" aria-labelledby="attach_btn">
            <a class="dropdown-item text-black" data-toggle="modal" data-target="#attachmentModal">Add Document</a>
            {% if sale.document != "" %} 
            <a class="dropdown-item text-black" download href="{{sale.document.url}}">Download Document</a>
            {% endif %}
        </div>
        <a class="btn btn-outline-warning small_btn mt-2 ms-1" title="COMMENTS"  data-toggle="modal" data-target="#commentsModal1"  id="commentsBtn">
            <i class="fa fa-comment"></i>
          </a>
          <a class="btn btn-outline-warning small_btn mt-2 ms-1" title="HISTORY"  data-toggle="modal" data-target="#commentModal2" id="historyBtn">
            <i class="fa fa-history"></i>
          </a>
          <a class="btn btn-outline-warning small_btn mt-2 ms-1" style="display: none;" onclick="printSection('whatToPrint')" title=" PDF" id="pdfBtn"> 
            <i class="fa fa-file-pdf"></i>
          </a>
          <a class="btn btn-outline-warning small_btn mt-2 ms-1" style="display: none;" onclick="convertToPDF('whatToPrint')" title="PRINT" id="printBtn">
            <i class="fa fa-print"></i> 
          </a>
          <!-- <a class="btn btn-outline-warning small_btn mt-2 ms-1" title="Back" id="close_btn" onclick="window.location.href=``">
            <i class="fa fa-times-circle"></i>
          </a> -->

       </div>
        </div>
    </div><br>
    </div><br>
  
    
    <div  style="display: none;"></div>
  
    
  <!-- Success message alert -->
  <div id="successAlert"tabindex="-1" class=" text-success modal-dialog " role="alert" style="display: none;font: 1000px;">
      <strong>Success!</strong> File uploaded successfully.Please reload the page to see changes.
     
  </div>
  <script>
      document.getElementById('attachmentForm').addEventListener('submit', function(event) {
          event.preventDefault(); // Prevent the form from submitting normally
          
          // Perform form submission via AJAX
          var formData = new FormData(this);
  
          fetch(this.action, {
              method: this.method,
              body: formData
          })
          .then(response => {
              if (response.ok) {
                  // Show success message
                  document.getElementById('successAlert').style.display = 'block';
                  // Show reload message
                  // Reset form
                  this.reset();
                  // Close modal
                  var modal = document.getElementById('attachmentModal');
                  var modalBackdrop = document.querySelector('.modal-backdrop');
                  modal.classList.remove('show');
                  modalBackdrop.parentNode.removeChild(modalBackdrop);
                  // Return to previous window
              } else {
                  // Handle error response
                  // You can show an error message here if needed
              }
          })
          .catch(error => {
              // Handle network errors
              console.error('Error:', error);
          });
      });
  </script>
  
  
  
    
    <script>
      function convertToPDF(sectionId) {
          const element = document.getElementById(sectionId);
  
          html2pdf().from(element).save('salesorder.pdf');
      }
  
      function toggleTemplate(templateId, buttonId) {
          $('.printTemplates').css('display', 'none');
          $('#' + templateId).css('display', 'block');
          $('.templateToggleButtons').removeClass('active');
          $('#' + buttonId).addClass('active');
          $("#templatePrintButton").attr("onclick", "convertToPDF('" + templateId + "')");
          document.getElementById('page-content').scrollIntoView();
      }

      
  </script>


  
<div class="row" id="div-to-pdf"
style="background-color: #c4c1c1fd;  height: auto; margin-left:1px; margin-right: 1rem; width: 100%;  ">
<div id="overview" class="row g-0 mx-0">
  
        <div class="history_highlight pt-3 px-2 d-flex">
            <div class="col-12 d-flex justify-content-start align-items-center">
                {% if history %}{% if history.action == 'Created' %}<p class=" m-0" style="font-size: 1.07rem; color:#4CAF50;  font-weight: 500;">Created by :</p>{% else %}<p class="text-danger m-0" style="font-size: 1.07rem; font-weight: 500;">Last Edited by :</p>{% endif %}{% endif %}
                <span class="ml-2" style="font-size: 1.15rem; font-weight: 500;">{{history.login_details.first_name}} {{history.login_details.last_name}}</span>
                <span class="ml-2" style="margin-left: 2%; font-size: 1.15rem">{{history.date| date:'d-m-Y'}}</span>
            </div>
        </div>

        <div class="row">
            <h1 class="text-black mt-3 ps-5" style="text-align: left;"># {{sale.sales_order_number}}</h1>
            <hr class="text-black" style="margin-left: 5%; margin-right: 5%">
            <div class="col-md-6 p-4">
              <div class="row">
                <div class="col-md-8">
                  <h5 class="fw-bold" style="border-bottom: 1px solid rgba(128, 128, 128, 0.6); width: fit-content;">Company Details</h5>
                </div>
                <div class="col-md-4"></div>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Company</h6>
                <p class="mb-0 text-right">{{sale.company.company_name}}</p>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Mobile</h6>
                <p class="mb-0 text-right">{{sale.company.contact}}</p>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Address</h6>
                <p class="mb-0 text-right">
                  {{sale.company.address}}
                </p>
              </div>

              <br>
              <div class="row">
                <div class="col-md-8">
                  <h5 class="fw-bold" style="border-bottom: 1px solid rgba(128, 128, 128, 0.6); width: fit-content;">Salesorder Details</h5>
                </div>
                <div class="col-md-4"></div>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Sales Order No:</h6>
                <p class="mb-0 text-right">{{sale.sales_order_number}} &nbsp;</p>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Sales Order Date:</h6>
                <p class="mb-0 text-right">{{sale.sales_order_date}}</p>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Shippment Date:</h6>
                <p class="mb-0 text-right">{{sale.expiration_date}}</p>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Payment Method</h6>
                <p class="mb-0 text-right">{{sale.payment_method}}</p>
              </div>

               <br>
              <div class="row">
                <div class="col-md-8">
                  <h5 class="fw-bold" style="border-bottom: 1px solid rgba(128, 128, 128, 0.6); width: fit-content;">Customer Details</h5>
                </div>
                <div class="col-md-4"></div>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Customer :</h6>
                <p class="mb-0 text-right">{{sale.customer.first_name}} {{sale.customer.last_name}} &nbsp;</p>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Email:</h6>
                <p class="mb-0 text-right">{{sale.customer_email}}</p>
              </div>
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Mobile: </h6>
                <p class="mb-0 text-right">{{sale.customer.customer_mobile}}</p>
              </div>
              {% if sale.customer_billing_address != "" %}
              <div class="d-flex px-3 justify-content-between text-black mb-2">
                <h6 class="mb-0">Address:</h6>
                <p class="mb-0 text-right">{{sale.customer_billing_address}}</p>
              </div>
              {% endif %}

              </div>



              <div class="col-md-6 px-3">
                <div class="px-3 py-3 mb-3"  style="background-color: rgb(30, 30, 30); border-radius: 6px;">
                  <h4 class="text-white my-3" style="text-align: center;">Salesorder Tax Details</h4>
                  <hr class="text-white" style="margin-left: 5%; margin-right: 5%">
                  <div class="d-flex justify-content-between mb-4">
                      <h6 class="text-white" style="font-weight: 600;">Salesorder Status</h6>
                      <span class="text-warning h5"  style="font-weight: 600;">{{sale.status}}</span> 
                  </div>
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">Sub Total</h6>
                      {{sale.sub_total}}
                  </div>
                  
                  {%if sale.igst != 0 %}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">IGST</h6>
                      {{ sale.igst }}
                  </div>
                  {%endif%}
                  {%if sale.cgst != 0 %}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">CGST</h6>
                      {{ sale.cgst }}
                  </div>
                  {%endif%}
                  {%if sale.sgst != 0 %}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">SGST</h6>
                      {{ sale.sgst }}
                  </div>
                  {%endif%}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">Tax Amount</h6>
                      {{sale.tax_amount}}
                  </div>
                  {% if sale.shipping_charge != 0 %}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">Shipping Charge</h6>
                      {{ sale.shipping_charge}}
                  </div>
                  {% endif %}
                  {% if sale.adjustment != 0 %}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">Adjustment</h6>
                      {{sale.adjustment }}
                  </div>
                  {% endif %}
                  {% if sale.advanced_paid != 0 %}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">Paid Amount</h6>
                      {{sale.advanced_paid }}
                  </div>
                  {% endif %}
                  {% if sale.balance != 0 %}
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">Balance</h6>
                      {{sale.balance }}
                  </div>
                  {% endif %}
                  <hr class="my-4 text-white">
                  <div class="d-flex justify-content-between mb-4 text-white">
                      <h6 class="text-white">Grand Total</h6>
                      <span class="font-weight-bold">{{sale.grand_total}}</span>
                  </div>
                </div>
              </div>
            </div>

              

              <hr class="mx-3">
              <div class="row mt-1">
                <div class="row px-4">
                  <div class="col-md-8">
                    <h5 class="fw-bold" style="border-bottom: 1px solid rgba(128, 128, 128, 0.6); width: fit-content;">Item Details</h5>
                  </div>
                  <div class="col-md-4"></div>
                </div>
                <div class="row">
                {% for i in items %}
                  <div class="col-6">
                    <div class="d-flex px-3 justify-content-between text-black mb-2">
                      <h6 class="mb-0">Item</h6>
                      <p class="mb-0 text-right">{{i.item.item_name}}</p>
                    </div>
                    <!-- <div class="d-flex px-3 justify-content-between text-black mb-2">
                        <h6 class="mb-0">Price</h6>
                        <p class="mb-0 text-right">{{ i.price }}</p>
                      </div> -->
                    <div class="d-flex px-3 justify-content-between text-black mb-2">
                      <h6 class="mb-0">HSN</h6>
                      <p class="mb-0 text-right">{{i.hsn}}</p>
                    </div>
                    <div class="d-flex px-3 justify-content-between text-black mb-2">
                      <h6 class="mb-0">quantity</h6>
                      <p class="mb-0 text-right">{{i.quantity}}</p>
                    </div>
                    <div class="d-flex px-3 justify-content-between text-black mb-2">
                      <h6 class="mb-0">Tax</h6>
                      <p class="mb-0 text-right">{{i.tax_rate}}%</p>
                    </div>
                    <!-- <div class="d-flex px-3 justify-content-between text-black mb-2">
                        <h6 class="mb-0">Discount</h6>
                        <p class="mb-0 text-right">{{ i.discount }}</p>
                      </div> -->
                    <div class="d-flex px-3 justify-content-between text-black mb-2">
                      <h6 class="mb-0">Total</h6>
                      <p class="mb-0 text-right">{{i.total}}</p>
                    </div>
                    <hr class="mx-2">
                  </div>
                  {% endfor %}
                </div>

              </div>
            </div>
            


              

            
          
                                
        
                            </div>
                        </div>
                    </div>

            <div id="template" style="display: none;" >
                <div  id="whatToPrint" class="print-only">
            
                    <!-- template1 -->
                    <div id="whatToPrint1" class="printTemplates template1">
                        <div class="my-5 page" size="A5" >
                            <div class="p-4" id="printdiv1">
                                <div id="ember2512" class="tooltip-container ember-view ribbon text-ellipsis">
                                    <div class="ribbon-inner ribbon-open">{{sale.status}}<!----></div></div>
                                <section class="top-content bb d-flex justify-content-between">
                                    <div class="logo">
                                        <!-- <img src="logo.png" alt="" class="img-fluid"> -->
                                    </div>
                                    <div class="top-left">
                                        <div class="graphic-path">
                                            <p>Salesorder</p>
                                        </div>
                                        <div class="position-relative ">
                                            <p> Order No. <span>{{ sale.sales_order_number }}</span></p>
                                            <!-- {%if sale.sales_order_number %}
                                            <p>Order No. <span>{{ sale.sales_order_number }}</span></p>
                                            {% endif %} -->
                                        </div>
                                    </div>
                                </section>
                    
                                <section class="store-user mt-5">
                                    <div class="col-12">
                                        <div class="row bb pb-3">
                                            <div class="col-7">
                                                <p>FROM,</p>
                                                <h5>{{sale.company.company_name}}</h5>
                                                <p class="address "> {{sale.company.address}}<br>
                                                    {{sale.company.city}},
                                                    {{sale.company.state}}<br>
                                                    {{sale.company.pincode}}<br>
                                                </p>
                                                
                                            </div>
                                            <div class="col-5">
                                                <p>TO,</p>
                                                <h5>{{sale.customer.title}} {{sale.customer.first_name}} {{sale.customer.last_name}}</h5>
                                                <p class="address col-9" style="margin-left: -14px;" > {{ sale.customer.billing_address|linebreaksbr}} </p>
                                                
                                            </div>
                                        </div>
                                        <div class="row extra-info pt-3">
                                            <div class="col-6">
                                                <p>Salesoreder Date: <span>{{sale.sales_order_date | date:'d-m-Y'}}</span></p>
                                            </div>
                                            <div class="col-6">
                                                <p>Expected Shipment Date : <span>{{sale.expiration_date | date:'d-m-Y'}}</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                    
                                <section class="product-area mt-4">
                                    <table class=" table table-hover table-bordered " id="table1">
                                        <thead >
                                            <tr>
                                                <td style="text-align: center; font-weight:bold; color:black">Items</td>
                                                <td style="font-weight:bold; color:black">HSN</td>
                                                <td style="font-weight:bold; color:black">Price</td>
                                                <td style="font-weight:bold; color:black">Quantity</td>
                                                <td style="font-weight:bold; color:black">Tax</td>
                                                <td style="font-weight:bold; color:black">Discount</td>
                                                <td style="font-weight:bold; color:black">Total</td>
                                            </tr>
                                        </thead>
                                        <tbody>
            
                                            {% for i in items %}
                                            <tr>
                                                <td style="color:black; text-align: center;">{{i.item.item_name}}</td>
                                                <td style="color:black">{{i.hsn}}</td>
                                                <td style="color:black">{{i.price}}</td>
                                                <td style="color:black">{{i.quantity}}</td>
                                                <td style="color:black">{{i.tax_rate}} %</td>
                                                <td style="color:black">{{i.discount}} </td>
                                                <td style="color:black">{{i.total}}</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table><br><br>
                                </section>
                    
                                <section class="balance-info">
                                    <div class="row">
                                        <div class="col-md-8"></div>
                                        <div class="col-md-4">
                                            <table class="table table-borderless">
                                                <tbody>
                                                    <tr >
                                                        <td style="color: #000;">Sub Total</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.sub_total}}</td>
                                                    </tr>
                                                    
                                                    {% if sale.igst != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">IGST</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.igst}}</td>
                                                    </tr>
                                                    {% endif %}
                                                    {% if sale.cgst != 0 %}
                                                    <tr>
                                                        <td style="color: #000;">CGST</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.cgst}}</td>
                                                        
                                                    </tr>
                                                    {% endif %}
                                                    {% if sale.sgst != 0 %}
                                                    <tr>
                                                        <td style="color: #000;">SGST</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.sgst}}</td>
                                                    </tr>
                                                    {% endif %}
                                                    <tr >
                                                        <td style="color: #000;">Tax Amount</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.tax_amount}}</td>
                                                    </tr>
                                                    {% if sale.shipping_charge != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">Shipping Charge</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.shipping_charge}}</td>
                                                    </tr>
                                                    {% endif %}
                                                    {% if sale.adjustment != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">Adjustment</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.adjustment}}</td>
                                                    </tr>
                                                    {% endif %}
                                                </tbody>
            
                                            </table>
                                            <hr style="background-color: #000000;">
                                            <table class="table table-borderless">
                                                <tbody>
                                                    <tr >
                                                        <th style="color: #000;">Grand Total</th>
                                                        <th style="color: #000;">:</th>
                                                        <th class="text-right" style="color: #000;">{{sale.grand_total}}</th>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </section>
                    
                            </div>
                        </div>
                    </div>
        
    
                    <!-- template2 -->
                    <div  id="whatToPrint2"  class="printTemplates template2" style="display: none;">
                        <div class="my-5 page" size="A5" >
                            <div id="printdiv2">
                                <div class="row px-5 py-4 bg-warning"  >
                                    <div id="ember2512" class="col-md-4 d-flex justify-content-start tooltip-container ember-view ribbon text-ellipsis">
                                      <div class="text-white d-flex align-items-center px-5" style="border-radius: 1vh; background-color:#e9d679">{{sale.status}}<!----></div>
                                  </div>
                                  <div class="col-md-4 d-flex justify-content-center">
                                      <center class="h3 text-white"><b>Sales Order</b></center>
                                  </div>  
                                  <div class="col-md-4 d-flex justify-content-end">
                                      <div class="text-white">
                                          <!-- <p class="mb-0 mt-2">salesorder No: <b>{{sale.invoice_number }}</b></p> -->
                                          {%if sale.sales_order_number %}
                                          <p class="mb-0 mt-2">Order No: <b>{{sale.sales_order_number }}</b></p>
                                          {% endif %}
                                      </div>
                                  </div>
                              </div>
                              <div class="px-5 py-1">
                                  <section class="store-user"><br><br>
                                      <div class="col-12">
                                          <div class="row bb pb-2 mt-3">
                                              <div class="col-4 pl-0">
                                                  <label class="text-white w-100 p-1" style="background-color: #999999; border-top-right-radius: 4vh; border-bottom-right-radius: 4vh;" ><b>COMPANY ADDRESS</b></label>
                                                  <h5 class="text-secondary" style="font-weight: bold;">{{sale.company.company_name}}</h5>
                                                  <p class="address" style="font-weight: bold;color: #000;">
                                                      {{sale.company.address}}
                                                      <br>
                                                      {{sale.company.company_name.city}}
                                                      <br>
                                                      {{sale.company.state}} - {{sale.company.pincode}}
                                                      <br>
                                                      <span>Mob: </span><b>{{sale.company.contact}}</b>
                                                  </p>  
                                              </div>
                                              <div class="col-4"></div>
                                              <div class="col-4 pr-0">
                                                  <label class="text-white w-100 p-1" style="border-top-right-radius: 4vh; border-bottom-right-radius: 4vh; background-color: #999999;" ><b>SHIPPING ADDRESS</b></label>
                                                  <h5 class="text-warning" style="font-weight: bold;">{{sale.customer.title}} {{sale.customer.first_name}} {{sale.customer.last_name}}</h5>
                                                  <p class="address" style="font-weight: bold;color: #000;">{{ sale.customer.billing_address | linebreaksbr}} </p>
                                              </div>
                                          </div>
                                          
                                      </div>
                                  </section>
                      
                                  <section class="product-area mt-2">
                                      <table class="table table-hover table-bordered  template2table" id="table2">
                                          <thead style="background-color:chocolate;" >
                                              <tr class="template3tablehead">
                                                  <th class="text-center bg-warning" style="color:black">Items</th>
                                                  <th class="text-center bg-warning" style="color:black">HSN</th>
                                                  <th class="text-center bg-warning" style="color:black">Quantity</th>
                                                  <th class="text-center bg-warning" style="color:black">Rate</th>
                                                  <th class="text-center bg-warning" style="color:black">Tax</th>
                                                  <th class="text-center bg-warning" style="color:black">Discount</th>
                                                  <th class="text-center bg-warning" style="color:black">Total</th>
                                              </tr>
                                          </thead>
                                          <tbody  style="background-color: #b7a65a;">
                                              {% for i in items %}
                                                  <tr>
                                                      <td class="text-center" style="color:black">{{ i.item.item_name}}</td>
                                                      <td class="text-center" style="color:black">{{ i.hsn }}</td>
                                                      <td class="text-center" style="color:black">{{ i.quantity }}</td>
                                                      <td class="text-center" style="color:black">{{ i.price  }}</td>
                                                      <td class="text-center" style="color:black">{{ i.tax_rate  }}%</td>
                                                      <td class="text-center" style="color:black">{{ i.discount  }}</td>
                                                      <td class="text-center" style="color:black">{{ i.total }}</td>
                                                  </tr>
                                              {% endfor %} 
                                          </tbody>
                                      </table>
                                  </section>
                      
                                  <section class="balance-info">
                                      <div class="row mt-3">
                                          <div class="col-4">
                                              <table class="table table-borderless">
                                                  <tbody>
                                                      {% if sale.description %}
                                                      <tr >
                                                          <td style="color: #000;text-align: left;">Note</td>
                                                          <td style="color: #000;text-align: left;">:</td>
                                                          <th style="color: #000;text-align: center;">{{sale.description}}</th>
                                                      </tr>
                                                      {% endif %}
          
                                                  </tbody>
                                              </table>
                                          </div>
                                          <div class="col-4"></div>
                                          <div class="col-4"><br><br>
                                              <table class="table table-borderless">
                                                  <tbody>
                                                      <tr >
                                                          <td style="color: #000;">Sub Total</td>
                                                          <td style="color: #000;">:</td>
                                                          <td class="text-right" style="color: #000;">{{sale.sub_total}}</td>
                                                      </tr>
                                                      
                                                      {% if sale.igst != 0 %}
                                                      <tr >
                                                          <td style="color: #000;">IGST</td>
                                                          <td style="color: #000;">:</td>
                                                          <td class="text-right" style="color: #000;">{{sale.igst}}</td>
                                                      </tr>
                                                      {% endif %}
                                                      {% if sale.cgst != 0 %}
                                                      <tr>
                                                          <td style="color: #000;">CGST</td>
                                                          <td style="color: #000;">:</td>
                                                          <td class="text-right" style="color: #000;">{{sale.cgst}}</td>
                                                          
                                                      </tr>
                                                      {% endif %}
                                                      {% if sale.sgst != 0 %}
                                                      <tr>
                                                          <td style="color: #000;">SGST</td>
                                                          <td style="color: #000;">:</td>
                                                          <td class="text-right" style="color: #000;">{{sale.sgst}}</td>
                                                      </tr>
                                                      {% endif %}
                                                      <tr >
                                                        <td style="color: #000;">Tax Amount</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.tax_amount}}</td>
                                                    </tr>
                                                    {% if sale.shipping_charge != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">Shipping Charge</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.shipping_charge}}</td>
                                                    </tr>
                                                    {% endif %}
                                                    {% if sale.adjustment != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">Adjustment</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.adjustment}}</td>
                                                    </tr>
                                                    {% endif %}
                                                  </tbody>
          
                                              </table>
                                              <hr style="background-color: #000000;">
                                              <table class="table table-borderless">
                                                  <tbody>
                                                      <tr >
                                                          <th style="color: #000;">Grand Total</th>
                                                          <th style="color: #000;">:</th>
                                                          <th class="text-right" style="color: #000;">{{sale.grand_total}}</th>
                                                      </tr>
                                                  </tbody>
                                              </table>
                                          </div> 
                                      </div>
                                  </section>
                                     
                              </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- template3 -->
                    <div id="whatToPrint3" class="printTemplates template3" style="display: none;">
                        <div class="my-5 page"  size="A3" >
                            <div class="" id="printdiv3">
                                <div class="row">
                                    <div class="col-sm-12" style="background-image: linear-gradient(#cb972f, black); color: white;">
                                        <p style="font-size: 4vh; text-align: center;">SALESORDER</p>
                                        <p style=" text-align: center;"> {{sale.company.company_name}} <br>
                                            {{sale.company.address}} <br>
                                            {{sale.company.city}},
                                            {{sale.company.state}}<br>
                                            {{sale.company.login_details.email}}
                                            <br>
                                        </p>
                                    </div>
                                    
                                    <div class="row col-12">
                                        <div class="col-md-1"></div>
                                        <div class="col-5">
                                            <br><br><br>
                                            <p style="color:black;"> <span style=" font-weight: bold;">To: </span><br>
                                            {{sale.customer.title}} {{sale.customer.first_name}} {{sale.customer.last_name}}<br>
                                            {{sale.customer.billing_address|linebreaksbr }}
                                            </p>
                                        </div>
                                        <div class="col-md-1"></div>
                                        <div class="col-5">
                                            <br><br><br>
                                            <table class="table table-borderless">
                                                <tbody>
                                                    <tr >
                                                        <td style="color: #000; font-weight: bold;">Salesorder No</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{ sale.sales_order_number }}</td>
                                                    </tr>
                                                    {%if invoice.order_number %}
                                                    <tr >
                                                        <td style="color: #000; font-weight: bold;">Order No</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{ sale.sales_order_number }}</td>
                                                    </tr>
                                                    {% endif %}
                                                    
                                                    <tr >
                                                        <td style="color: #000; font-weight: bold;">salesorder Date</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.sales_order_date | date:'d-m-Y'}}<td>
                                                    </tr>
     
                                                    <tr>
                                                        <td style="color: #000; font-weight: bold;">Shipment Date</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.expiration_date | date:'d-m-Y'}}</td>
                                                        
                                                    </tr>
                                                </tbody>
            
                                            </table>
                                        </div>
                                    </div>
                                    <div class="col-md-1"></div>
                                    <div class="col-md-10"><br>
                                        <table class="table table-hover table-bordered  template3table" id="table3">
                                            <thead >
                                                <tr class="template3tablehead">
                                                    <th class="text-center bg-warning"  style="color:black">Items</th>
                                                    <th class="text-center bg-warning"  style="color:black">HSN</th>
                                                    <th class="text-center bg-warning"  style="color:black">Quantity</th>
                                                    <th class="text-center bg-warning"  style="color:black">Rate</th>
                                                    <th class="text-center bg-warning"  style="color:black">Tax</th>
                                                    <th class="text-center bg-warning"  style="color:black">Discount</th>
                                                    <th class="text-center bg-warning"  style="color:black">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for i in items %}
                                                    <tr>
                                                        <td class="text-center" style="color: black;">{{ i.item.item_name}}</td>
                                                        <td class="text-center" style="color: black;">{{ i.hsn }}</td>
                                                        <td class="text-center" style="color: black;">{{ i.quantity }}</td>
                                                        <td class="text-center" style="color: black;">{{ i.price }}</td>
                                                        <td class="text-center" style="color: black;">{{ i.tax_rate }}%</td>
                                                        <td class="text-center" style="color: black;">{{ i.discount }}</td>
                                                        <td class="text-center" style="color: black;">{{ i.total }}</td>
                                                    </tr>
                                                {% endfor %} 
                                            </tbody>
                                        </table>
                                    </div>
                                </div> 
                                <section class="balance-info">
                                    <div class="row">
                                        <div class="col-md-7"></div>
                                        <div class="col-md-4">
                                            <br>
                                            <table class="table table-borderless">
                                                <tbody>
                                                    <tr >
                                                        <td style="color: #000;">Sub Total</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.sub_total}}</td>
                                                    </tr>
                                                    
                                                    {% if sale.igst != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">IGST</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.igst}}</td>
                                                    </tr>
                                                    {% endif %}
                                                    {% if sale.cgst != 0 %}
                                                    <tr>
                                                        <td style="color: #000;">CGST</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.cgst}}</td>
                                                        
                                                    </tr>
                                                    {% endif %}
                                                    {% if sale.sgst != 0 %}
                                                    <tr>
                                                        <td style="color: #000;">SGST</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.sgst}}</td>
                                                    </tr>
                                                    {% endif %}
                                                    <tr >
                                                        <td style="color: #000;">Tax Amount</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.tax_amount}}</td>
                                                    </tr>
                                                    {% if sale.shipping_charge != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">Shipping Charge</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.shipping_charge}}</td>
                                                    </tr>
                                                    {% endif %}
                                                    
                                                    {% if sale.adjustment != 0 %}
                                                    <tr >
                                                        <td style="color: #000;">Adjustment</td>
                                                        <td style="color: #000;">:</td>
                                                        <td class="text-right" style="color: #000;">{{sale.adjustment}}</td>
                                                    </tr>
                                                    {% endif %}
                                                </tbody>
            
                                            </table>
                                            <hr style="background-color: #000000;">
                                            <table class="table table-borderless">
                                                <tbody>
                                                    <tr >
                                                        <th style="color: #000;">Grand Total</th>
                                                        <th style="color: #000;">:</th>
                                                        <th class="text-right" style="color: #000;">{{sale.grand_total}}</th>
                                                    </tr>
                                                    <tr >
                                                </tbody>
                                            </table>
                                        </div>
                                    
                                </section> 
                            </div>
                        </div>
                    </div>
                </div>
                <div id="templateToggle" class="templateToggleSegment mt-3 mb-0 w-100 d-flex justify-content-center">
                    <button id="toggleTemplate1" onclick="toggleTemplate('whatToPrint1','toggleTemplate1')" class="btn btn-outline-warning btn-sm m-2 active templateToggleButtons">1</button>
                    <button id="toggleTemplate2" onclick="toggleTemplate('whatToPrint2','toggleTemplate2')" class="btn btn-outline-warning btn-sm m-2 templateToggleButtons">2</button>
                    <button id="toggleTemplate3" onclick="toggleTemplate('whatToPrint3','toggleTemplate3')" class="btn btn-outline-warning btn-sm m-2 templateToggleButtons">3</button>
                </div>
            </div>

            <div id="slip" style="display: none;" >

                <div class="slip-container bg-white" id="slip_container">
                    
                    <div class="slip text-dark">
                        <h5 class="font-weight-bold text-center text-dark">{{sale.company.company_name}}</h5>
                        <div class="address text-center">
                            <p>{{sale.company.address}}</p>
                            <p>{{sale.company.state}}, {{cmp.Country}}</p>
                            <p>{{sale.company.contact}}</p>
                        </div>

                        <div class="divider"></div>

                        <div class="ml-4 mt-2" style="color: black;">
                            <div class="row">
                                <div class="col-md-6 text-left">Salesorder No:</div>
                                <div class="col-md-5 text-right">{{sale.sales_order_number}}</div>
                            </div>
                            {% if invoice.order_number  %}
                            <div class="row">
                                <div class="col-md-6 text-left">Order No:</div>
                                <div class="col-md-5 text-right">{{invoice.order_number}}</div>
                            </div>
                            {% endif %}
                            <div class="row">
                                <div class="col-md-6 text-left">Customer Name:</div>
                                <div class="col-md-5 text-right">{{sale.customer.first_name}} {{sale.customer.last_name}}</div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 text-left">Salesorder Date :</div>
                                <div class="col-md-5 text-right">{{sale.sales_order_date | date:'d-m-Y'}}</div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 text-left">Shipment Date:</div>
                                <div class="col-md-5 text-right">{{sale.expiration_date | date:'d-m-Y'}}</div>
                            </div>
                        </div>

                        <div class="divider"></div>

                        <div class="equal-length-container" style="color: black; font-weight: bold;">
                            <div class="equal-length-item" style=" text-align: center;">
                                Item
                                <hr style="border-bottom: 1px solid black; margin-top:1vh; width:95%">
                            </div>
                            <div class="equal-length-item ml-2"  style=" text-align:center;">
                                HSN
                                <hr style="border-bottom: 1px solid black; margin-top:1vh; width:63%; margin-left: 10px;">
                            </div>
                            <div class="equal-length-item"  style=" text-align: center; ">
                                Qty
                                <hr style="border-bottom: 1px solid black; margin-top:1vh; width:60%;  margin-left: 10px;">
                            </div>
                            <div class="equal-length-item"  style=" text-align: center; ">
                                Rate
                                <hr style="border-bottom: 1px solid black; margin-top:1vh; width:65%;  margin-left: 10px;">
                            </div>
                            <div class="equal-length-item"  style=" text-align: center; ">
                                Tax
                                <hr style="border-bottom: 1px solid black; margin-top:1vh; width:60%;  margin-left: 10px;">
                            </div>
                            <div class="equal-length-item" style=" text-align: center; ">
                                Total
                                <hr style="border-bottom: 1px solid black; margin-top:1vh; width:65%;  margin-left: 10px;">
                            </div>
                        </div>
                        {% for i in items %}
                        <div class="equal-length-container" style="color: black; font-size: small; word-wrap: break-word; margin-bottom: 1vh;">
                            <div class="equal-length-item"  style="text-align: center; margin-left: 2px;">
                                {{i.item.item_name}}
                            </div>
                            <div class="equal-length-item" style="text-align: right;">
                                {{i.hsn}}
                            </div>
                            <div class="equal-length-item" style="text-align: center; ">
                                {{i.quantity}}
                            </div>
                            <div class="equal-length-item" style="text-align: center; ">
                                {{i.price}}
                            </div>
                            <div class="equal-length-item" id="tax{{ forloop.counter }}">
                                {{ i.tax_rate  }}%
                            </div>
                            <div class="equal-length-item" style="text-align: center; ">
                                {{i.total}}
                            </div>
                        </div>
                        {% endfor %}

                        <div class="subtot mt-5">
                            <div class="subtot-item d-flex justify-content-between">
                                <span>Subtotal</span>
                                <span><span>&#8377; </span>{{sale.sub_total}}</span>
                            </div>
                           
                            {% if sale.igst == 0 %}
                            <div class="subtot-item d-flex justify-content-between">
                                <span>CGST</span>
                                <span><span>&#8377; </span>{{sale.cgst}}</span>
                            </div>
                            <div class="subtot-item d-flex justify-content-between">
                                <span>SGST</span>
                                <span><span>&#8377; </span>{{sale.sgst}}</span>
                            </div>
                            {% else %}
                            <div class="subtot-item d-flex justify-content-between">
                                <span>IGST</span>
                                <span><span>&#8377; </span>{{sale.igst}}</span>
                            </div>
                            {% endif %}
                            <div class="subtot-item d-flex justify-content-between">
                                <span>Tax Amount</span>
                                <span><span>&#8377; </span>{{sale.tax_amount}}</span>
                            </div>
                            {% if sale.adjustment != 0 %}
                            <div class="subtot-item d-flex justify-content-between">
                                <span>Adjustment</span>
                                <span><span>&#8377; </span>{{sale.adjustment}}</span>
                            </div>
                            {% endif %}
                        </div>
                        <div class="divider"></div>
                        <div class="grandtot fw-bold d-flex justify-content-between">
                            <span><strong>TOTAL</strong></span>
                            <span><strong><span>&#8377; </span>{{sale.grand_total}}</strong></span>
                        </div>
                        <div class="divider"></div>
                        <div class="paid-by mb-4 d-flex justify-content-between">
                            <span>Paid By:</span>
                            <span>{{sale.payment_method}}</span>
                        </div>
                        <div class="createdby d-flex justify-content-between">
                            {% if history %}{% if history.action == 'Created' %}<p class="text-dark m-0" style="font-size: 1.07rem; font-weight: 500;">Created by :</p>{% else %}<p class="text-dark m-0" style="font-size: 1.07rem; font-weight: 500;">Last Edited by :</p>{% endif %}{% endif %}

                            <span>{{history.login_details.first_name}} {{history.login_details.last_name}}</span>
                        </div>
                        <div class="datetime d-flex justify-content-between">
                            <p class="">Printed On:</p>
                            <span id="dateTimeDisplay"></span>
                        </div>
                        <div class="trns-id d-flex justify-content-between">
                            <span>Transaction ID:</span>
                            <span>XXXXXXXXX</span>
                            <!-- <div>
                                <p class="float-start">
                                    <span>Vendor ID:</span>
                                    <span>XXXXXXXXXX</span>
                                </p>
                            </div> -->
                        </div>
                        <div class="slip-footer mt-4 text-center">
                            <p>Thank you for supporting Local business!</p>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>

<script>
    $(document).ready(function ($) {
        $(".table-row").click(function () {
            window.document.location = $(this).data("href");
        });
    });


    function overview() {
        document.getElementById('overview').style.display = 'block';
        document.getElementById('template').style.display = 'none';
        document.getElementById('slip').style.display = 'none';
        document.getElementById('overviewBtn').style.backgroundColor='rgb(255, 153, 0)'
        document.getElementById('templateBtn').style.backgroundColor='transparent';
        document.getElementById('slipBtn').style.backgroundColor='transparent';
        $('#shareBtn').hide();
        $('#printBtn').hide();
        $('#pdfBtn').hide();
        $('#convertBtn').show();
        $('#editBtn').show();
        $('#deleteBtn').show();
        $('#historyBtn').show();
        $('#commentsBtn').show();
    }
    
    function template() {
        document.getElementById('overview').style.display = 'none';
        document.getElementById('slip').style.display = 'none';
        document.getElementById('template').style.display = 'block';
        document.getElementById('overviewBtn').style.backgroundColor='transparent';
        document.getElementById('slipBtn').style.backgroundColor='transparent';
        document.getElementById('templateBtn').style.backgroundColor='rgb(255, 153, 0)';
        $("#printBtn").attr("onclick","printSection('whatToPrint')");
        $("#pdfBtn").attr("onclick","convertToPDF('whatToPrint')");

        $('#shareBtn').show();
        $('#printBtn').show();
        $('#pdfBtn').show();
        $('#editBtn').hide();
        $('#convertBtn').hide();
        $('#deleteBtn').hide();
        $('#historyBtn').show();
        $('#commentsBtn').show();
    }

    function slip() {
        document.getElementById('overview').style.display = 'none';
        document.getElementById('template').style.display = 'none';
        document.getElementById('slip').style.display = 'block';
        document.getElementById('overviewBtn').style.backgroundColor='transparent';
        document.getElementById('templateBtn').style.backgroundColor='transparent';
        document.getElementById('slipBtn').style.backgroundColor='rgb(255, 153, 0)';
        $("#printBtn").attr("onclick","printSection('slip')");
        $("#pdfBtn").attr("onclick","convertToPDF('slip')");

        
        $('#printBtn').show();
        $('#pdfBtn').show();
        $('#shareBtn').hide();
        $('#deleteBtn').hide();
        $('#editBtn').hide();
        $('#convertBtn').hide();
        $('#historyBtn').show();
        $('#commentsBtn').show();
    }


    $(document).ready(function(){
        $('#share_with_email').on('click',function(){
            var emailsInput = document.getElementById('emailIds');
            var emailsString = emailsInput.value.trim();

            var emails = emailsString.split(',').map(function(email) {
                return email.trim();
            });

            var emailRegex = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;

            var invalidEmails = []
            if(emailsString == ""){
                alert('Enter valid email addresses..')
            }
            else{
                for (var i = 0; i < emails.length; i++) {
                    var currentEmail = emails[i];

                    if (currentEmail!="" && !emailRegex.test(currentEmail)) {
                        console.log(currentEmail + ' is invalid!');
                        invalidEmails.push(currentEmail)
                    }
                }
                
                if(invalidEmails.length > 0){
                    alert('Invalid emails..Please check!\n'+invalidEmails)
                    // alert(invalidEmails)
                }else{
                    $('#share_to_email_form').submit();
                }
            }
        })
    });
    

    var $rows = $('#dataTable tbody tr');
    $('#search').keyup(function() {
        var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
        
        $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
        }).hide();
    });

    function filterSearchValues(col, fieldId, ele) {
        var table = document.getElementById("dataTable");
        
        var rows = table.getElementsByTagName("tr");
        
        var filterValue = $('#' + fieldId).val().toLowerCase();

        if (filterValue !== "") {
            for (var i = 1; i < rows.length; i++) {
                var statusCell = rows[i].getElementsByTagName("td")[col];

                if (statusCell.textContent.toLowerCase() == filterValue) {
                    rows[i].style.display = "";
                } else {
                    rows[i].style.display = "none";
                }
            }
        }
        $(ele).closest('.dropdown').find('.dropdown-menu').removeClass('show');
    }

    function filterAmount(col, fieldId, ele) {
        var table = document.getElementById("dataTable");
        
        var rows = table.getElementsByTagName("tr");
        
        var filterValue = parseFloat($('#' + fieldId).val());

        if (!isNaN(filterValue)) {
            for (var i = 1; i < rows.length; i++) {
                var statusCell = rows[i].getElementsByTagName("td")[col];

                if (parseFloat(statusCell.textContent.toLowerCase()) == filterValue) {
                    rows[i].style.display = "";
                } else {
                    rows[i].style.display = "none";
                }
            }
        }
        $(ele).closest('.dropdown').find('.dropdown-menu').removeClass('show');
    }

    function clearSearch(fieldId,ele) {
        var table = document.getElementById("dataTable");
        var rows = table.getElementsByTagName("tr");
        for (var i = 1; i < rows.length; i++) {
            rows[i].style.display = "";
        }
        $('#' + fieldId).val("");
        $(ele).closest('.dropdown').find('.dropdown-menu').removeClass('show');
    }

    function updateDateTime() {
        var currentDate = new Date();
        var day = currentDate.getDate();
        var month = currentDate.getMonth() + 1;
        var year = currentDate.getFullYear();
        var hours = currentDate.getHours();
        var minutes = currentDate.getMinutes();
        var seconds = currentDate.getSeconds();
        var formattedDay = (day < 10) ? `0${day}` : day;
        var formattedMonth = (month < 10) ? `0${month}` : month;
        var formattedHours = (hours < 10) ? `0${hours}` : hours;
        var formattedMinutes = (minutes < 10) ? `0${minutes}` : minutes;
        var formattedSeconds = (seconds < 10) ? `0${seconds}` : seconds;
        var formattedDateTime = `${formattedDay}/${formattedMonth}/${year} ${formattedHours}:${formattedMinutes}:${formattedSeconds}`;
        document.getElementById('dateTimeDisplay').textContent = formattedDateTime;
    }

    updateDateTime();
    setInterval(updateDateTime, 1000);

    // function templatePrint(templateId){
    //     var contentToPrint = document.getElementById(templateId).innerHTML;
    //     var printWindow = window.open('', '_blank');

    //     // Write the HTML content to the new window
    //     printWindow.document.write(contentToPrint);

    //     // Close the document stream to finish writing the content
    //     printWindow.document.close();
        
    //     printWindow.onafterprint = function () {
    //         printWindow.close();
    //     };

    //     // Print the new window
    //     printWindow.print();
    // }

    function printSection(sectionId) {
        
        var printContents = document.getElementById(sectionId).innerHTML;
        
        var originalContents = document.body.innerHTML;
        var $printerDiv = $('<div class="printContainer"></div>');

        $printerDiv.html(printContents); 
        $('body').append($printerDiv).addClass("printingContent"); 
        window.print(); 
        $printerDiv.remove();
        $('body').removeClass("printingContent");
    }

    function toggleTemplate(templateId,buttonId){
        $('.printTemplates').css('display','none');
        $('#'+templateId).css('display','block');
        $('.templateToggleButtons').removeClass('active');
        $('#'+buttonId).addClass('active');
        $("#templatePrintButton").attr("onclick","printSection('"+templateId+"')");
        document.getElementById('page-content').scrollIntoView();
    }
</script>
  
<!-- Share To Email Modal -->
<div class="modal fade" id="shareToEmail">
    <div class="modal-dialog modal-lg">
      <div class="modal-content" style="background:black; border: 1px solid #ffae1f;">
        <div class="modal-body">
          <div class="row">
            <div class="col-md-10 p-4">
              <h2 class="text-uppercase" style="color: white; font-weight: bolder;">Share Via Email</h2>
            </div>
            <div class="col-md-2 p-3">
              <button type="button" class="btn close" data-dismiss="modal" aria-label="Close" style="float: right;">
                <span aria-hidden="true" style="color: white; font-weight: bolder;">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <div class=" p-3">
                    <form action="{% url 'salesorder_shareemail' sale.id %}" method="post" class="needs-validation" id="share_to_email_form">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="emailIds"style="color: white; font-size: large;">Email IDs</label>
                            <textarea class="form-control text-white bg-black"name="email_ids" id="emailIds" rows="3" placeholder="Multiple emails can be added by separating with a comma(,)." required></textarea>
                        </div>
                        <div class="form-group mt-2">
                            <label for="item_unitname" style="color: white; font-size: large;">Message(optional)</label>
                            <textarea name="email_message" id="email_message" class="form-control text-white bg-black"cols="" rows="4" placeholder="This message will be sent along with Bill details."></textarea>
                        </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-4"></div>
                    <div class="col-md-4">
                      <div class="d-flex">
                        <button class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50 text-white" type="submit">Send</button> 
                        <input class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50 text-white" type="reset" value="Reset">
                      </div>
                    </div>
                    <div class="col-md-4"></div>
                  </div>
                </form>

            </div>
        </div>   
    </div>
</div>




<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
    $(document).ready(function ($) {
        $(".table-row").click(function () {
            window.document.location = $(this).data("href");
        });
    });


    function overview() {
        document.getElementById('overview').style.display = 'block';
        document.getElementById('template').style.display = 'none';
        document.getElementById('slip').style.display = 'none';
        document.getElementById('overviewBtn').style.backgroundColor='rgb(255, 153, 0)'
        document.getElementById('templateBtn').style.backgroundColor='transparent';
        document.getElementById('slipBtn').style.backgroundColor='transparent';
        $('#shareBtn').hide();
        $('#printBtn').hide();
        $('#pdfBtn').hide();
        $('#convertBtn').show();
        $('#editBtn').show();
        $('#deleteBtn').show();
        $('#historyBtn').show();
        $('#commentsBtn').show();
    }
    
    function template() {
        document.getElementById('overview').style.display = 'none';
        document.getElementById('slip').style.display = 'none';
        document.getElementById('template').style.display = 'block';
        document.getElementById('overviewBtn').style.backgroundColor='transparent';
        document.getElementById('slipBtn').style.backgroundColor='transparent';
        document.getElementById('templateBtn').style.backgroundColor='rgb(255, 153, 0)';
        $("#printBtn").attr("onclick","printSection('whatToPrint')");
        $("#pdfBtn").attr("onclick","convertToPDF('whatToPrint')");

        $('#shareBtn').show();
        $('#printBtn').show();
        $('#pdfBtn').show();
        $('#editBtn').hide();
        $('#convertBtn').hide();
        $('#deleteBtn').hide();
        $('#historyBtn').hide();
        $('#commentsBtn').hide();
    }

    function slip() {
        document.getElementById('overview').style.display = 'none';
        document.getElementById('template').style.display = 'none';
        document.getElementById('slip').style.display = 'block';
        document.getElementById('overviewBtn').style.backgroundColor='transparent';
        document.getElementById('templateBtn').style.backgroundColor='transparent';
        document.getElementById('slipBtn').style.backgroundColor='rgb(255, 153, 0)';
        $("#printBtn").attr("onclick","printSection('slip')");
        $("#pdfBtn").attr("onclick","convertToPDF('slip')");

        
        $('#printBtn').show();
        $('#pdfBtn').show();
        $('#shareBtn').hide();
        $('#deleteBtn').hide();
        $('#editBtn').hide();
        $('#convertBtn').hide();
        $('#historyBtn').hide();
        $('#commentsBtn').hide();
    }

    // function printSection(sectionId) {
    //     document.body.style.backgroundColor = 'white';
    //     $('#template, #template *').css('color', 'black');

    //     var printContents = document.getElementById(sectionId).innerHTML;
    //     var $printerDiv = $('<div class="printContainer"></div>');
    //     $printerDiv.html(printContents);
    //     $('body').append($printerDiv).addClass("printingContent");

    //     window.print();
    //     $printerDiv.remove();
    //     $('body').removeClass("printingContent");
    //     $('#template, #template *').css('color', 'white');
    
    // }

    $(document).ready(function(){
        $('#share_with_email').on('click',function(){
            var emailsInput = document.getElementById('emailIds');
            var emailsString = emailsInput.value.trim();

            var emails = emailsString.split(',').map(function(email) {
                return email.trim();
            });

            var emailRegex = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;

            var invalidEmails = []
            if(emailsString == ""){
                alert('Enter valid email addresses..')
            }
            else{
                for (var i = 0; i < emails.length; i++) {
                    var currentEmail = emails[i];

                    if (currentEmail!="" && !emailRegex.test(currentEmail)) {
                        console.log(currentEmail + ' is invalid!');
                        invalidEmails.push(currentEmail)
                    }
                }
                
                if(invalidEmails.length > 0){
                    alert('Invalid emails..Please check!\n'+invalidEmails)
                    // alert(invalidEmails)
                }else{
                    $('#share_to_email_form').submit();
                }
            }
        })
    });
    

    var $rows = $('#dataTable tbody tr');
    $('#search').keyup(function() {
        var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
        
        $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
        }).hide();
    });

    function filterSearchValues(col, fieldId, ele) {
        var table = document.getElementById("dataTable");
        
        var rows = table.getElementsByTagName("tr");
        
        var filterValue = $('#' + fieldId).val().toLowerCase();

        if (filterValue !== "") {
            for (var i = 1; i < rows.length; i++) {
                var statusCell = rows[i].getElementsByTagName("td")[col];

                if (statusCell.textContent.toLowerCase() == filterValue) {
                    rows[i].style.display = "";
                } else {
                    rows[i].style.display = "none";
                }
            }
        }
        $(ele).closest('.dropdown').find('.dropdown-menu').removeClass('show');
    }

    function filterAmount(col, fieldId, ele) {
        var table = document.getElementById("dataTable");
        
        var rows = table.getElementsByTagName("tr");
        
        var filterValue = parseFloat($('#' + fieldId).val());

        if (!isNaN(filterValue)) {
            for (var i = 1; i < rows.length; i++) {
                var statusCell = rows[i].getElementsByTagName("td")[col];

                if (parseFloat(statusCell.textContent.toLowerCase()) == filterValue) {
                    rows[i].style.display = "";
                } else {
                    rows[i].style.display = "none";
                }
            }
        }
        $(ele).closest('.dropdown').find('.dropdown-menu').removeClass('show');
    }

    function clearSearch(fieldId,ele) {
        var table = document.getElementById("dataTable");
        var rows = table.getElementsByTagName("tr");
        for (var i = 1; i < rows.length; i++) {
            rows[i].style.display = "";
        }
        $('#' + fieldId).val("");
        $(ele).closest('.dropdown').find('.dropdown-menu').removeClass('show');
    }

    function updateDateTime() {
        var currentDate = new Date();
        var day = currentDate.getDate();
        var month = currentDate.getMonth() + 1;
        var year = currentDate.getFullYear();
        var hours = currentDate.getHours();
        var minutes = currentDate.getMinutes();
        var seconds = currentDate.getSeconds();
        var formattedDay = (day < 10) ? `0${day}` : day;
        var formattedMonth = (month < 10) ? `0${month}` : month;
        var formattedHours = (hours < 10) ? `0${hours}` : hours;
        var formattedMinutes = (minutes < 10) ? `0${minutes}` : minutes;
        var formattedSeconds = (seconds < 10) ? `0${seconds}` : seconds;
        var formattedDateTime = `${formattedDay}/${formattedMonth}/${year} ${formattedHours}:${formattedMinutes}:${formattedSeconds}`;
        document.getElementById('dateTimeDisplay').textContent = formattedDateTime;
    }

    updateDateTime();
    setInterval(updateDateTime, 1000);

    // function templatePrint(templateId){
    //     var contentToPrint = document.getElementById(templateId).innerHTML;
    //     var printWindow = window.open('', '_blank');

    //     // Write the HTML content to the new window
    //     printWindow.document.write(contentToPrint);

    //     // Close the document stream to finish writing the content
    //     printWindow.document.close();
        
    //     printWindow.onafterprint = function () {
    //         printWindow.close();
    //     };

    //     // Print the new window
    //     printWindow.print();
    // }

    function printSection(sectionId) {
        
        var printContents = document.getElementById(sectionId).innerHTML;

        var originalContents = document.body.innerHTML;
        var $printerDiv = $('<div class="printContainer"></div>');

        $printerDiv.html(printContents); 
        $('body').append($printerDiv).addClass("printingContent"); 
        window.print(); 
        $printerDiv.remove();
        $('body').removeClass("printingContent");
    }

    function toggleTemplate(templateId,buttonId){
        $('.printTemplates').css('display','none');
        $('#'+templateId).css('display','block');
        $('.templateToggleButtons').removeClass('active');
        $('#'+buttonId).addClass('active');
        $("#templatePrintButton").attr("onclick","printSection('"+templateId+"')");
        document.getElementById('page-content').scrollIntoView();
    }
</script>

    <script>
    function searchTable() {
      // Declare variables
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("searchInput2");
      filter = input.value.toUpperCase();
      table = document.getElementById("table1");
      tr = table.getElementsByTagName("tr");
    
      // Loop through all table rows, and hide those that don't match the search query
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[0]; // Adjust index based on the column you want to search
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }
    </script>
  <div id="filterWindow" class="filter-window">
    <!-- <label for="filterInput">Enter filter text:</label> -->
    <input type="text" id="filterInput">
    <button onclick="applyFilter()">Apply</button>
    <button onclick="clearFilter()">Clear</button>
  </div>
    <script>
      function clearFilter() {
      document.getElementById('filterInput').value = '';
      // Implement your logic to clear the filter and update the table accordingly
      // For simplicity, you can just log the action to the console
      console.log('Filter Cleared');
      // Close the filter window
      document.getElementById('filterWindow').style.display = 'none';
  }
  
      // JavaScript functions
      function showFilter(columnName, thElement) {
      var filterWindow = document.getElementById('filterWindow');
      filterWindow.style.display = 'block';
      
      // Set the position of the filter window near the th element
      var thRect = thElement.getBoundingClientRect();
      filterWindow.style.top = thRect.bottom + 'px';
      filterWindow.style.left = thRect.left + 'px';
  
      // You can customize the filter window based on the column clicked
      // For simplicity, I'm setting the label text to the column name
      filterWindow.querySelector('label').innerText = 'Enter filter text for ' + columnName + ':';
  }
  
  </script>
      <div class="row mt-3">
        <div class="col-5"><label class="text-dark" for=""> </label></div>
        <div class="col-7">
          <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  </p>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-5"><label class="text-dark" for=""> </label></div>
        <div class="col-7">
          <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  </p>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-5"><label class="text-dark" for=""> </label></div>
        <div class="col-7">
          <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  </p>
        </div>
      </div>
    </div>
    </div>
        </div>
        </div>
    </div>  </div>
  
           
  <!-- SORT  AND FILTER SCRIPT -->
  
  <script>
      $(document).ready(function() {
          // Event listener for dropdown menu links
          $('.dropdown-item-filter-account-type').click(function() {
              // Get the selected account type
              var selectedType = $(this).text().toLowerCase();
      
              // Show/hide table rows based on the selected account type
              $('.account-row').each(function() {
                  var accountType = $(this).data('account-type').toLowerCase();
                  if (selectedType === 'all' || accountType === selectedType) {
                      $(this).show();
                  } else {
                      $(this).hide();
                  }
              });
          });
      });
  
      $(document).ready(function() {
      // Initialize DataTable
      var table = $('#table2').DataTable({
          "paging": false, // Disable pagination if not needed
          "order": [[0, "asc"]], // Initial sorting by the first column (change as needed)
      });
  
      // Event listener for dropdown menu links
      $('.dropdown-item-filter-account-type').click(function() {
          // ... (your existing filtering logic)
  
          // Refresh DataTable after filtering
          table.draw();
      });
  
      // Event listener for sorting dropdown menu link
      $('.dropdown-item-sort').click(function() {
          var columnIndex = $(this).data('column-index');
  
          // Toggle between ascending and descending order
          var order = table.order()[0];
          if (order[0] === columnIndex) {
              order[1] = order[1] === 'asc' ? 'desc' : 'asc';
          } else {
              order = [columnIndex, 'asc'];
          }
  
          // Apply sorting
          table.order(order).draw();
      });
  });
      </script>
      
    <!-- share sccripts -->
  <script>
     function shareOnWhatsApp() {
      var url = window.location.href;
      var text = url;
      text = encodeURIComponent(text);
      var whatsappUrl = "whatsapp://send?text=" + text;
      window.location.href = whatsappUrl;
    }
  
  </script>
  
  <!-- print and pdf  and xcel scripts -->
  
  
  <script>
  function printSelectedArea2(area) {
    var printContents = document.getElementById("table1").innerHTML;
  var searchInput = document.getElementById('searchInput2');
  var mini = document.getElementById('mini');
  var stock = document.getElementById('stock');
  var value = document.getElementById('value');
  
  // Open a new window
  var printWindow = window.open('', '_blank');
  
  // Add styles to hide specific elements during printingox
  printWindow.document.write('<style>@media print { #searchInput2, #dropdownContent0,#dropdownContent1,#dropdownContent2,#dropdownContent3,#dropdownContent4,#dropdownContent5,#dropdownContent6 { display: none; } }</style>');
  printWindow.document.write('<style>@media print { #mini,#stock{ margin-left:70% ; } }</style>');
  printWindow.document.write('<style>@media print { #stock{ margin-top:-12% ; } }</style>');
  printWindow.document.write('<style>@media print { #mini{ margin-top:-28% ; } }</style>');
  printWindow.document.write('<style>@media print { #value,{ margin-left:50% } }</style>');
  // Add additional styles for the table layout
  printWindow.document.write('<style>table { border-collapse: collapse; width: 100%; }</style>');
  printWindow.document.write('<style>table, th, td { border: 1px solid black; }</style>');
  
  // Write the HTML content to the new window
  printWindow.document.write('<html><head><title>Print Data</title></head><body>');
  printWindow.document.write(document.getElementById('div-to-print').innerHTML);
  printWindow.document.write('</body></html>');
  
  // Print the new window
  printWindow.print();
  
  
  }
  
  
  
  function exportToPDF3() {
    // Get references to the elements
    var content = document.getElementById('div-to-print');
    var searchInput = document.getElementById('searchInput2');
    var fil = document.getElementById('fil');
    // var fil1 = document.getElementById('fil1');
    var fil2 = document.getElementById('fil2');
    var fil3 = document.getElementById('fil3');
    var fil4 = document.getElementById('fil4');
    var fil5 = document.getElementById('fil5');
    var fil6 = document.getElementById('fil6');
    var fil7 = document.getElementById('fil7');
    // Create a clone of the search input and hide it in the clone
    // var searchClone = searchInput.cloneNode(true);
    // searchClone.style.display = 'none';
    // content.appendChild(searchClone);
  
    // Apply styles to the content
    fil.style.display = 'none';
    // fil1.style.display = 'none';
    fil2.style.display = 'none';
    fil3.style.display = 'none';
    fil4.style.display = 'none';
    fil5.style.display = 'none';
    fil6.style.display = 'none';
    fil7.style.display = 'none';
  
    searchInput.style.display = 'none';
    content.style.backgroundColor = 'white';
    content.style.color = 'black';
  
    var heading = document.createElement('h1');
    // heading.textContent = '{{selitem.item_name}}' + '  ' + 'Transactions';
    heading.style.textAlign = 'center';
    heading.style.marginTop = '50px';
    heading.style.marginBottom = '20px';
    content.insertBefore(heading, content.firstChild);
  
    // Apply styles to h1 elements within the content
    var h1Elements = content.getElementsByTagName('h1');
    for (var i = 0; i < h1Elements.length; i++) {
      h1Elements[i].style.color = 'black';
    }
  
    // Generate PDF using html2pdf
    html2pdf()
      .from(content)
      .save('{{selitem.item_name}}' + '.pdf');
  
    // Remove the cloned search input after generating PDF
    content.removeChild(searchClone);
  }
  
  
  function exportToExcel() {
      var table = document.querySelector('#table1'); // Add # to select by ID
      var cellsToHide = [
          { id: 'dropdownContent0', content: 'HideThis' },
          { id: 'dropdownContent1', content: 'AnotherHiddenValue' },
          { id: 'dropdownContent2', content: 'HideThis' },
          { id: 'dropdownContent3', content: 'AnotherHiddenValue' },
          { id: 'dropdownContent4', content: 'HideThis' },
          { id: 'dropdownContent5', content: 'AnotherHiddenValue' },
          { id: 'dropdownContent6', content: 'HideThis' },
          { id: 'dropdownContent7', content: 'AnotherHiddenValue' },
          // Add more cell IDs and content as needed
      ];
  
      // Hide the specified content in cells
      for (var i = 0; i < cellsToHide.length; i++) {
          var cellInfo = cellsToHide[i];
          var cell = document.getElementById(cellInfo.id);
          
          if (cell) {
              cell.textContent = '';
          }
      }
      var ws = XLSX.utils.table_to_sheet(table);
      var wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
      XLSX.writeFile(wb, 'item.xlsx');
  }
  
  </script>
  
 
  
  
 
  
  
  
  <script>
    function sortTable(columnIndex) {
        alert("invoiceTable")
       const table = document.getElementById("invoiceTable");
       const tbody = table.getElementsByTagName('tbody')[0];
       const rows = Array.from(tbody.rows);
   
       rows.sort((row1, row2) => {
           const cellValue1 = row1.cells[columnIndex].textContent.toLowerCase();
           const cellValue2 = row2.cells[columnIndex].textContent.toLowerCase();
   
           if (cellValue1 < cellValue2) {
               return -1;
           } else if (cellValue1 > cellValue2) {
               return 1;
           } else {
               return 0;
           }
       });
   
       while (tbody.firstChild) {
           tbody.removeChild(tbody.firstChild);
       }
   
       rows.forEach(row => tbody.appendChild(row));
   }
   
   
   </script>
  
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
  <script>
    $(document).ready(function() {
      $('#searchInput').on('keyup', function() {
        var searchText = $(this).val().toLowerCase();
        $('#table2 tbody tr').each(function() {
          var itemData = $(this).text().toLowerCase();
          if (itemData.indexOf(searchText) === -1) {
            $(this).hide();
          } else {
            $(this).show();
          }
        });
      });
    });
  </script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
  <script>
    $(document).ready(function() {
      $('#searchInput2').on('keyup', function() {
        var searchText = $(this).val().toLowerCase();
        $('#table1 tbody tr').each(function() {
          var itemData = $(this).text().toLowerCase();
          if (itemData.indexOf(searchText) === -1) {
            $(this).hide();
          } else {
            $(this).show();
          }
        });
      });
    });
  </script>
  
  
  <script>
    function cleardropdown(index) {
      document.getElementById('filterInput' + index).value = '';
    }
  
    function toggleDropdown(index) {
      var dropdownContent = document.getElementById('dropdownContent' + index);
      var isVisible = dropdownContent.style.display === 'block';
      var allDropdowns = document.querySelectorAll('.dropdown-content');
      allDropdowns.forEach(function (dropdown) {
        dropdown.style.display = 'none';
      });
      dropdownContent.style.display = isVisible ? 'none' : 'block';
    }
  
    function filterTable(index) {
      var input;
      document.getElementById('dropdownContent' + index).style.display = 'none';
  
      if (index === 3) {
        input = document.getElementById('filterInput' + index).valueAsDate;
      } else {
        input = document.getElementById('filterInput' + index).value.toUpperCase();
      }
  
      var table = document.getElementById('table1');
      var rows = table.getElementsByTagName('tr');
      var emptyMessage = document.getElementById('emptyMessage');
      var isEmpty = true;
  
      for (var i = 1; i < rows.length; i++) {
        var cells = rows[i].getElementsByTagName('td');
        var cell = cells[index];
  
        if (cell) {
          var textValue = cell.textContent || cell.innerText;
  
          if (index === 3) {
            var dateVal = new Date(textValue);
            var inputDate = new Date(input);
  
            if (dateVal.toISOString().split('T')[0] === inputDate.toISOString().split('T')[0]) {
              rows[i].style.display = 'table-row';
              isEmpty = false;
            } else {
              rows[i].style.display = 'none';
            }
          } else {
            if (textValue.toUpperCase().includes(input)) {
              rows[i].style.display = 'table-row';
              isEmpty = false;
            } else {
              rows[i].style.display = 'none';
            }
          }
        }
      }
  
      emptyMessage.style.display = isEmpty ? 'block' : 'none';
      // You can add any additional logic or calculations here
    }
  </script>
  <div class="modal fade" id="commentModal2" >
    <div class="modal-dialog modal-xl" >
      <div class="modal-content" style="background: #1f1f1ffd;border-radius: 20px;">
        <div class="modal-header" style="background: #1f1f1ffd;">
          <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #e1e1e1;">HISTORY</h5>
          <button type="button" class="close" style="width: 30px;" data-dismiss="modal" aria-label="Close"><span
              aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body" style="background: #1f1f1ffd;;">
          <div class="card p-3 m-3" style="background-color: #000;">
          
            <table style="background-color: #000; margin-right: 10px; border-radius: 5px;">
              <thead class="text-white">
                  <tr>
                      <th style="color: rgb(250, 247, 242); padding-bottom: 10px;"><b>sl</b></th>
                      <th style="color: rgb(244, 244, 244); padding-bottom: 10px;"><b>Date</b></th>
                      <th style="color: rgb(250, 247, 242); padding-bottom: 10px;"><b>Action</b></th>
                      <th style="color: rgb(250, 247, 242); padding-bottom: 10px;"><b>BY</b></th>
                  </tr>
                  <tr>
                      <td colspan="4" style="border-bottom: 2px solid white; margin-bottom: 10px;"></td>
                  </tr>
              </thead>
          
              <tbody style="background-color: black; padding-top: 20px;"> <!-- Adjusted padding-top for spacing -->
                {% for s in sales_history %}
                      <tr style="background-color: black;height: 40px;">
                        <td class="text-white" style="color: rgb(0, 0, 0); background-color: black; padding-bottom: 10px;">{{forloop.counter}}</td>
                        <td class="text-white" style="color: rgb(0, 0, 0); background-color: black; padding-bottom: 10px;">{{ s.date }}</td>
                        {% if s.action == 'Created' %}<td class="text-white" style="color: rgb(0, 0, 0); background-color: black; padding-bottom: 10px;">{{ s.action }}</td> {% else %}<td class="text-warning" style="color: rgb(0, 0, 0); background-color: black; padding-bottom: 10px;">{{s.action}}</td>{% endif %}           
                          <td class="text-white" style="color: rgb(0, 0, 0); background-color: black; padding-bottom: 10px;">{{ s.login_details.first_name }}&nbsp;{{ s.login_details.last_name }}</td>
                      </tr>
                  {% endfor %}
              </tbody>
          </table>
          
          </div>
      </div>
      
  </div>
  </div></div>

  <script>
    var $rows = $('#invoiceTable tbody tr');
    $('#search').keyup(function() {
      var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
      
      $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
      }).hide();
    });
    
  
    
  
    jQuery(document).ready(function ($) {
      $(".clickable-row").click(function () {
        window.location = $(this).data("href");
      });
    });
  
    function sortTable(columnIndex) {

      var table, rows, switching, i, x, y, shouldSwitch;
      table = document.getElementById("table2");
      switching = true;
  
      while (switching) {
        switching = false;
        rows = table.rows;
  
        for (i = 1; i < (rows.length - 1); i++) {
          shouldSwitch = false;
          x = rows[i].getElementsByTagName("td")[columnIndex].textContent.toLowerCase();
          y = rows[i + 1].getElementsByTagName("td")[columnIndex].textContent.toLowerCase();
  
          if (x > y) {
              shouldSwitch = true;
              break;
          }
        }
  
        if (shouldSwitch) {
          rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
          switching = true;
        }
      }
    }
  
    function filterTable(row,filterValue) {
      var table = document.getElementById("invoiceTable");
      var rows = table.getElementsByTagName("tr");
  
      for (var i = 1; i < rows.length; i++) {
        var statusCell = rows[i].getElementsByTagName("td")[row];
  
        if (filterValue == "all" || statusCell.textContent.toLowerCase() == filterValue) {
          rows[i].style.display = "";
        } else {
          rows[i].style.display = "none";
        }
      }
    }
  
    function sortBalAsc() {
      var table = document.getElementById("invoiceTable");
      var rows = Array.from(table.rows).slice(1);
  
      rows.sort(function (a, b) {
        var balA = parseFloat(a.cells[7].textContent);
        var balB = parseFloat(b.cells[7].textContent);
        return balA - balB;
      });
  
      // Remove existing rows from the table
      for (var i = table.rows.length - 1; i > 0; i--) {
          table.deleteRow(i);
      }
  
      // Append the sorted rows back to the table
      rows.forEach(function (row) {
          table.tBodies[0].appendChild(row);
      });
    }
  </script>
  
<!-- Add Document  -->
<div class="modal fade" id="attachmentModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content" style="background:black; border: 1px solid #ffae1f;">
        <div class="modal-body">
          <div class="row">
            <div class="col-md-10 p-4">
              <h2 class="text-uppercase" style="color: white; font-weight: bolder;">ADD Documents</h2>
            </div>
            <div class="col-md-2 p-3">
              <button type="button" class="btn close" data-dismiss="modal" aria-label="Close" style="float: right;">
                <span aria-hidden="true" style="color: white; font-weight: bolder;">&times;</span>
              </button>
            </div>
          </div><br>
          <form action="{% url 'add_salesorder_file' sale.id %}" method="post" class="needs-validation" novalidate enctype="multipart/form-data">
            {%csrf_token%}
            <div class="row mt-2">
              <div class="col-md-1"></div>
              <div class="col-md-2">
                <label class="pt-2" for="origin" style="color: white;">Add File</label>
              </div>
              <div class="col-md-6">
                <input type="file" class="form-control text-white bg-black" name="file" id="filess">
                <input type="hidden" name="invoice_id" value="{{ sale.id }}">

              </div>
            </div>
            <div class="row mt-3">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="submit">Save</button> 
                  <input class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" data-dismiss="modal" type="reset" value="Reset">
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>


<!-- Add Comment  -->
<div class="modal fade" id="commentsModal1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
        <div class="modal-body" style="background:black;">
          <div class="row">
            <div class="col-md-10 p-4">
              <h2 class="text-uppercase" style="color: white; font-weight: bolder;">Add Comments</h2>
            </div>
            <div class="col-md-2 p-3">
              <button type="button" class="btn close" data-dismiss="modal" aria-label="Close" style="float: right;">
                <span aria-hidden="true" style="color: white; font-weight: bolder;">&times;</span>
              </button>
            </div>
          </div><br>
          <form action="{% url 'salesorder_add_comment' sale.id %}" method="post" class="needs-validation" novalidate enctype="multipart/form-data">
            {%csrf_token%}
            <div class="row mt-2">
              <div class="col-12">
                <textarea type="text" rows="4" class="form-control text-white" name="comments" placeholder="Add Comments.." required></textarea>
                {% if not comments %}
                  <span class="my-2 font-weight-bold d-flex justify-content-center">No Comments.!</span>
                  {% else %}
                  <div class="container-fluid comments-table-container">
                      <table class="table mt-4">
                          <thead>
                              <tr>
                                <th style="text-align: center; font-size: large;">Sl No.</th>
                                <th style="text-align: center; font-size: large;">Comments</th>
                                <th style="text-align: center; font-size: large;">By</th>
                                <th style="text-align: center; font-size: large;">Delete</th>
                              </tr>
                          </thead>
                          <tbody>
                            {% for comment in comments %}
                            <tr class="table-row">
                                <td style="text-align: center;">{{ forloop.counter }}</td>
                                <td style="text-align: center;">{{ comment.comment }}</td>
                                <td style="text-align: center;">{{ comment.login_details.first_name }}
                                  {{ comment.login_details.last_name }}
                                </td> 
                                <td style="text-align: center;">
                                    <a class="text-danger" href="{% url 'salesorder_delete_comment' comment.id %}">
                                        <i class="fa fa-trash" style="font-size:20px;"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                      </table>
                  </div>
                  {% endif %}
              </div>
            </div>
            <div class="row mt-3">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="submit">Save</button> 
                  <input class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" data-dismiss="modal" type="reset" value="Close">
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>




  
{% endblock %}

