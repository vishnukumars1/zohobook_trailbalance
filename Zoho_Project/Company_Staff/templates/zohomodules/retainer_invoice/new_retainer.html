{% extends 'base.html' %}
{% block content %}
{% load static %}
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
<script src="https://raw.githack.com/eKoopmans/html2pdf/master/dist/html2pdf.bundle.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha384-ez8n5b/9F3JpKCEY6zIp+Hg7IbU8d7Q5ST78iEiRaP2mNPjkDps8I+1i0fblDOoh" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-xxxxxx" crossorigin="anonymous" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<style>

    

    #customer_sel + .selectize-control {
      width: 800px; 
    }


    #customer_sel + .selectize-control .selectize-input {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 8px;
      height: 30px;
    }


    #customer_sel + .selectize-control .selectize-dropdown {
      border: 1px solid #ccc;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }


    #customer_sel + .selectize-control .selectize-dropdown-content .option {
      padding: 8px;
      cursor: pointer;
      background-color: #000;
    }


    #customer_sel + .selectize-control.multi .item {
      background-color: #000000;
      margin-right: 5px;
      border-radius: 4px;
      padding: 2px 6px;
    }

    #customer_sel + .selectize-control .selectize-dropdown-content .option:hover {
  background-color: white !important;
  color: black !important;
}



#item1 + .selectize-control .selectize-dropdown-content .option:hover {
  background-color: white !important;
  color: black !important;
}

    #item1 + .selectize-control {
      width: 100px; 
    }


    #item1 + .selectize-control .selectize-input {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 8px;
      height: 50px;
    }


    #item1 + .selectize-control .selectize-dropdown {
      border: 1px solid #ccc;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }


    #item1 + .selectize-control .selectize-dropdown-content .option {
      padding: 8px;
      cursor: pointer;
      background-color: #000;
      
    }


    #item1 + .selectize-control.multi .item {
      background-color: #e0e0e0;
      margin-right: 5px;
      border-radius: 4px;
      padding: 2px 6px;
    }



    #item1 + .selectize-control {
      width: 200px; 
    }


    #item${itemCounter} .selectize-control .selectize-input {
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 8px;
  height: 50px;
}



#item${itemCounter}.selectize-control .selectize-dropdown {
      border: 1px solid #ccc;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }


    #item${itemCounter}  .selectize-control .selectize-dropdown-content .option {
      padding: 8px;
      cursor: pointer;
      background-color: #000;
      
    }


    #item${itemCounter} .selectize-control.multi .item {
      background-color: #e0e0e0;
      margin-right: 5px;
      border-radius: 4px;
      padding: 2px 6px;
    }
    

    
    
    
    
      .outline-border {
    border: 1px solid white; /* Set the border style */
  }
  .outline-border td {
    border: none; /* Remove borders for individual cells */
  }
      /* form style */
 /* Style for the last row */
 #retainer-table tbody tr:last-child {
    height: 50px; /* Adjust the height value as needed */
  }

*{
    color: aliceblue;
    
}
input {
    color: white;
}
</style>
<style>         /* SEARCH STYLE */
  /* Style the Select2 search input */
  .select2-search__field {
    width: 100%; /* Set the width as needed */
    padding: 8px; /* Adjust padding as needed */
    border: 1px solid #92acc6; /* Add border color */
    border-radius: 4px; /* Add border-radius for rounded corners */
    outline: none; /* Remove the outline */
    color: #000;
  }
/*   
  .select2-container .select2-selection--single{box-sizing:border-box;cursor:pointer;display:block;height:35px;user-select:none;color: black;
    -webkit-user-select:none;background-color: #fff;} */
.select2-container .select2-selection--single .select2-selection__rendered{border: 1px solid white; border-radius: 6px; display:block;padding-left:20px;padding-right:20px; height: 35px;color: rgb(252, 252, 252);background-color: #000000;border-radius: 2px;box-shadow: #fcfcfc;border-color: #f2e8e8;}
    .select2-dropdown{background-color:rgb(0, 0, 0);color: rgb(253, 253, 253);position:absolute;left:-100000px;width:100%;z-index:1051;color: rgb(255, 255, 255);border-color: #f2e8e8;}
    .select2-results{display:block;border: #ced4da;border-color: #f2e8e8;}
    .select2-results__options{list-style:none;margin:0;padding:0;color: rgb(255, 255, 255);background-color: #030303;padding-left: 20px;border-color: #f2e8e8;} 
    .select2-results__option[aria-selected]{cursor:pointer;color: rgb(251, 251, 251);background-color: #0c0c0c;border-color: #f2e8e8;}
    .select2-container--open .select2-dropdown{left:0;color: rgb(255, 255, 255);background-color: #000000;border-color: #f2e8e8;}

    .select2-hidden-accessible{background-color: #000000;border:2px !important;clip:rect(0 0 0 0) !important;-webkit-clip-path:inset(50%) !important;clip-path:inset(50%) !important;height:0px !important;padding:0 !important;position:absolute !important;width:1px !important;white-space:nowrap !important;color: rgb(250, 250, 250)} 
    /* .select2-container--default .select2-selection--single{background-color:#000000;border:1px solid #000000;border-radius:4px;color: rgb(0, 0, 0);background-color: #ede4e4;} */
/* .select2-hidden-accessible{background-color: #fff;border:0 !important;clip:rect(0 0 0 0) !important;-webkit-clip-path:inset(50%) !important;clip-path:inset(50%) !important;height:1px !important;overflow:hidden !important;padding:0 !important;position:absolute !important;width:1px !important;white-space:nowrap !important;color: black}  */
.select2-container--default .select2-selection--single:focus, .select2-container--default .select2-selection--single .select2-search__field:focus, .typeahead:focus, .tt-query:focus, .tt-hint:focus {
    border: 1px solid rgba(250, 250, 250, 0.5);
    background-color: #d3bcbc;
}
</style>
<style> /* MODAL STYLE */
  .modal {
 z-index: 9999;
 overflow: scroll;
}

.modal-content {
 background-color: #fefefe;
 margin: 15% auto;
 padding: 20px;
 border: 1px solid #888;
 width: 80%;
}

</style>
<style>   /* ACCOUNT STYLE */
  /*.modal {
    z-index: 9999;
    overflow: scroll;
  }*/
li{
  color: #000;
}
  a {
      color: rgb(0, 0, 0);
  }

  a:hover {
      color: rgb(214, 141, 5);
  }

  tr:hover {
      background-color: #92929242;
      font-weight: bold;
  }

  /* width */
  /*::-webkit-scrollbar {
    width: 10px;
  }

  /* Track */
  /*::-webkit-scrollbar-track {
    background: rgb(252, 236, 217);

  }

  /* Handle */
  /*::-webkit-scrollbar-thumb {
    background: #888;
  }

  /* Handle on hover */
  /*::-webkit-scrollbar-thumb:hover {
    background: #555;
  }*/

  /*#selected-area {
    font-size: 20px;
  }



  /* .......................................... search box1.............. */
  .select-box1 {
      position: relative;
      width: 100%;
  }
  

  .select-option1 {
      position: relative;
      
  }

  .select-option1 input {
      width: 100%;
      cursor: pointer;
      background-color: white;
      color: black;
      border-radius: 7px;
      padding: 10px 15px;
      border: 0 !important;
      outline: 0 !important;
  }

  .select-option1:after {
      content: "";
      border-top: 12px solid #000;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      position: absolute;
      right: 15px;
      top: 50%;
      margin-top: -8px;

  }

  .content1 {
      background-color: white;
      position: absolute;
      color: black;
      border-radius: 7px;
      margin-top: 15px;
      width: 100%;
      z-index: 999;
      padding: 20px;
      display: none;
  }

  .search1 input {
      width: 100%;
      font-size: 17px;
      padding: 15px;
      outline: 0;
      border: 1px solid #b3b3b3;
      border-radius: 5px;
  }

  .options1 {
      margin-top: 10px;
      max-height: 150px;
      overflow-y: scroll;
      padding: 0;
  }

  /* .options1::-webkit-scrollbar{
      width: 5px;
     
    } */
  .options1 li {
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      border-bottom: 1px solid gray;
  }

  .select-box1.active .content1 {
      display: block;
  }

  .select-box1.active .select-option1:after {
      transform: rotate(-180deg);
  }


  
</style>


<style>
  .modal{
    z-index: 9999;
    overflow: scroll;
  }
  .selectize-input {
    background-color: #000 !important;
    color: white !important;
}

.selectize-input input {
    color: white !important;
}

  /* .form-group{
    width: 40%;
  } */

  .row:after {
    content: "";
    display: table;
    clear: both;
  }
  
  @media screen and (max-width: 600px) {
    .col-25, .col-75, input[type=submit] {
      width: 100%;
      margin-top: 0;
    }

    input[type=text], select, textarea {
      width: 100%;
    }
  }

  .dropdown input,
  .dropdown button {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
  }

  .dropdown.open input,
  .dropdown.open button {
    display: block;
  }

  .row a{
    color: rgb(218, 164, 48);
    font-size: 12px;
  }

  .table th a{
    color:rgb(218, 164, 48);
    font-size: 11px;
    margin-left: 100px;
  }

  ::-webkit-scrollbar {
    display: none;
  }

  ::-webkit-scrollbar-track {
    background: #f1f1f1; 
  }

  ::-webkit-scrollbar-thumb {
    background: #888; 
  }

  ::-webkit-scrollbar-thumb:hover {
    background: #555; 
  }

  .item{
    height: auto;
  }

  .labels{
    color: white; 
    font-size:2.5vh; 
    font-weight: bolder;
  }

  .btn-outline-warning:hover {
    color: black !important;
    font-weight: bold;
  }
  .dropdown-item.customers-options:hover, .dropdown-item.items-options:hover{
    background: white !important;
    color: black !important;
    cursor: pointer;
  }
</style>
<style>
  label{
      color: white;
  }
  .section-3
  {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
      margin-top: 1rem;
  }
  .section-3 .section-toggle
  {
      margin-bottom: 0.50rem;
  }
   .section-toggle a
  {

      color: rgb(230, 171, 45);
      font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
      font-size:1.275rem;
  }
  .add_another
  {
     
      color: rgb(230, 171, 45);
  }
  #tbl thead th{
      font-size: 0.785rem;
  }
  @media (max-width:700px)
  {
  .section-3
  {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr ;  

  }
  .section-3 .section-toggle a
  {

      color: rgb(230, 171, 45);
      font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
      font-size:0.875rem;
  }
  }
 


  /* Account Modal */

  .select-box1 {
      position: relative;
      width: 100%;
  }
  

  .select-option1 {
      position: relative;
      
  }

  .select-option1 input {
      width: 100%;
      cursor: pointer;
      background-color: white;
      color: black;
      border-radius: 7px;
      padding: 10px 15px;
      border: 0 !important;
      outline: 0 !important;
  }

  .select-option1:after {
      content: "";
      border-top: 12px solid #000;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      position: absolute;
      right: 15px;
      top: 50%;
      margin-top: -8px;

  }

  .content1 {
      background-color: white;
      position: absolute;
      color: black;
      border-radius: 7px;
      margin-top: 15px;
      width: 100%;
      z-index: 999;
      padding: 20px;
      display: none;
  }

  .search1 input {
      width: 100%;
      font-size: 17px;
      padding: 15px;
      outline: 0;
      border: 1px solid #b3b3b3;
      border-radius: 5px;
  }

  .options1 {
      margin-top: 10px;
      max-height: 150px;
      overflow-y: scroll;
      padding: 0;
  }

  /* .options1::-webkit-scrollbar{
      width: 5px;
     
    } */
  .options1 li {
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      border-bottom: 1px solid gray;
  }

  .select-box1.active .content1 {
      display: block;
  }

  .select-box1.active .select-option1:after {
      transform: rotate(-180deg);
  }
     
</style>

<script> $(document).ready(function () {
    // Initialize Selectize on the item dropdown
    $('#customer_sel').selectize({
      
      sortField: 'value', // Sort the items by their text content
      
    })

  });
  $(document).ready(function () {
    // Initialize Selectize on the item dropdown
    $('#item1').selectize({
      
      sortField: 'value', // Sort the items by their text content
      
    })

  });
  </script>
<div class="body-wrapper">
    <div class="container-fluid">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>
              <li class="breadcrumb-item"><a href="{% url 'items_list' %}" class="text-warning-emphasis">Retainer Invoice</a></li>
              <li class="breadcrumb-item" aria-current="page" style="color:rgb(105, 70, 4);">Retainer Invoice</li>
              <li class="breadcrumb-item" aria-current="page" style="color:rgb(177, 177, 177);">Create</li>
            </ol>
        </nav>
        <div class="row mt-5">
            <div class="col-md-12">
                <div class="card mb-3 bg-black shadow p-3 mb-5 rounded" style="max-width: 1400px;">
                
               <br>
               <!-- <div style="background-color: rgb(0, 0, 0); border-radius: 10px; width:80% ;margin-left: 18%;"> -->
                <div >
                  <h1 id="selected_customer_heading" class="text" style="color: white; margin-left: 2%; padding-top: 20px;"><b>NEW RETAINER INVOICE</b></h1>
                </div>
           
            <div class="container-fluid"> 
              {% for m in messages %}
              <p style="color: chocolate;">{{m}}</p>
              {% endfor %}
      
              <form action="" id="home" method="post" enctype="multipart/form-data" style="padding-left: 20px;">
                {% csrf_token%}
                <br>  
                <h3 class="mb-3 text-white mt-4" style="font-size: 2rem;"></h3>
             
                <fieldset class="form-group" >
                    <div class="row">
                      <hr>
                          <div class="col-sm-3">
                            <b><label class="" style="font-size: medium; ">Customer </label></b>
                          </div>
                          <div class="col-md-6 d-flex">
                            <select class="form-control form-select" id="customer_sel" name="select"
                            onchange="getCustomerDetails(this.value)" required 
                            style="background-color: black; color: white;border-radius: 5px;">
                        <option hidden disabled selected value="">Select Customer</option>
                        {% for customer in customer1 %}
                        <option value="{{ customer.id }}">{{ customer.customer_display_name }}</option>
                        {% endfor %}
                    </select>
                    
                    <button type="button" data-toggle="modal" data-target="#newCustomer" class="btn btn-outline-warning py-2 ms-1">+</button>
                          </div>
                    </div>
                </fieldset>
                <br>
                <div class="form-group row" id="cemail_row">
                  <div class="col-sm-3 ">
                    <b><label for="" style="font-size: medium; ">Email</label></b>
                  </div>
                  <div class="col-md-6">
                    <input type="email" id="cx_mail" name="cx_mail" class="form-control " style="background-color: black; color: white;border-radius: 5px;" readonly>
                  </div>
                  <input type="text" style="width: 30%;display: none;" id="customer_id" name="customer_id" readonly>  
                </div>
                  <br>
                
                  <div class="form-group row" id="address_row">
                    
                    <div class="col-md-3"><b><label for=""style="color: aliceblue; font-size: medium;" >Billing Address</label></b></div>
                    <div class="col-md-6"><textarea name="" id="customer_address" cols="30" class="form-control "
                        style="height: auto;" style="background-color: black; color: white;"></textarea>
                    </div>
                </div>
                <br>
                <div class="form-group row" id="cgst_treat_row">
                  <div class="col-md-3"><b><label for=""  style="color: aliceblue; font-size: medium;">GST Treatment</label></b></div>
                  <div class="col-md-6"><input type="text" id="customer_gst_treat" name="" class="form-control text-light" value=""
                      readonly style="color: aliceblue;">
                  </div>
                </div>
                <br>
                <div class="form-group row" id="cgstno_row">
                  <div class="col-md-3"><b><label for="" style="font-size: medium;" >GST Number</label></b></div>
                  <div class="col-md-6"><input type="text" id="customer_gstno" name="" class="form-control text-light" value=""
                      readonly>
                  </div>
                </div>
                <br>
                <div class="form-group row" id="cplace_supply_row">
                  <div class="col-md-3"><b><label for="" style="font-size: medium;">Place Of Supply</label></b></div>
                  <div class="col-md-6">
                    <select class="form-control " id="cus_place1" name="cus_place1" onclick="place_of_supply()" style="background-color: black; color: white;">
                      <option value="[AN]-Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                      <option value="[AD]-Andhra Predhesh">[AD] Andhra Predhesh</option>
                      <option value="[AR]-Arunachal Predesh">[AR] Arunachal Predesh</option>
                      <option value="[AS]-Assam">[AS] Assam</option>
                      <option value="[BR]-Bihar">[BR] Bihar</option>
                      <option value="[CH]-Chandigarh">[CH] Chandigarh</option>
                      <option value="[CG]-Chhattisgarh">[CG] Chhattisgarh</option>
                      <option value="[DNH]-Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                      <option value="[DD]-Damn anad Diu">[DD] Damn anad Diu</option>
                      <option value="[DL]-Delhi">[DL] Delhi</option>
                      <option value="[GA]-Goa">[GA] Goa</option>
                      <option value="[GJ]-Gujarat">[GJ] Gujarat</option>
                      <option value="[HR]-Haryana">[HR] Haryana</option>
                      <option value="[HP]-Himachal Predesh">[HP] Himachal Predesh</option>
                      <option value="[JK]-Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                      <option value="[JH]-Jharkhand">[JH] Jharkhand</option>
                      <option value="[KA]-Karnataka">[KA] Karnataka</option>
                      <option value="[KL]-Kerala">[KL] Kerala</option>
                      <option value="[LA]-Ladakh">[LA] Ladakh</option>
                      <option value="[LD]-Lakshadweep">[LD] Lakshadweep</option>
                      <option value="[MP]-Madhya Predesh">[MP] Madhya Predesh</option>
                      <option value="[MH]-Maharashtra">[MH] Maharashtra</option>
                      <option value="[MN]-Manipur">[MN] Manipur</option>
                      <option value="[ML]-Meghalaya">[ML] Meghalaya</option>
                      <option value="[MZ]-Mizoram">[MZ] Mizoram</option>
                      <option value="[NL]-Nagaland">[NL] Nagaland</option>
                      <option value="[OD]-Odisha">[OD] Odisha</option>
                      <option value="[PY]-Puducherry">[PY] Puducherry</option>
                      <option value="[PB]-Punjab">[PB] Punjab</option>
                      <option value="[RJ]-Rajasthan">[RJ] Rajasthan</option>
                      <option value="[SK]-Sikkim">[SK] Sikkim</option>
                      <option value="[TN]-Tamil Nadu">[TN] Tamil Nadu</option>
                      <option value="[TS]-Telangana">[TS] Telangana</option>
                      <option value="[TR]-Tripura">[TR] Tripura</option>
                      <option value="[UP]-Uttar Predesh">[UP] Uttar Predesh</option>
                      <option value="[UK]-Uttarakhand">[UK] Uttarakhand</option>
                      <option value="[WB]-West Bengal">[WB] West Bengal</option>
                      <option value="[OT]-Other Territory">[OT] Other Territory</option>
                    </select>

                  </div>
                </div>
                <br>
                <b><div class="form-group row" style="font-size: medium;">
                    <label class="col-md-3">Retainer Invoice Number*</label>
                    <div class="col-md-6">
                      <input type="text" class="form-control " name="retainer-invoice-number" id="prof_name"
                        placeholder="{{next_ret_number}}" required style="background-color: black; color: white; ">
                      <label id="order_label" style="display: none;"></label>
                    </div>
                </div></b>
                
                <br>
                <b><div class="form-group row"  style="font-size: medium;">
                  <label class="col-md-3">Reference</label>
                  <div class="col-md-6">
                    <input type="text" class="form-control" name="references" value="{{reford}}" readonly style="background-color: black; color: white;">
                  </div>
              </div>  </b> 
              <br>
              <b><div class="form-group row" style="font-size: medium;">
                <label class="col-md-3">Retainer Invoice Date*</label>
                <div class="col-md-6">
                  <input type="date" class="form-control" name="invoicedate" id="dateField" required
                    pattern="\d{4}-\d{2}-\d{2}" style="background-color: black; color: white;">
                </div>
              </div> </b>
              <br> 
              <b>
                <div class="form-group row" style="font-size: medium;">
                <div class="col-md-3">
                  <label for="date2">Payment Method</label>
                </div>
        
                <div class="col-md-6">
                  <div class="d-flex">
                    <select class="form-control my-select" id="pay_method" name="pay_method" required style="background-color: black; color: white;">
                      <option  value="" hidden>Select Payment Method</option>
                      <option value="cash">Cash</option>
                      <option value="cheque">Cheque</option>
                      <option value="upi">UPI</option>
                      {% for bank in banks %}
                          <option value="{{ bank }}">{{ bank }}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
              </div>   </b>    
               <br>
               <b><div class="form-group row" style="font-size: medium;">
                <div class="row mt-2" id="chequediv" style="display: none;">
                  <div class="col-md-3">
                    <label for="date2">Cheque Number</label>
                  </div>
          
                  <div class="col-md-6">
                    <input type="text" class="form-control text-black" name="chq_no" id="cheque_id"
                      placeholder="Enter Cheque Number">
                  </div>
                </div>
          
                <div class="row mt-2" id="upidiv" style="display: none;">
                  <div class="col-md-3">
                    <label for="date2">UPI ID</label>
                  </div>
          
                  <div class="col-md-6">
                    <input type="text" class="form-control text-black" name="upi_id" id="upi_id" placeholder="Enter UPI ID">
                  </div>
                </div>
          
                <div class="row mt-2" id="bnkdiv" style="display: none;">
                  <div class="col-md-3">
                    <label for="date2">Bank Account Number</label>
                  </div>
          
                  <div class="col-md-6">
                    <input type="text" class="form-control text-white" name="acc_no" id="bnk_id" readonly>
                  </div>
                </div>
              </div>  </b>      
              <br><br>    
              
              
              <div class="row mt-2">
                <div class="col-md-12 mt-3">
        
                  <table id="retainer-table" class="table table-bordered table-responsive"
                    style="background-color: rgba(0, 0, 0, 0.8);">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th style="font-size: medium;">PRODUCT&nbsp;</th>
                        <th style="font-size: medium;">HSN</th>
                        
                       
                        <th style="font-size: medium;" class="text-right">QUANTITY</th>
                        <th style="font-size: medium;" class="text-right">RATE</th>
                        <th style="font-size: medium;" class="text-right">DESCRIPTION</th>
                        <th style="font-size: medium;" class="text-right">AMOUNT</th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody id="tbody-table">
                      <tr class="item-row" id="row1">
                        <td style="width:1px;" class="index-number">1</td>
                        <td>
                          <div style="display: flex; align-items: center;">
                          <select class='form-control  item_select itm' name='item[]'
                            id='item1' onchange="itemfunction(this.id)" style="background-color: black; color:white; width: 150px !important;">
                            <option value="" selected hidden>Select Item</option>
                            {% for i in item %}
                            <option  class=" bg-dark text-light.name" value="{{i.id}}">{{ i.item_name}} </option>
                            {% endfor %}
                          </select>
                          <a href="#">
                            <button type="button" class="btn btn-outline-warning ms-1" data-target="#newItem" data-toggle="modal">+</button>
                        </a>
                      </div>
                        </td>
                        
                            <td><input type="text" class="hsn form-control" name="hsn[]" style="width: 85px;" required id="hsn1" /></td>
 <!-- Add HSN input field -->
                        <td><input type="number" name="quantity[]" id="qty1"
                            class="form-control  qty"
                            style="width: 100px;" onchange="calculateAmount(1)">
                            <p style="font-size: 0.7rem;">Available Qty: <span id="available_stock"></span></p>
                        </td>
                        <td><input type="number" class="rate form-control "
                            name="rate[]" style="width: 95px;" step="0.01" required id="rate1" onchange="calculateAmount(1)"
                            readonly /></td>
                            <td><input type="text" class="form-control "
                                name="description[]" style="width: 100px;"  id="description1" /></td>
                        <td><input type="number"
                            class="amount form-control " name="amount[]"
                            style="width: 100px;" step="0.01" required id="amount1" readonly /></td>
                        <td class="text-center">
                          <a href="#"
                            class="delete-row btn btn-transparent  btn-sm  text-danger"
                            style="width: 30px;"><i class="fa fa-trash text-danger"></i></a><br>
                          
                        </td>
                      </tr>
                      <tr class="blank-row">
                        <td colspan="8">
                          <button type="button" class="btn btn-outline-warning text-warning-emphasis" style="background-color: black;"
                    id="add-another-line">
                    +
                  </button>
                        </td>
                      </tr>
                    </tbody>
                    
                    
                  </table>
        
                  <br>
                  
        
                  <input type="hidden" id="hidden-total-amount" name="total" value="">
        
        
                </div>
                <div class="col-md-2"></div>
                <br><br>

      <div class="row  pb-5">
      
         
          <textarea cols="8" rows="13" name="customer_notes" id="floatingTextarea" style="background-color: #000;width:450px;height:200px;" placeholder="  Note" ></textarea>
          
        
        <div class="col-sm-6 mt-1">
            
          <table class="table  text-white outline-border" style="background-color: rgba(0, 0, 0, 0.8);margin-left:65px;">
            <tr>
                <td>Sub Total</td>
                <td>:</td>
                <td><input type="number" name="subtotal"  id="subtotal"
                    class="form-control " style="text-align: right; width:180px;"
                    readonly></td>
              </tr>
              <tr>
                <td>Adjustment</td>
                <td>:</td>
                <td><input type="number"  name="adjustment" id="adjustment" class="form-control" style="text-align: right; width:180px;" onchange="updateTotals()"></td>
            </tr>
              <tr >
              <td>Total</td>
              <td>:</td>
              <td><input type="number" name="total" id="total-amount"
                  class="form-control " style="text-align: right; width:180px;"
                  readonly></td>
            </tr>
            <!-- <tr style="display: none;">
              <td>Paid</td>
              <td>:</td>
              <td><input type="number" name="paid" id="paid"
                  class="form-control " onchange="show_bal()"
                  style="text-align: right; width:180px;" value="0">
                <label for="" id="pay-warning" style="display: none;text-align: right;" class="text-warning"></label>
              </td>
            </tr>
            <tr style="display: none;">
              <td>Balance</td>
              <td>:</td>
              <td><input type="number" name="balance" id="balance"
                  class="form-control " style="text-align: right; width:180px;"
                  value="0" readonly></td>
            </tr> -->
          </table>
          
             
          <table class="table  text-white outline-border" style="background-color: rgba(0, 0, 0, 0.8);margin-left:65px;">
            <!-- <tr style="display: none;">
                <td style="display: none;">Sub Total</td>
                <td style="display: none;">:</td>
                <td style="display: none;"><input type="number" name="subtotal"  id="subtotal"
                    class="form-control " style="text-align: right; width:180px;"
                    readonly></td>
              </tr>
              <tr style="display: none;">
                <td style="display: none;">Adjustment</td>
                <td style="display: none;">:</td>
                <td><input type="number"  name="adjustment" id="adjustment" class="form-control" style="text-align: right; width:180px;" onchange="updateTotals()"></td>
            </tr >
               <tr style="display: none;">
              <td style="display: none;">Total</td>
              <td style="display: none;">:</td>
              <td style="display: none;"><input type="number" name="total" id="total-amount"
                  class="form-control " style="text-align: right; width:180px;"
                  readonly></td>
            </tr> -->
            <tr>
              <td  style="padding-right: 45px;">Paid</td>
              <td >:</td>
              <td><input type="number" name="paid" id="paid"
                  class="form-control " onchange="show_bal()"
                  style="text-align: right; width:180px;" value="0">
                <label for="" id="pay-warning" style="display: none;text-align: right;" class="text-warning"></label>
              </td>
            </tr>
            <tr>
              <td  style="padding-right: 45px;">Balance</td>
              <td>:</td>
              <td><input type="number" name="balance" id="balance"
                  class="form-control " style="text-align: right; width:180px;"
                  value="0" readonly></td>
            </tr>
          </table>
          


        </div>
      </div>


      <div class="row ">
        <div class="col-md-8 d-flex flex-column text-white mb-2"  style="margin-top: -195px; margin-left:-10px;">
          <input type="file" class="form-control" name="file" style="width:450px;"  >
          <br>
          <textarea  style="background-color: #000; width: 450px;" cols="20" rows="7" name="terms" id="floatingTextarea" placeholder="Terms & Conditions"></textarea>
        </div>
      </div>
<br>
      <div class="mt-4">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="agreeTerms" required>
            <label for="agreeTerms">Agree to terms and conditions</label>
            <div class="invalid-feedback">You must agree before submitting.</div>
        </div>
      </div>
      <div class="submit row mt-5 mb-3">
        <button class="btn mt-2" type="submit" name="action" value="draft"
          style="width: 80px;margin-right: 1vh; background-color: chocolate;" onclick="savedraft()"><h6 style="color:white;">Draft</h6></button>
        <button class="btn mt-2" type="submit" name="action" value="send"
          style="width: 80px;margin-right: 1vh; background-color: chocolate;" onclick="savesend()"><h6 style="color:white;">Save</h6></button>
        <button class="btn mt-2" style="width: 80px; background-color: chocolate;" type="reset"><h6 style="color:white;">Cancel</h6></button><br><br>
      </div>
              </div>
            </form>
            </div>
            </div>
            </div>
      </div>
      <div class="form-inline " style="margin-bottom: 200px;"></div>                
      <div class="form-inline " style="margin-bottom: 200px;"></div>
      
      
      </div>
              </div>



              <!-- New Item Modal -->
<div class="modal fade" id="newItem">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header px-3" style="background: rgb(32, 35, 37);">
          <h3 class="text-uppercase" style="color: white;">Add New Item</h3>
          <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card px-2 py-4" style="background-color: #000;">
          <form id="newItemForm">
            {% csrf_token %}
            <fieldset class="form-group" >
                  <div class="row mt-3">
                  <hr>
                      <div class="col-12 col-md-10">
                      <label class="col-12 col-md-2 col-form-label pt-3" style="color: aliceblue;">Type  &nbsp;&nbsp;<i class="fa fa-question-circle"></i></label>
                          <div class="form-check form-check-inline">
                              <input required class="form-check-input" type="radio" name="itemType" id="gridRadios1" value="Goods">
                              <label class="form-check-label text-white" for="gridRadios1">Goods</label>
                          </div> &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
                          <div class="form-check form-check-inline ml-md-3">
                              <input required class="form-check-input" type="radio" name="itemType" id="gridRadios2" value="Services">
                              <label class="form-check-label text-white" for="gridRadios2">Services</label>
                          </div>
                      </div>
                  </div>
              </fieldset>
              <div class="form-group row mt-3">
                  <label  class="col-sm-2 col-form-label " style="color: aliceblue;">Name *</label>
                  <div class="col-sm-10 col-md-7 col-9" style="margin-left: -2.2rem;">
                    <input required type="text" class="form-control" name="name" id="nameInput" style="color: aliceblue;" placeholder="Enter Item Name">  
                  </div>
              </div>
              <div class="form-group row mt-3">
                  <label class="col-sm-2 col-form-label" style="color: aliceblue;">Unit <i class="fa fa-question-circle"></i></label>
                  <div class="col-sm-10 col-md-7 col-9" style="margin-left: -2.2rem;">
                      <div class="d-flex align-items-center">
                          <select name="unit" class="form-control bg-black text-white" id="selunit"  >
                            {% for i in units %}
                              <option value={{i.id}}>{{i.unit_name}}</option>
                            {% endfor %}
                          </select>                      
                          <a class="btn btn-outline-warning py-2 ms-1" style="cursor: pointer;" data-toggle="modal" data-target="#unitmodal" style="height: 38px;">+</a>
                      </div>
                  </div>
              </div>

              <div class="form-group row mt-3">
                  <label class="col-sm-2 col-form-label" style="color: aliceblue;">HSN Code</label>
                  <div class="col-sm-10 col-md-7 col-9" style="margin-left: -2.2rem;">
                      <input required type="text" class="form-control" name="hsn" required id="myInputField" style="color: aliceblue;" placeholder="Enter six digit HSN code" oninput="validateInput()">
                      <div id="validationResult"></div>
                  </div>
              </div>
              <fieldset class="form-group mt-3" >
                  <div class="row">
                
                      <div class="col-12 col-md-10">
                        <label class="col-12 col-md-2 col-form-label pt-3" style="color: aliceblue;">Tax Preference: &nbsp;&nbsp;</label>
                          <div class="form-check form-check-inline">
                              <input required class="form-check-input" type="radio" name="radio" id="gridRadios3" onclick="showAllSelect()" value="taxable">
                              <label class="form-check-label text-white" for="gridRadios3">Taxable</label>
                          </div> &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
                          <div class="form-check form-check-inline ml-md-3">
                              <input required class="form-check-input" type="radio" name="radio" id="gridRadios4"  onclick="hideAllSelect()" value="None-Taxable">
                              <label class="form-check-label text-white" for="gridRadios4"> None-Taxable</label>
                          </div>
                      </div>
                  </div>
              </fieldset>

              <div class="row mt-3">
                  <div class="col-md-3">
                      <div id="select1_div" style="display: none;">
                          <label for="select1">Intra-State TAX</label><br> <br>
                          <select name="intra" class="form-control" id="intraStateTax" style="background-color: black; color: white;">
                              <option value="0">GST0[0%]</option>
                              <option value="3">GST3[3%]</option>
                              <option value="5">GST5[5%]</option>
                              <option value="12">GST12[12%]</option>
                              <option value="18">GST18[18%]</option>
                              <option value="28">GST28[28%]</option>
                          </select>
                      </div>
                  </div>
                  <div class="col-md-6">
                      <div id="select2_div" style="display: none;">
                          <label for="select2">Inter-State TAX</label> <br><br>
                          <select name="inter" class="form-control " id="interStateTax" style="background-color: black; color: white;">
                              <option value="0">IGST0[0%]</option>
                              <option value="3">IGST3[3%]</option>
                              <option value="5">IGST5[5%]</option>
                              <option value="12">IGST12[12%]</option>
                              <option value="18">IGST18[18%]]</option>
                              <option value="28">IGST28[28%]</option>
                          </select>
                      </div>
                  </div>
                </div>
              
                <div class="row mt-3">
                  <div class="col-md-6">
                    <input  type="checkbox" name="selling" checked> <label >selling  information</label><br><br>
                    <div class="form-group row mt-3">
                      <label class="col-4 col-form-label" style="color: aliceblue;">Selling price </label>
                      <div class="col-sm-8 col-md-8 col-8">
                        <div class="input-group mb-2">
                          <div class="input-group-prepend">
                            <div class="input-group-text text-white" style="background-color: black;">INR</div>
                          </div>
                          <input required type="text" id="salesprice" name="sel_price" style="color: #ede4e4;" class="form-control">
                        </div>
                      </div>
                    </div>

                    <div class="form-group row mt-3">
                      <label  class="col-4 col-form-label" style="color: aliceblue;">Account *</label>
                      <div class="col-sm-18 col-md-8 col-8">
                        <select name="sel_acc" class="form-control " id="salesAccount" style="background-color: black; color: white;">
                          <option value=" ">--Select Account--</option>
                          <option value="General Income">General Income</option>
                          <option value="Interest Income">Interest Income</option>
                          <option value="Late Fee  Income">Late Fee  Income</option>  
                          <option value="Discount Income">Discount Income</option>
                          <option value="Other Charges">Other Charges</option>
                          <option value="Shipping Charge">Shipping Charge</option>
                      
                        </select>                              
                      </div>
                    </div>
                    <div class="form-group row mt-3">
                      <label  class="col-4 col-form-label" style="color: aliceblue;">Description </label>
                      <div class="col-sm-18 col-md-8 col-8">
                        <input  type="text" id="salesDescription" style="color: #ede4e4;" name="sel_desc" class="form-control " placeholder="Enter Discription">
                      </div>
                    </div>
                                          
                  </div>
                  <div class="col-md-6">
                    <input type="checkbox" name="purchase" checked> <label for="">Purchase information</label><br><br>
                    <div class="form-group row mt-3">
                      <label  class="col-4 col-form-label" style="color: aliceblue;">Cost Price*</label>
                      <div class="col-sm-8 col-md-8 col-8">
                        <div class="input-group mb-2">
                          <div class="input-group-prepend">
                            <div class="input-group-text text-white" style="background-color: black;">INR</div>
                          </div>
                          <input required type="text" id="purprice" style="color: #ede4e4;" class="form-control " name="cost_price" >
                        </div>
                      </div>
                    </div>
                    <div class="form-group row mt-3 in">
            
                      <label class="col-4 col-form-label" style="color: aliceblue;">Account*</label>
                      <div class="col-sm-8 col-md-8 col-8">
                          <div class="d-flex align-items-center">
                              <select name="cost_acc" class="form-control text-white bg-black" id="myaccount" required>
                                <option value="">--Select Account--</option>
                                <optgroup id="expensesel" label="Expense">
                           
                                {% for i in accounts %}
    
                                {% if i.account_type == 'Expense' %}
                              
                                  <option value="{{i.account_name}}">{{i.account_name}}</option>
                          
                                {% endif %}
                                {% endfor %}
                              </optgroup>
                              <optgroup id="costofgoods" label="Cost Of Goods Sold">
                                {% for i in accounts %}
                                {% if i.account_type == 'Cost Of Goods Sold' %}
                          
                                  <option value="{{i.account_name}}">{{i.account_name}}</option>
                                  
                                  {% endif %}
                                  {% endfor %}
                                </optgroup>
                                <optgroup id="otherexpensesel" label="Other Expense">
                                {% for i in accounts %}
                                {% if i.account_type == 'Other Expense' %}
                          
                                  <option value="{{i.account_name}}">{{i.account_name}}</option>
                                  
                                  {% endif %}
                                  {% endfor %}
                                </optgroup>
                    
                               
                            
                              </select>                    
                              <a class="btn btn-outline-warning py-2 ms-1" style="cursor: pointer;" data-toggle="modal" data-target="#newAccount" style="height: 38px;">+</a>
       
                          </div>
                         
                      </div>
                  </div>
                  <div class="form-group mt-3 row in">
                      <label class="col-4 col-form-label" style="color: aliceblue;">Description</label>
                      <div class="col-sm-8 col-md-8 col-8">
                          <div class="d-flex align-items-center">
                              <input  type="text" style="color: #ede4e4;" name="pur_desc" id="purchaseDescription" class="form-control " placeholder="Enter Discription">
                          </div>
                      </div>
                  </div>
                  </div>
              </div>

              <div class="form-group row mt-3">
                  <label class="col-sm-4 col-form-label" style="color: aliceblue;">Minimum Stock to maintain :</label>
                  <div class="col-sm-8 col-md-8 col-8 d-flex align-items-center">
                    <input type="number" style="color: #ede4e4;" id="minStock" name="minimum_stock" class="form-control mx-auto" placeholder="Enter Minimum Stock">
                  </div>
              </div>

              <div class="row mt-3" >
                  <div class="col-md-10">
                    {% comment %} <label style="color: aliceblue;"><input type="checkbox" value="trackstate" name="trackstate" onclick="toggleForm()" style="display: none;">
                   Track Inventory for this item</label> {% endcomment %}
                    <!-- {% comment %} <input type="checkbox" name="trackState" id="trackStateCheckbox">{% endcomment %} -->
                    <label style="color: aliceblue;">
                   
                      <input type="checkbox" name="trackstate" class=" " id="trackInv"  onclick="toggleFormFields()">
                      Track Inventory for this item
                    </label>   <br>   <br>
                    <div id="formFields" style="display: none;"> 
                      <div class="form-group row" >
                        <label class="col-sm-2 col-form-label" style="color: aliceblue;">Inventory Account *</label>
                        <div class="col-sm-10 col-md-7 col-9" style="margin-left: -1rem;">
                          <select class="form-select form-select-sm mt-3 " id="invAcc" name="invacc" style="background-color: black; color: white;">
                            <option value="">Choose..</option>
                            <option value="inventory assets">Inventory Asset</option>
                          </select>
                        </div>
                      </div>
                      <br>
                      <div class="form-group row ">
                        <label class="col-sm-2 col-form-label" style="color: aliceblue;">Opening Stock</label>
                        <div class=" col-md-5">
                          <input  type="number" style="color: #ede4e4;" class="form-control " id="stockOnHand" name="openstock" value="0">
                        </div>
                        </div>
                        <br>
                        <div class="form-group row ">
                            <label class="col-sm-2 col-form-label" style="color: aliceblue;">Opening Stock Rate per Unit</label>
                            <div class=" col-md-5">
                                <input type="number" id="stockRate" style="color: #ede4e4;" class="form-control" name="rate"  value="0">
                            </div>
                            </div>
  
                      </div>
                  </div>
              </div>
          
          </form>
          <div class="row mt-5">
              <div class="col-lg-12 col-md-12 col-sm-12">
              <div class="d-flex justify-content-center">
                  <button class="btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning" type="button" id="saveNewItem">Save</button>
                  <button type="button" class="close btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning close_item_modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Cancel</span></button>
              </div>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>  
</div>




<!-- New Customer Modal -->
<div class="modal fade" id="newCustomer">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header px-3" style="background: rgb(32, 35, 37);">
          <h3 class="text-uppercase" style="color: white;">Add Customer</h3>
          <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card px-2 py-4" style="background-color: #000;">
          <form id="newCustomerForm">
            {% csrf_token %}
            <div class="form-group row mt-3">
              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color: white;">Customer Type</label>
              
              <div class=" col-sm-12 col-md-3 col-lg-3">
                  <input type="radio"  value="Business" name="type" >
                  <label for="Business"> Business</label>
                  &nbsp;&nbsp;&nbsp;
                  <input  type="radio"  value="Individual" name="type" >
                  <label for="Business">Individual</label>
              </div>
            </div>

            <div class=" form-group row">
              <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                  <label class="labels">Primary Contact*</label>
              </div>
              <div class="col-sm-12 col-md-1 col-lg-1" >
                  <select id="select1"  name="salutation" class="form-control bg-light text-dark mt-2 " >
                  
                      <option value="Mr">Mr</option>
                      <option value="Mrs">Mrs</option>
                      <option value="Ms">Ms</option>
                      <option value="Dr">Dr</option>

                  </select> 
              </div>
              <div class="col-sm-12 col-md-2 col-lg-3" >
                  <input  type="text" class="form-control bg-light text-dark mt-2 change-disply " id="fname" name="first_name" placeholder="first name" required >

              </div>
              <div class="col-sm-12 col-md-2 col-lg-3" >
                  <input type="text" class="form-control bg-light text-dark mt-2 " id="lname" name="last_name" placeholder="last name" required >
              </div>
            </div>
            <div class="form-group row mt-4">
              <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label class="labels">Customer Display Name</label></div>
              <div class="col-sm-12 col-md-6 col-lg-7">
                  <select class="form-control bg-light text-dark "  name="v_display_name" id="v_display_name">
                  </select> 
              </div>
          </div>
          <div class="form-group row mt-4">
              <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                  <label class="labels">Company Name</label>
              </div>
              <div class="col-sm-12 col-md-6 col-lg-7">
                  <input  type="text" class="form-control bg-light text-dark " id="companyName" name="company_name" required>     
                  <div class="invalid-feedback">Please fill out this field.</div>   
              </div>
          </div>
          <div class="form-group row mt-4">
              <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label class="labels">Customer Email*</label></div>
              <div class="col-sm-12 col-md-6 col-lg-7">
                  <input  type="email" class="form-control bg-light text-dark" name="vendor_email"  id="vendor-email"  required> 
                  <span class=" text-danger mt-1" id="email-message-id" style="font-size: 10px;"></span>   
              </div>
          </div>

          <div class="form-group row mt-4">
              <div class="col-sm-12 col-md-3 col-lg-3 ">
                  <label class="col-form-label text-white">Customer phone*</label>
              </div>
              <div class="col-sm-12 col-md-3 col-lg-3">
                  <input id="workphone"  type="text" class="form-control bg-light text-dark mt-2" pattern="[0-9]{7}"  name="w_phone" placeholder="work phone" required>
                  <span id="work-phone-message" class="mt-2 " style="font-size: 10px;"></span >
                  <span id="workphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                  <div class="invalid-feedback"></div>   
              </div>
              <div class=" col-sm-12 col-md-3 col-lg-4">
                  <input id="mphone"  type="text" pattern="[0-9]{10}" class="form-control bg-light text-dark mt-2"  name="m_phone" placeholder="mobile number" required>
                  <span id="phone-message" class="mt-2 " style="font-size: 10px;"></span >
                  <span id="mphone_label" class="mt-2 text-danger" style="font-size: 10px;"></span >
                  <div class="invalid-feedback"></div>
              </div>

              <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">

              <div class="toggle1 section-toggle">
                  <a href="">Add More Details</a>
              </div>
            </div>

            <fieldset1 id="more_detail" class="more details" style="display: none;">
              <div class="form-group row mt-4">
                <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                    <label>Skype name/Number</label>
                </div>
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <input  type="text" class="form-control bg-light text-dark" id="skypeNumber" name="skype_number">      
                </div>
              </div>

              <div class="form-group row mt-4">
                  <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                      <label>Designation</label>
                  </div>
                  <div class="col-sm-12 col-md-6 col-lg-6">
                      <input  type="text" id="design" class="form-control bg-light text-dark" name="designation">      
                  </div>
              </div>

              <div class="form-group row mt-4">
                  <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
                      <label>Department</label>
                  </div>
                  <div class="col-sm-12 col-md-6 col-lg-6">
                      <input  type="text" class="form-control bg-light text-dark" id="dept" name="department">      
                  </div>
              </div>
     
              <div class="form-group row mt-4">
                  <div class="col-sm-12 col-md-3 col-lg-3 col-form-label"><label>Website</label></div>
                  <div class="col-sm-12 col-md-6 col-lg-6">
                      <input id="web" type="text" class="form-control bg-light text-dark" onclick="mobile_phone()"    name="website">      
                  </div>
              </div>
            </fieldset1>

            <hr style="border: none; height: 2px; background-color: #ffcc00; margin: 20px 0;">

            <div class="section-3">

                <div class="toggle2 section-toggle"> <a href="" >Other Details </a> </div>
                <div class="toggle3 section-toggle" > <a href="">Address </a> </div>
                <div class="toggle4 section-toggle"><a href="" >Contact Persons </a></div>
                <div class="toggle7 section-toggle"><a href="">Remarks</a></div>

            </div>

            <fieldset2 class="other details">
              <div class="form-group row mt-2">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > GST Treatment*</label>
                  <div class=" col-sm-12 col-md-3 col-lg-3">
                      <select name="gst" id="GSTT" class="form-control bg-light text-dark" onclick="gstPan_function()">
                          <option  value="" selected>Select a Gst Treatment</option>
                          <option class="bg-light text-dark" value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                          <option class="bg-light text-dark" value="Registered Business-Composition Business that is registered under the Composition scheme in GST">
                              Registered Business-Composition Business that is registered under the Composition schemen in GST
                          </option>
                          <option class="bg-light text-dark" value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                          <option class="bg-light text-dark" value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                          <option class="bg-light text-dark" value="Special Economic Zone">Special Economic Zone</option>
                      </select><br>
                  </div>
              </div>

              <fieldset3 id="gst" style="display: none;">
                  <div class="row mt-4">
                      <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white"  > GSTIN/UIN*</label>
                      
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input type="text" class="form-control bg-light text-dark" name="gst_number" id="gstInput" > 
                          <span id="gstMessage"></span>       
                      </div>
                  </div>

              </fieldset3>

              <fieldset4 id="pan" style="display: none;">
                <div class=" row mt-4">
                    <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > PAN*</label>
                    
                    <div class=" col-sm-12 col-md-3 col-lg-3">
                        <input type="text" class="form-control bg-light text-dark"  id="panInput"  name="pan_number">  
                        <span id="panMessage"></span>    
                    </div>
                </div>
              </fieldset4>


              <div class="form-group row mt-4">
                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Source of Supply*</label>
                <div class=" col-sm-12 col-md-3 col-lg-3">
                    <select name="source_supply" id="PLACE" class="form-control bg-light text-dark">
                        <option class="bg-light text-dark" value="value" selected></option>
                        <option class="bg-light text-dark" value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option>
                        <option class="bg-light text-dark" value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                        <option class="bg-light text-dark" value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> 
                        <option class="bg-light text-dark" value="volvo">[AS]-Assam</option>
                        <option class="bg-light text-dark" value="[BR]-Bihar">[BR]-Bihar</option> 
                        <option class="bg-light text-dark" value="volvo">[CH]-	Chandhigarh</option>
                        <option class="bg-light text-dark" value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                        <option class="bg-light text-dark" value="[DD]-Daman Diu">[DD]-Daman Diu</option>
                        <option class="bg-light text-dark" value="volvo">[DL]-	Delhi</option>
                        <option class="bg-light text-dark" value="[GA]-Goa">[GA]-Goa</option> 
                        <option class="bg-light text-dark" value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                        <option class="bg-light text-dark" value="[HR]-Haryana">[HR]-Haryana</option> 
                        <option class="bg-light text-dark" value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                        <option class="bg-light text-dark" value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option>
                        <option class="bg-light text-dark" value="[JH]-Jharkand">[JH]-Jharkand</option>
                        <option class="bg-light text-dark" value="[KA]-Karnataka">[KA]-Karnataka</option>
                        <option class="bg-light text-dark" value="[KL]-Kerala">[KL]-Kerala</option>
                        <option class="bg-light text-dark" value="[LA]-Ladakh">[LA]-Ladakh</option>
                        <option class="bg-light text-dark" value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                        <option class="bg-light text-dark" value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                        <option class="bg-light text-dark" value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                        <option class="bg-light text-dark" value="[MN]-Manipur">[MN]-Manipur</option>  
                        <option class="bg-light text-dark" value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                        <option class="bg-light text-dark" value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                        <option class="bg-light text-dark" value="[NL]-Nagaland">[NL]-Nagaland</option> 
                        <option class="bg-light text-dark" value="[NL]-Nagaland">[NL]-Nagaland</option>
                        <option class="bg-light text-dark" value="[OD]-Odisha">[OD]-Odisha</option>
                        <option class="bg-light text-dark" value="[PY]-Puducherry">[PY]-Puducherry</option>
                        <option class="bg-light text-dark" value="[PB]-Punjab">[PB]-Punjab.</option>
                        <option class="bg-light text-dark" value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                        <option class="bg-light text-dark" value="[SK]-Sikkim">[SK]-Sikkim</option>
                        <option class="bg-light text-dark" value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                        <option class="bg-light text-dark" value="[TS]-Telenghana">[TS]-Telenghana</option>
                        <option class="bg-light text-dark" value="[TR]-Tripura">[TR]-Tripura</option>
                        <option class="bg-light text-dark" value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                        <option class="bg-light text-dark" value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                        <option class="bg-light text-dark" value="[WB]-West Bengal">[WB]-West Bengal</option>
                        <option class="bg-light text-dark" value="[OT]-Other Territory">[OT]-Other Territory</option>
                    </select>
                </div>
              </div>

              <div class="form-group row mt-4">
                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:rgb(214, 75, 75) ;">Tax Preference*</label>
                  
                <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                  <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="tax1" id="Taxable" value="Taxable" required>
                      <label class="form-check-label text-white" for="vehicle1">Taxable</label>
                  </div>
                  <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="tax1" id="Tax_Exempt" value="Tax Exempt" required>
                      <label class="form-check-label text-white" for="vehicle2">Tax Exempt</label>
                  </div>
                </div>
              </div>
              
              <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Currency</label>
                  
                  <div class=" col-sm-12 col-md-3 col-lg-3">
                      <select name="currency" id="crncy" class="form-control bg-light text-dark">
                          <option value="Indian Rupee" selected>Indian Rupee</option>
                      </select>
                  </div>
              </div>

              <div class="form-group row mt-2">
                <div class="col-sm-12 col-md-3 col-lg-3 ">
                    <label class="col-form-label text-white mb-3"> Opening Balance Type</label>
                </div>
                <div class="col-sm-12 col-md-3 col-lg-4 d-flex align-items-center">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="op_type" id="debit" value="debit">
                        <label class="form-check-label text-white" for="debit">Debit</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="op_type" id="credit" value="credit">
                        <label class="form-check-label text-white" for="credit">Credit</label>
                    </div>
                </div>
              </div>

              <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Opening Balance Amount</label>                    
                  <div class=" col-sm-12 col-md-3 col-lg-3">
                      <input  type="number" class="form-control bg-light text-dark" name="opening_bal" id="opa" value="0.00">      
                  </div>
              </div>

              <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" >Credit Limit</label>                    
                  <div class=" col-sm-12 col-md-3 col-lg-3">
                      <input  type="number" class="form-control bg-light text-dark" name="credit_lm" id="cl" value="0.00">      
                  </div>
              </div>
          
              <div id="custom-alert" class="customalert">
                  <span class="close-btn">&times;</span>
                  <div class="custom-alert-content">
                    Credit limit should not exceed opening balance amount.
                  </div>
              </div>
                <style>
                  .customalert {
                          display: none;
                          position: fixed;
                          top: 30%;
                          left: 50%;
                          transform: translate(-50%, -50%);
                          background-color: #f44336;
                          color: white;
                          padding: 15px;
                          border-radius: 5px;
                          }

                          .close-btn {
                          float: right;
                          cursor: pointer;
                          }

                          .custom-alert-content {
                          margin-bottom: 10px;
                          }
                </style>
              <div class="form-group row mt-4">
                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Payment Terms</label>
                
                <div class=" col-sm-12 col-md-3 col-lg-3">
                    <select name="payment_terms" id="paytearm-select" class="form-control bg-light text-dark">
                        {% for pay_terms in pTerms %}
                        <option class="form-control bg-light text-dark" value="{{pay_terms.id}}" >{{pay_terms.term_name}}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 ">
                    <a href="#" class="btn btn-outline-warning py-2 my-1" data-target="#newpayment" data-toggle="modal">+</a>
                </div>
              </div>

              <div class="form-group row mt-4">
                <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white">Price List </label>
                  
                <div class=" col-sm-12 col-md-3 col-lg-3">
                    <select name="plst" id="priceLs" class="form-control bg-light text-dark">
                        <option value="0">Not selected</option>
                        {% for price_list in priceListItems %}
                        <option value="{{price_list.id}}">{{price_list.name}}</option>    
                        {% endfor %}
                    </select>
                </div>
              </div>
           
              <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">
                      Portal Language</label>
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <select name="plang" id="plang" style="width: 100%;" class="form-control bg-light text-dark">
                              <option selected value="0" >Choose..</option>
                              <option class="bg-light text-dark" value="ENGLISH">ENGLISH</option>
                            </select>
                  </div>
              </div>   
              <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">Facebook </label>
                    <div class=" col-sm-12 col-md-3 col-lg-3"> 
                      <input type="text" id="fbk" name="fbk" class="form-control bg-light text-dark" >    
                  </div>
              </div>
              <div class="form-group row mt-4">
                  <label class="col-sm-12 col-md-3 col-lg-3 col-form-label" style="color:white ;">Twitter</label>
                      <div class=" col-sm-12 col-md-3 col-lg-3">
                          <input type="text" id="twtr" name="twtr" class="form-control bg-light text-dark" >
                        
                  </div>
              </div>
            </fieldset2>

            <fieldset5 id="address" style="display: none;">
              <div>
                  <div class="row">
                      <div class="col-sm-12 col-md-6 col-lg-6">
                          <div class="row">
                              <div class="col-sm-12 col-md-6 col-lg-6">
                                  <label for="">BILLING ADDRESS</label>
                              </div>
                              <div class="col"></div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="text" class="form-control bg-light text-dark" name="battention" id="batten">      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <select name="bcountry" id="btry" class="form-control bg-light text-dark">
                                      <option value="India" selected>India</option>
                                  </select>      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <textarea class="form-control bg-light " style="border: none;color: rgb(7, 7, 7);" cols="26" rows="4" name="baddress" id="badd1"></textarea>
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="text" class="form-control bg-light text-dark" name="bcity" id="bcty">      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input type="text" class="form-control bg-light text-dark" name="bstate" id="bste">      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="number" class="form-control bg-light text-dark" name="bzip" id="bzp">      
                              </div>
                          </div>
                      
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input id="bphone_num"  type="tel" pattern="[0-9]{10}" class="form-control bg-light text-dark" name="bphone" >
                                  <label for="" id="bphone_label"></label>      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" onmouseout="fax_number()"  onclick="bphone_number()" name="bfax" id="bfx">  
                              
                                  <label for="" id="fax_label"></label> 
                              </div>
                          </div>

                      </div>
                      <div class="col-sm-12 col-md-6 col-lg-6">
                          <div class="row">
                              <div class="col-sm-12 col-md-6 col-lg-6">
                                  <label for="">SHIPPING ADDRESS</label>
                              </div>
                              <div class="col-sm-12 col-md-6 col-lg-6">
                                  <input  type="checkbox" id="myCheckT" onclick="myCopyAddressFunction()">&nbsp;
                                  <label for="myCheck">Same as Billing Address:</label>
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Attention</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="text" class="form-control bg-light text-dark " style="color: white;" name="sattention" id="satten">      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Country</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <select name="s_country" id="sctry" class="form-control bg-light text-dark">
                                      <option value="India" selected>India</option>
                                  </select>      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Address</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <textarea class="form-control bg-light" style="border: none;color: rgb(10, 10, 10);" id="sadd1" cols="26" rows="4" name="saddress"></textarea>
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > City</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="text" class="form-control bg-light text-dark" name="scity" id="scty">      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > State</label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input type="text" class="form-control bg-light text-dark" name="sstate" id="sste">      
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Zip Code </label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="number" class="form-control bg-light text-dark" name="szip" id="szp">      
                              </div>
                          </div>
                      

                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Phone </label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{10}" style="color: white;" name="sphone" id="sphone_num">  
                                  <label for="" id="sphone_label"></label>    
                              </div>
                          </div>
                          <div class="form-group row mt-4">
                              <label class="col-sm-12 col-md-3 col-lg-3 col-form-label text-white" > Fax </label>                    
                              <div class=" col-sm-12 col-md-6 col-lg-6">
                                  <input  type="tel" class="form-control bg-light text-dark" pattern="[0-9]{7}" style="color: white;" name="sfax" onclick="sphone_number()" onmouseout="sfax_number()" id="sfx"> 
                                  <label for="" id="sfax_label"></label>     
                              </div>
                          </div>

                      </div>
                  </div>
              </div>
            </fieldset5>

            <fieldset6 id="contact_person" style="display: none;" >
              <div class="row">
                  <div class="col-sm-12 ">
                      
                      <div class="table-responsive">
                      
                          <table id="tbl" class="table text-white" style="background-color: rgba(250, 227, 198, 0.5);">
                              <thead>
                                  <tr>
                                      
                                  <th>Salutation</th>
                                  <th>First Name</th>
                                  <th>Last Name</th>
                                  <th>Email Address</th>
                                  <th >Work Phone <br><span id="twph_label"></span></th>
                                  <th >Mobile <br><span id="tlabel"></span>    </th>
                                  <th >Skype Name/No</th>
                                  <th >Designation</th>
                                  <th >Department</th>
                                  <th>Action</th>

                              </tr>
                          </thead>
                          <tbody>
                              <tr>
                              <td><select name="salutation[]" class="salutation form-control bg-transparent border-1 text-white" >
                                <option value="" class="text-dark">Select</option>
                                  <option class="text-dark" value="Mr">Mr.</option>
                                  <option class="text-dark" value="Mrs">Mrs.</option>
                                  <option class="text-dark" value="Ms">Ms.</option>
                                  <option class="text-dark" value="Miss">Miss.</option>
                                  <option class="text-dark" value="Dr">Dr.</option>
                                  </select></td>
                              <td><input type="text" class="first_name form-control border-1 bg-transparent text-white"    name="first_name[]"  ></td>
                              <td><input type="text"class="last_name form-control border-1 bg-transparent text-white"  name="last_name[]" /></td>
                              <td>
                                  <input type="text" class="email form-control border-1 bg-transparent text-white" name="email[]" />
                                  
                                  
                              </td>
                              
                              <td>
                                  <input type="tel" pattern="[0-9]{7}" class="work_phone form-control border-1 bg-transparent text-white"  id="twphone" name="wphone[]"/>
                                 
                              </td>
                              <td>
                                  <input type="tel" pattern="[0-9]{10}"  class="mobile_phone form-control border-1 bg-transparent text-white"  id="tmobile" onclick="sample1()"   name="mobile[]" />
                                  
                              </td>
                              <td><input type="number" class="skype_number form-control border-1 bg-transparent text-white"  onclick="sample()" name="skype[]" /></td>
                              <td><input type="text" class="designation form-control border-1 bg-transparent text-white"  name="designation[]" /></td>
                              <td><input type="text" class="department form-control border-1 bg-transparent text-white"  name="department[]" /></td>
                              <td><button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button></td>
                              </tr>
                          </tbody>
                          </table>
                          
                      </div>
                      
                      <div class="button add_another mt-3 ">
                          <i class="fa fa-user-plus" aria-hidden="true"></i> 
                          <span class="text-small" style="margin-left: 0.30rem;">
                              Add Contact Person
                          </span>
                      </div>
                         
                      
                  </div>
                  
              </div>

            </fieldset6>

            <!---------------------Contact Person Section End -------------->


            <!------------------ Remark Section Start------------- -->

            <fieldset7 class="remarks" style="display: none;">
                <div class="row">
                    <div class="col-sm-12 col-md-8 col-lg-8">
                        <div class="form-group row mt-4">
                            <div class=" col-sm-12 col-md-6 col-lg-6">
                                <textarea class="bg-light w-100" style="border: none;color: rgb(5, 5, 5);" id="rmrk"  rows="5" name="remark"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-2 col-lg-2"></div>
                </div>

            </fieldset7>
          
          
        </form>
        <div class="row mt-5">
          <div class="col-lg-12 col-md-12 col-sm-12">
            <div class="d-flex justify-content-center">
              <button class="btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning" type="button" id="newCustomerSave">Save</button>
              <button type="button" class="close btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning close_customer_modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Cancel</span></button>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>  
</div>


<!-- New Customer Payment Term -->
<div class="modal fade" id="newpayment">
  <div class="modal-dialog modal-md">
  <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase" style="color: white;">Add Payment Term</h3>
          <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
      <div class="card p-3 m-3" style="background-color: #141414a2;">
          <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalPayment_terms">
          


          <div class="row mt-2">

              <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                  <label for="termname" style="color: white">Term Name *</label>

              <input type="text " class="form-control text-dark bg-light mt-2" id="tname" name="term_name" autocapitalize="characters" required> 
              <span id="message-id" class="mt-1 text-danger" style="font-size: 10px;"></span> 
              <span id="success-message-id" class=" mt-1 text-success" style="font-size: 10px;"></span>    
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                  <label for="termdays" style="color: white">Number of Days *</label>

              <input type="number" class="form-control text-dark bg-light mt-2" id="tdays" name="term_days" autocapitalize="characters" required>
              </div>
              <div class="col-md-2 mt-2"></div>

          </div>
          
          <div class="row mt-5">
              <div class="col-lg-12 col-md-12 col-sm-12">
              <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning "
                  type="submit" data-dismiss="modal" id="customerPaymentTermSave">Save
                  </button> 
                  

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-1 mx-1 btn-outline-warning" 
                  data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
              </div>
              </div>
          </div>
          </form>
      </div>
      </div>
  </div>
  </div>  
</div>
<!-- New Unit Modal-->     

<div class="modal fade" id="unitmodal">
  <div class="modal-dialog">
      <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header" style="background: rgb(32, 35, 37);">
          <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #eeeaea;">Add Unit</h5>
          <button type="button" class="close btn btn-danger" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
          <div class="card p-3 m-3" style="background-color: #000;">
          
              <div id="error-message-container" style="color: chocolate;"></div>
                  <form class="needs-validation" novalidate autocomplete="off" id="unitform">
                      {% csrf_token %}
                      <label class="text-dark" for="unit"><b>Unit Name</b></label>
                      <input type="text" class="form-control text-white"  placeholder="Enter unit" id="unitName" name="unit_name" required>
                      <p class="text-white">eg:KL,PCS,BOX,LTR</p>

                      <div class="row mt-5">
                          <div class="col-lg-12 col-md-12 col-sm-12">
                          <div class="d-flex justify-content-center">
                              <button class="btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning" type="button" id="newUnitSave">Save</button>
                              <button type="button" class="close btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning close_unit_modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Cancel</span></button>
                          </div>
                          </div>
                      </div>
                  </form>
              </div>
          </div>
      </div>
  </div>
</div>


<!-- New Account Modal -->

<div class="modal fade" id="newAccount">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header" style="background: rgb(32, 35, 37);">
        <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #eeeaea;"><b>New Account</b></h5>
        <button type="button" class="close" style="width: 30px;" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3" style="background-color: #000;">
        
         
            <form method="post"  style="color: #000000;" id="newAccountForm">
              {% csrf_token %}
              {% for m in messages %}
              <p style="color: chocolate;">{{m}}</p>
              {% endfor %}
                <div class="d-flex align-items-center">
                    <h5 style="font-size: 25px;color: aliceblue;">Create Account</h5>
                  
                </div>
                <div id="error-message-container2" style="color: chocolate;"></div>
                <hr>
                <div class="row ">
                    <div class="col">
                        <div class="row">
                            <div class="col-sm-4">
                                <label for="">Account Type:</label>
                            </div>
                            <div class="col-sm-8">
                                <div class="select-box1" onclick="message()">
                                    <div class="select-option1">
                                        <input type="text" placeholder="select" style="width: 100%;"  id="soValue1" name="account_type"readonly>
                                    </div>
                                    <div class="content1" id="myDropdown1">
                                        <div class="search1">
                                            <input type="text" placeholder="search" id="myInput1" onkeyup="filterFunction1()">
                                        </div>
                                        <ul class="options1" style="color: #000000;">
                                            <div class="opt" style="color: #000000;">
                                                <span style="font-weight: bold;color: #000;">Assets</span>
                                                <li style="color: #000000;">Other Assets</li>
                                                <li>Other Current Assets</li>
                                                <li>Cash</li>
                                                <li>Bank</li>
                                                <li>Fixed Asset</li>
                                                <li>Stock</li>
                                                <li>Payment Clearing</li>
                                            </div>
        
                                            <div class="opt">
                                                <span style="font-weight: bold;color: #000;">Liability</span>
                                                <li>Other Liability</li>
                                                <li>Other Current Liability</li>
                                                <li>Credit Card</li>
                                                <li>Long Term Liability</li>
                                                <li>Overseas Tax Payable</li>
                                            </div>
        
                                            <div class="opt">
                                                <span style="font-weight: bold;color: #000;">Equity</span>
                                                <li>Equity</li>
                                            </div>
        
                                            <div class="opt">
                                                <span style="font-weight: bold;color: #000;">Income</span>
                                                <li>Income</li>
                                                <li>Other Income</li>
                                            </div>
        
                                            <div class="opt">
                                                <span style="font-weight: bold;color: #000;">Expense</span>
                                                <li>Expense</li>
                                                <li>Cost Of Goods Sold</li>
                                                <li>Other Expense</li>
                                            </div>
                                        </ul>
        
        
        
                                    </div>
                                </div>
        
                            </div>
        
                            <script>
                                const selectBox1 = document.querySelector('.select-box1');
                                const selectOption1 = document.querySelector('.select-option1');
                                const optionsList1 = document.querySelectorAll('.options1 li');
                                const soValue1 = document.querySelector('#soValue1');
        
                                selectOption1.addEventListener('click', function () {
                                    selectBox1.classList.toggle('active')
                                })
        
                                optionsList1.forEach(function (optionsListSingle) {
                                    optionsListSingle.addEventListener('click', function () {
                                        text = this.textContent;
                                        soValue1.value = text;
                                        selectBox1.classList.remove('active')
        
                                    })
                                })
                            </script>
                        </div>
                        <div id="name" style="display: block;">
                            <div class="row mt-3">
                                <div class="col-sm-4">
                                    <label for="">Account Name:</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control text-dark bg-light" name="account_name"
                                        id="account_name" style="width: 100%;" required>
                                </div>
                            </div>
                        </div>
        
                        <div id="credit" style="display: none;">
                            <div class="row mt-3">
                                <div class="col-sm-4">
                                    <label for="">Credit Card Name:</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control text-dark bg-light" style="width: 70%;" name="credit_number"
                                        id="credit_number">
                                </div>
                            </div>
                        </div>
        
                        <div id="sub_div" style="display: none;">

                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                      
                              <div class="col-sm-8">
                      
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent()"
                                      name="sub_account" id="sub_account">
                      
                                  <label for="">Make this a sub-account</label>
                      
                              </div>
                          </div>
                      </div>

                      <div id="sub_div22" style="display: none;">

                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                      
                              <div class="col-sm-8">
                      
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent22()"
                                      name="sub_account22" id="sub_account22">
                      
                                  <label for="">Make this a sub-account</label>
                      
                              </div>
                          </div>
                      </div>
                      
                      <div id="sub_div33" style="display: none;">
                      
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                      
                              <div class="col-sm-8">
                      
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent33()"
                                      name="sub_account33" id="sub_account33">
                      
                                  <label for="">Make this a sub-account</label>
                      
                              </div>
                          </div>
                      </div>
                      
                      <div id="sub_div44" style="display: none;">
                      
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                      
                              <div class="col-sm-8">
                      
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent44()"
                                      name="sub_account44" id="sub_account44">
                      
                                  <label for="">Make this a sub-account</label>
                      
                              </div>
                          </div>
                      </div>
                      
                      <div id="sub_div55" style="display: none;">
                      
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                      
                              <div class="col-sm-8">
                      
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent55()"
                                      name="sub_account55" id="sub_account55">
                      
                                  <label for="">Make this a sub-account</label>
                      
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="sub_div66" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                              <div class="col-sm-8">
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent66()"
                                      name="sub_account66" id="sub_account66">
                                  <label for="">Make this a sub-account</label>
                              </div>
                          </div>
                      </div>
                      
                      
                      
                      <div id="sub_div77" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                              <div class="col-sm-8">
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent77()"
                                      name="sub_account77" id="sub_account77">
                                  <label for="">Make this a sub-account</label>
                              </div>
                          </div>
                      </div>
                      
                      
                      
                      <div id="sub_div88" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                              <div class="col-sm-8">
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent88()"
                                      name="sub_account88" id="sub_account88">
                                  <label for="">Make this a sub-account</label>
                              </div>
                          </div>
                      </div>
                      
                      <div id="sub_div99" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                              <div class="col-sm-8">
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent99()"
                                      name="sub_account99" id="sub_account99">
                                  <label for="">Make this a sub-account</label>
                              </div>
                          </div>
                      </div>
                      
                      <div id="sub_div100" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                              <div class="col-sm-8">
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent100()"
                                      name="sub_account100" id="sub_account100">
                                  <label for="">Make this a sub-account</label>
                              </div>
                          </div>
                      </div>
                      
                      <div id="sub_div111" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                              <div class="col-sm-8">
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent111()"
                                      name="sub_account111" id="sub_account111">
                                  <label for="">Make this a sub-account</label>
                              </div>
                          </div>
                      </div>
                      
                      <div id="sub_div222" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for=""></label>
                              </div>
                              <div class="col-sm-8">
                                  <input type="checkbox" class=" text-dark bg-light" onclick="show_parent222()"
                                      name="sub_account222" id="sub_account222">
                                  <label for="">Make this a sub-account</label>
                              </div>
                          </div>
                      </div>


                      <div id="parent_div" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account" id="parent_account">
                                      <option value="" class="bg-dark text-light text-center"  disabled>Other Current
                                          Assets
                                      </option>
                                      <option value="" selected></option>
                                      <option value="Advance Tax">Advance Tax</option>
                                      <option value="Employee Advance">Employee Advance</option>
                                      <option value="Prepaid Expenses">Prepaid Expenses</option>
                                      <option value="GST TCS Receivable">GST TCS Receivable</option>
                                      <option value="GST TDS Receivable">GST TCS Receivable</option>
                                      <option value="Input Tax Credits">Input Tax Credits</option>
                                      <option value="Input CGST">&nbsp; &nbsp;&nbsp;Input CGST</option>
                                      <option value="Input IGST"> &nbsp; &nbsp;&nbsp;Input IGST</option>
                                      <option value="Input SGST">&nbsp; &nbsp;&nbsp;Input SGST</option>
                      
                      
                                      <option value="Reverse Charge Tax Input but no due">Reverse Charge Tax Input but no
                                          due
                                      </option>
                                      <option value="Sales to Customers(Cash)">Sales to Customers(Cash)</option>
                      
                      
                                      <option value="TDS Receivable">TDS Receivable</option>
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="parent_div22" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account22"
                                      id="parent_account22">
                                      <option value="" class="bg-dark text-light text-center" disabled>Cash</option>
                                      <option value="" class="bg-dark text-light text-center" selected></option>
                      
                                      <option value="Petty Cash">Petty Cash</option>
                                      <option value="Undeposited Fund">Undeposited Fund</option>
                                      <option value="Cash Account">Cash Account</option>
                      
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      <div id="parent_div33" style="display:none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account33"
                                      id="parent_account33">
                                      <option value="" class="bg-dark text-light text-center" disabled>Fixed Asset
                                      </option>
                                      <option value="" class="bg-dark text-light text-center" selected></option>
                      
                                      <option value="Furniture and Equipment">Furniture and Equipment</option>
                      
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      
                      <div id="parent_div44" style="display:none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account44"
                                      id="parent_account44">
                                      <option value="" class="bg-dark text-light text-center" disabled>Stock</option>
                                      <option value="" class="bg-dark text-light text-center" selected></option>
                      
                                      <option value="Inventory Asset">Inventory Asset</option>
                      
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="parent_div55" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account55"
                                      id="parent_account55">
                                      <option value="" class="bg-dark text-light text-center" disabled>Other Current
                                          Liability
                                      </option>
                                      <option value="" class="bg-dark text-light text-center" selected></option>
                      
                                      <option value="Employee Reimbursements">Employee Reimbursements</option>
                                      <option value="Opening Balance Adjustments">Opening Balance Adjustments</option>
                                      <option value="Tax Payable">Tax Payable</option>
                                      <option value="Unearned Revenue">Unearned Revenue</option>
                                      <option value="GST Payable">GST Payable</option>
                                      <option value="Output CGST">&nbsp;&nbsp;&nbsp;Output CGST</option>
                                      <option value="Output IGST">&nbsp;&nbsp;&nbsp;Output IGST</option>
                                      <option value="Output SGST">&nbsp;&nbsp;&nbsp;Output SGST</option>
                                      <option value="TDS Payable">TDS Payable</option>
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="parent_div66" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account66"
                                      id="parent_account66">
                                      <option value="" class="bg-dark text-light text-center" disabled>Long Term Liability
                                      </option>
                                      <option value="" selected></option>
                                      <option value="Construction Loans">Construction Loans</option>
                                      <option value="Mortgages">Mortgages</option>
                      
                      
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="parent_div77" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account77"
                                      id="parent_account77">
                                      <option value="" class="bg-dark text-light text-center" disabled>Other Liability
                                      </option>
                                      <option value="" selected></option>
                                      <option value="Tag Adjustments">Tag Adjustments</option>
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="parent_div88" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account88"
                                      id="parent_account88">
                                      <option value="" class="bg-dark text-light text-center" disabled>Equity</option>
                                      <option value="" selected></option>
                                      <option value="Drawings">Drawings</option>
                                      <option value="Opening Balance Offset">Opening Balance Offset</option>
                                      <option value="Owner's Equity">Owner's Equity</option>
                                      <option value="Retained Earnings">Retained Earnings</option>
                                      <option value="Capital Stock">Capital Stock</option>
                                      <option value="Distributions">Distributions</option>
                                      <option value="Dividends Paid">Dividends Paid</option>
                                      <option value="Investments">Investments</option>
                      
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="parent_div99" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account99"
                                      id="parent_account99">
                                      <option value="" class="bg-dark text-light text-center" disabled>Income</option>
                                      <option value="" selected></option>
                                      <option value="Discount">Discount</option>
                                      <option value="General Income">General Income</option>
                                      <option value="Interest Income">Interest Income</option>
                                      <option value="Late Fee Income">Late Fee Income</option>
                                      <option value="Other Charges">Other Charges</option>
                                      <option value="sales">sales</option>
                                      <option value="Shipping Charge">Shipping Charge</option>
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      
                      <div id="parent_div100" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account100"
                                      id="parent_account100">
                                      <option value="" class="bg-dark text-light text-center" disabled>Expense</option>
                                      <option value="" selected></option>
                                      <option value="Discount">Discount</option>
                                      <option value="Advertising and Marketing">Advertising and Marketing</option>
                                      <option value="Automobile Expense">Automobile Expense</option>
                                      <option value="Bad Debt">Bad Debt</option>
                                      <option value="Bank Fees and Charges">Bank Fees and Charges</option>
                                      <option value="Consultant Expense">Consultant Expense</option>
                                      <option value="Credit Card Charges">Credit Card Charges</option>
                                      <option value="Depreciation Expense">Depreciation Expense</option>
                                      <option value="IT and Internet Expenses">IT and Internet Expenses</option>
                                      <option value="Ganitorial Expense">Ganitorial Expense</option>
                                      <option value="Lodging">Lodging</option>
                                      <option value="Meals and Entertainment">Meals and Entertainment</option>
                                      <option value="Office Supplies">Office Supplies</option>
                                      <option value="Other Expenses">Other Expenses</option>
                                      <option value="Postage">Postage</option>
                                      <option value="Printing and Stationery">Printing and Stationery</option>
                                      <option value="Rent Expense">Rent Expense</option>
                                      <option value="Repairs and Maintenance">Repairs and Maintenance</option>
                                      <option value="Salaries and Employee Wages">Salaries and Employee Wages</option>
                                      <option value="Telephone Expense">Telephone Expense</option>
                                      <option value="Travel Expense">Travel Expense</option>
                                      <option value="Uncategorized">Uncategorized</option>
                                      <option value="Contract Assets">Contract Assets</option>
                                      <option value="Depreciation And Amortisation">Depreciation And Amortisation</option>
                                      <option value="Merchandise">Merchandise</option>
                                      <option value="Raw Materials And Consumables">Raw Materials And Consumables</option>
                                      <option value="Transportation Expense">Uncategorized</option>
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      
                      <div id="parent_div111" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account111"
                                      id="parent_account111">
                                      <option value="" class="bg-dark text-light text-center" disabled>Cost Of Goods Sold
                                      </option>
                                      <option value="" selected></option>
                                      <option value="Cost Of Goods Sold">Cost Of Goods Sold</option>
                                      <option value="Job Costing">Job Costing</option>
                                      <option value="Labor">Labor</option>
                                      <option value="Materials">Materials</option>
                                      <option value="Subcontractor">Subcontractor</option>
                      
                                  </select>
                              </div>
                          </div>
                      </div>
                      
                      
                      <div id="parent_div222" style="display: none;">
                          <div class="row mt-3">
                              <div class="col-sm-4">
                                  <label for="">Parent Account:</label>
                              </div>
                              <div class="col-sm-8">
                      
                                  <select class="form-control text-dark bg-light" style="width: 70%;" name="parent_account222"
                                      id="parent_account222">
                                      <option value="" class="bg-dark text-light text-center" disabled>Other Expense
                                      </option>
                                      <option value="" selected></option>
                                      <option value="Cost Of Goods Sold">Exchange Gain or Loss</option>
                      
                                  </select>
                              </div>
                          </div>
                      </div>
        
        
        
                        <div class="row mt-3">
                            <div class="col-sm-4">
                                <label for="">Account Code:</label>
                            </div>
                            <div class="col-sm-8">
                                <input type="text" class="form-control text-dark bg-light" name="account_code"
                                    id="account_code" style="width: 100%;">
                            </div>
                        </div>
                        <div style="display: none;" id="acc_bo_div">
                            <div class="row mt-3">
                                <div class="col-sm-4">
                                    <label for="">Account Number:</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control text-dark bg-light" name="account_number"
                                        id="account_number" style="width: 100%;">
                                </div>
                            </div>
                        </div>
        
                        <div style="display: none;" id="cr_div">
                            <div class="row mt-3">
                                <div class="col-sm-4">
                                    <label for="">Currency:</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control text-dark bg-light" name="currency" id="currency" style="width: 100%;">
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-sm-4">
                                <label for="">Description:</label>
                            </div>
                            <div class="col-sm-8">
                                <textarea name="description" class="form-control text-dark bg-light" id="description"
                                    placeholder="Max. 500 characters" style="width: 100%;"></textarea>
                            </div>
                        </div>
        
                    </div>
        
                    <div class="col-sm">
                        <div class="alert alert-warning alert-dismissible fade show" style="width: 50%;" >
                            <span id="message_hd" style="color: #000000;">Assets</span> <br>
                            <span id="message" style="color: #000000;">Track special assets like goodwill and other intangible assets</span>
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    </div>
                </div>
                <div class="row mt-5">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                  <div class="d-flex justify-content-center">
                      <button class="btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning" type="button" id="newAccountSave">Save</button>
                      <button type="button" class="close btn save_btn rounded-pill text-grey w-25 my-1 mx-1 btn-outline-warning close_account_modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Cancel</span></button>
                  </div>
                  </div>
              </div>
      </div>
    </div>
  </div>
</div>
</div>


              <script>
               function getCustomerDetails(customerId) {
    $.ajax({
        url: "{% url 'get_customer_details' %}",
        type: "POST",
        data: {
            csrfmiddlewaretoken: "{{ csrf_token }}",
            customer_id: customerId
        },
        dataType: "json",
        success: function(response) {
            $('#cx_mail').val(response.customer_email);
            $('#customer_gst_treat').val(response.gst_treatment);
            $('#customer_gstno').val(response.gstin);
            $('#cus_place1').val(response.place_of_supply);

            // Check if Billing Address exists in the response
            if (response.customer_address) {
                $('#address_row').show();  // Show the Billing Address row
                $('#customer_address').val(response.customer_address);
            } else {
                $('#address_row').hide();  // Hide the Billing Address row
            }
            
            $('#customer_id').val(customerId);
            // Update other fields as needed
        },
        error: function(xhr, errmsg, err) {
            console.log(xhr.status + ": " + xhr.responseText);
            // Handle error if necessary
        }
    });
}

                </script>
                <script>  document.getElementById('dateField').valueAsDate = new Date();</script>
          
                <script>
                    
                  function itemfunction(id_str) {
                        console.log("itemfunction called"); // Add this line for debugging
                        var id = id_str.split("item")[1];
                        var select = $(`#item${id}`).val();
                        console.log("Selected item ID: " + select);

                        // Check if a selection has been made
                        if (select) {
                            // Check if the item is already selected in any previous row
                            var isAlreadySelected = false;
                            $('.item_select').each(function() {
                                if ($(this).val() == select && $(this).attr('id') != `item${id}`) {
                                    isAlreadySelected = true;
                                    return false; // Exit the loop early if a match is found
                                }
                            });

                            if (isAlreadySelected) {
                                // Display alert or any other feedback to the user
                                alert("This item has already been selected in a previous row. Please choose a different item.");
                                // Reset the dropdown to its initial state
                                $(`#item${id}`).val('');
                                return;
                            }
                        }







                        $.ajax({
                            type: "GET",
                            url: "{% url 'itemdata_ri' %}",
                            data: { id: select },
                            success: function(response) {
                                console.log(response);
                                var rate = response.rate;
                                var hsn = response.hsn;
                                console.log("Retrieved rate: " + rate);
                                console.log("Retrieved HSN: " + hsn);
                                // Update rate field
                                $("#rate" + id).val(rate);
                                $("#hsn" + id).val(hsn); 
                            },
                            error: function(xhr, status, error) {
                                console.error("Error fetching rate:", error);
                            }
                        });
                    }

                
                </script>
          
          <script>
            // Counter variable to track the number of item rows
            var itemCounter = 1;
          
            // Function to update index numbers for item rows
            


            function updateIndexNumbers() {
                $(".item-row").each(function (index) {
                    $(this).find(".index-number").text(index + 1);
                });
            }

            $(document).on("click", ".delete-row", function () {
                $(this).closest(".item-row").remove();
                updateIndexNumbers(); // Update index numbers after deleting a row
            });






            // Function to add a new line with a unique index number
            $("#add-another-line").click(function () {
    itemCounter++;
    var newRow = `
        <tr class="item-row" id="row${itemCounter}">
            <td class="index-number" style="width: 4px;">${itemCounter}</td>
            <td>
                <div style="display: flex; align-items: center;">
                    <select class='form-control text-white item_select itm' name='item[]' id='item${itemCounter}' onchange="itemfunction(this.id)" style="background-color: black; color: white;">
              <option value="" selected hidden>{{ item.itemname }}</option>
              {% for item in items %}
              <option class="text-light .name" value="{{ item.id }}">{{ item.item_name }}</option>
              {% endfor %}
            </select>
                    <a href="#">
                        <button type="button" class="btn btn-outline-warning ms-1" data-target="#newItem" data-toggle="modal">+</button>
                    </a>
                </div>
            </td>
            
            <td><input type="text" class="form-control" name="hsn[]" style="width: 85px;" required id="hsn${itemCounter}" /></td> <!-- Add HSN input field -->
            <td><input type="number" name="quantity[]" id="qty${itemCounter}" class="form-control qty" style="width: 100px;" onchange="calculateAmount(${itemCounter})"></td>
            
            <td><input type="number" class="rate form-control" name="rate[]" style="width: 95px;" step="0.01" required id="rate${itemCounter}" onchange="calculateAmount(${itemCounter})" readonly /></td>
            <td><input type="text" class="form-control" name="description[]" style="width: 100px;"  id="description${itemCounter}" /></td>
            <td><input type="number" class="amount form-control" name="amount[]" style="width: 100px;" step="0.01" required id="amount${itemCounter}" readonly /></td>
            <td class="text-center" style="display: grid;">
                <a href="#" class="delete-row btn btn-transparent  btn-sm  text-danger" style="width: 30px;"><i class="fa fa-trash text-danger"></i></a><br>
            </td>
        </tr>`;
    
        $(newRow).insertBefore(".blank-row");

    $('#item' + itemCounter).selectize({
        sortField: 'value',
        });
        reloadItemss();
        updateIndexNumbers();
        addEventListenersToInputs();
});

            // Call the function to update index numbers initially
            //updateIndexNumbers();
            function calculateAmount(rowId) {
                var quantity = parseFloat(document.getElementById('qty' + rowId).value);
                var rate = parseFloat(document.getElementById('rate' + rowId).value);
                var amount = quantity * rate;

                document.getElementById('amount' + rowId).value = amount.toFixed(2);
              }
             


              function addEventListenersToInputs() {
  var quantityInputs = document.querySelectorAll('[id^="qty"]');
  var rateInputs = document.querySelectorAll('[id^="rate"]');

  for (var i = 0; i < quantityInputs.length; i++) {
    quantityInputs[i].addEventListener('input', handleInput);
    rateInputs[i].addEventListener('input', handleInput);
  }
}
addEventListenersToInputs();
  function handleInput(event) {
    var rowId = event.target.id.slice(-1);
    calculateAmount(rowId);
    calculateTotalAmount();
  }

  function calculateTotalAmount() {
    var total = 0;

    $('.amount').each(function () {
      var amount = parseFloat($(this).val());
      if (!isNaN(amount)) {
        total += amount;
        console.log(total);
      }
    });

    document.getElementById('total-amount').value = total.toFixed(2);
    $('#balance').val(total.toFixed(2));

  }


  $(document).ready(function () {
    // Add event listeners to the 'Paid Off' and 'Total Amount' fields
    $('#paid').on('input', show_bal);
    $('#total-amount').on('input', show_bal);

    // Function to calculate and display the balance
    function show_bal() {
      var paid_off = parseFloat($('#paid').val());
      var total_amount = parseFloat($('#total-amount').val());
      var bal = total_amount - paid_off;

      // Ensure balance is shown as a positive number
      if (bal < 0) {
        bal = 0;
        document.getElementById('pay-warning').style.display = ""
        $('#pay-warning').text("Paid amount cannot be greater than the total*.");
      }
      else {
        document.getElementById('pay-warning').style.display = "none"

      }

      $('#balance').val(bal.toFixed(2));
    }

    // Call the show_bal() function initially to display the initial balance
    show_bal();
  });


  // Function to calculate subtotal
function calculateSubtotal() {
    var subtotal = 0;
    $('.amount').each(function () {
        var amount = parseFloat($(this).val());
        if (!isNaN(amount)) {
            subtotal += amount;
        }
    });
    return subtotal;
}

// Function to update subtotal, total, and balance
function updateTotals() {
    var subtotal = calculateSubtotal();
    var adjustment = parseFloat($('#adjustment').val()) || 0;
    var total = subtotal + adjustment;

    $('#subtotal').val(subtotal.toFixed(2));
    $('#total-amount').val(total.toFixed(2));

    calculateBalance(total);
}

// Function to calculate balance
function calculateBalance(total) {
    var paid = parseFloat($('#paid').val()) || 0;
    var balance = total - paid;

    if (balance < 0) {
        $('#pay-warning').text("Paid amount cannot be greater than the total.");
        $('#pay-warning').show();
    } else {
        $('#pay-warning').hide();
    }

    $('#balance').val(balance.toFixed(2));
}

// Function to handle input changes
function handleInput(event) {
    updateTotals();
}

// Add event listeners to quantity, rate, adjustment, and paid inputs
function addEventListeners() {
    var inputs = document.querySelectorAll('[id^="qty"], [id^="rate"], #adjustment, #paid');

    inputs.forEach(function(input) {
        input.addEventListener('input', handleInput);
    });
}

// Initialize event listeners
addEventListeners();

          </script>
          
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
          <script type="text/javascript">
            $(document).ready(function() {
              $('#pay_method').change(function() {
                var selectedOption = $(this).val();
                if (selectedOption === 'cheque') {
                  $('#chequediv').show();
                  $('#upidiv').hide();
                  $('#bnkdiv').hide();
                } else if (selectedOption === 'upi') {
                  $('#chequediv').hide();
                  $('#upidiv').show();
                  $('#bnkdiv').hide();
                } else if (selectedOption === 'cash') {
                  $('#chequediv').hide();
                  $('#upidiv').hide();
                  $('#bnkdiv').hide();
                } else {
                  $('#chequediv').hide();
                  $('#upidiv').hide();
                  $('#bnkdiv').show();
                  var selectedBank = $("#pay_method option:selected").text();
                  $.ajax({
                    url: "{% url 'get_bank_details' %}",
                    type: 'GET',
                    data: {
                      'bank_name': selectedBank
                    },
                    success: function(data) {
                      $('#bnk_id').val(data.bnk_acno);
                    }
                  });
                }
              });
            });
            function savedraft() {
              var frm = document.getElementById("home");
              frm.action = ("{% url 'create_invoice_draft' %}")
              
              }
            function savesend() {
              var frm = document.getElementById("home");
              frm.action = ("{% url 'create_invoice_send' %}")

            }



            $(document).on("click","#saveNewItem",function(){
    var name = $("#nameInput").val();
    var type = $("input[name='itemType']:checked").val();
    var unit = $("#selunit").val();
    var hsn = $("#myInputField").val();
    var purAccount = $("#myaccount").val();
    var trck;
    if($('#trackInv').prop('checked')){
        trck = 1
    }else{
        trck = 0
    }
    if(type == undefined){
        alert('Please select item type')
        return
    }
    if($('#gridRadios3').prop('checked') || $('#gridRadios4').prop('checked')){
        if($('#gridRadios3').prop('checked')){
            var tax = 'taxable'
        }else{
            var tax = 'None-Taxable'
        }
    }else{
        alert("Should select any of tax reference")
        return
    }

    if (name !="" && type !="" && unit != "" && hsn != "" && tax != "" && purAccount != ""){
        $.ajax({
            type : 'POST',
            url:"{% url 'createNewItemAjax' %}",
            data:{
                'name' : name,
                'type' : type,
                'unit' : unit,
                'hsn' : hsn,
                'taxref' : tax,
                'intra_st' : $("#intraStateTax").val(),
                'inter_st' : $("#interStateTax").val(),
                'pcost' : $("#purprice").val(),
                'pur_account' : purAccount,
                'pur_desc' : $("#purchaseDescription").val(),
                'salesprice' : $("#salesprice").val(),
                'sale_account' : $("#salesAccount").val(),
                'sale_desc' : $("#salesDescription").val(),
                'invacc' : $("#invAcc").val(),
                'stock' : $("#stockOnHand").val(),
                'stock_rate' : $("#stockRate").val(),
                'min_stock' : $("#minStock").val(),
                'trackInv' : trck,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            
            success: function(response) {
                if(response.status){
                    console.log("AJAX Success",response)
                    document.getElementById("newItemForm").reset();

                    if($('#newItem').hasClass('show')){
                        $('#newItem .close_item_modal').click()
                    }
                    reloadItems();
                    reloadItemss();
                }else{
                    alert(response.message)
                }
            },         
        });
    }
    else{
        alert('Fill all required fields.!')
        return;
    }
});

function reloadItems() {
    $.ajax({
        url: "{% url 'getAllItemsAjax' %}",
        type: "GET",
        dataType: "json",
        data: {},
        success: function(data) {
            console.log('Ajax Response ->', data);
            var itemDropdown = $('#item1')[0].selectize;

            // Clear existing options and add the default placeholder option
            itemDropdown.clearOptions();
            itemDropdown.addOption({ value: '', text: 'Select Item', disabled: true });

            // Iterate over the received data and add options to Selectize
            $.each(data, function (key, value) {
                const itemDetails = `${value[1]}`;
                const ID = `${value[0]}`;
                itemDropdown.addOption({ value: ID, text: itemDetails });
            });

            // Refresh Selectize to apply the changes
            itemDropdown.refreshOptions(false);
            itemDropdown.setValue(''); // Clear any previous selection
            console.log('Items RELOADED');
        },

        
        error: function(xhr, status, error) {
            console.error(xhr.responseText);
        }
    });

    if ($('#newAccount').hasClass('show')){
        $('#newAccount .close_account_modal').click();
    }

    if ($('#unitmodal').hasClass('show')){
        $('#unitmodal .close_unit_modal').click();
    }
}
function reloadItemss() {
    $.ajax({
        url: "{% url 'getAllItemsAjax' %}",
        type: "GET",
        dataType: "json",
        data: {},
        success: function(data) {
            console.log('Ajax Response ->', data);
            var itemDropdown = $(`#item${itemCounter}`)[0].selectize;

            // Clear existing options and add the default placeholder option
            itemDropdown.clearOptions();
            itemDropdown.addOption({ value: '', text: 'Select Item', disabled: true });

            // Iterate over the received data and add options to Selectize
            $.each(data, function (key, value) {
                const itemDetails = `${value[1]}`;
                const ID = `${value[0]}`;
                itemDropdown.addOption({ value: ID, text: itemDetails });
            });

            // Refresh Selectize to apply the changes
            itemDropdown.refreshOptions(false);
            itemDropdown.setValue(''); // Clear any previous selection
            console.log('Items still RELOADED');
        },
        error: function(xhr, status, error) {
            console.error(xhr.responseText);
        }
    });

    if ($('#newAccount').hasClass('show')){
        $('#newAccount .close_account_modal').click();
    }

    if ($('#unitmodal').hasClass('show')){
        $('#unitmodal .close_unit_modal').click();
    }
}


      $(document).on("click","#newAccountSave",function(){
            event.preventDefault();

            var acType = $("#soValue1").val();
            var acName = $("#account_name").val();
            var acCode = $("#account_code").val();
            var acDesc = $("#description").val();
            var accNumber = $('#account_number').val();
            var subAcc, parentAcc;
            if(acType == "" || acName == ""){
                alert('Account Name and Type should be entered.')
                return
            }

            if(acType == 'Bank' && accNumber == ""){
                alert('Please enter account number')
                return
            }

            if($('#sub_account').prop('checked')){
                if($('#parent_account').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    console.log('currentvalue == ',$('#parent_account').val())
                    subAcc = $('#sub_account').val()
                    parentAcc = $('#parent_account').val()
                }
            }else if($('#sub_account22').prop('checked')){

                if($('#parent_account22').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account22').val()
                    parentAcc = $('#parent_account22').val()
                }
            }else if($('#sub_account33').prop('checked')){

                if($('#parent_account33').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account33').val()
                    parentAcc = $('#parent_account33').val()
                }
            }else if($('#sub_account44').prop('checked')){

                if($('#parent_account44').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account44').val()
                    parentAcc = $('#parent_account44').val()
                }
            }else if($('#sub_account55').prop('checked')){

                if($('#parent_account55').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account55').val()
                    parentAcc = $('#parent_account55').val()
                }
            }else if($('#sub_account66').prop('checked')){
                if($('#parent_account66').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account66').val()
                    parentAcc = $('#parent_account66').val()
                }

            }else if($('#sub_account77').prop('checked')){
                if($('#parent_account77').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account77').val()
                    parentAcc = $('#parent_account77').val()
                }

            }else if($('#sub_account88').prop('checked')){
                if($('#sub_account88').prop('checked') && $('#parent_account88').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account88').val()
                    parentAcc = $('#parent_account88').val()
                }

            }else if($('#sub_account99').prop('checked')){
                if($('#parent_account99').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account99').val()
                    parentAcc = $('#parent_account99').val()
                }

            }else if($('#sub_account100').prop('checked')){
                if($('#parent_account100').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account100').val()
                    parentAcc = $('#parent_account100').val()
                }

            }else if($('#sub_account111').prop('checked')){
                if($('#parent_account111').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account111').val()
                    parentAcc = $('#parent_account111').val()
                }

            }else if($('#sub_account222').prop('checked')){
                if($('#parent_account222').val() == ""){
                    alert('Select parent account')
                    return
                }else{
                    subAcc = $('#sub_account222').val()
                    parentAcc = $('#parent_account222').val()
                }

            }else{

            }



            console.log(acType, acName, acCode, acDesc)
            console.log('sub', subAcc)
            console.log('parent', parentAcc)

          $.ajax({
            
            type : 'POST',
            url:"{% url 'createNewAccountAjax' %}",
        
            data:{
                
                account_type : acType,
                account_name : acName,
                account_code : acCode,
                description : acDesc,
                account_number : accNumber,
                
                sub_acc : subAcc,
                parent_acc : parentAcc,
         
         
                csrfmiddlewaretoken: '{{ csrf_token }}'
                
              },
              success: function(response) {
            if (response.status) {
              document.getElementById("newAccountForm").reset();
              if($('#newAccount').hasClass('show')){
                    $("#newAccount .close_account_modal").click()
                }
                reloadAccounts(acName)
            } else {
              $("#error-message-container2").text("Account with the same name exists");
            }
          },
      
          });     
        });
        
        
        function reloadAccounts(account) {
            $.ajax({
                url: "{% url 'getAllAccountsAjax' %}",
                type: "GET",
                dataType: "json", 
                data: {},
                
                success: function(data) {
                    var acc = account
                    var setVal = "";
                    var selectize = $('#myaccount').selectize()[0].selectize;
                    selectize.clearOptions();

                    selectize.addOptionGroup('Expense', { label: "Expense" });
                    selectize.addOptionGroup('Cost Of Goods Sold', { label: "Cost Of Goods Sold" });
                    selectize.addOptionGroup('Other Expense', { label: "Other Expense" });

                    $.each(data, function(key, value) {
                        if(account == value[0]){
                            setVal = value[0]
                        }
                        console.log(value[0],value[1])
                        if(value[1] == 'Expense'){
                            selectize.addOption({value:value[0],text:value[0], optgroup: 'Expense'});
                        }else if(value[1] == 'Cost Of Goods Sold'){
                            selectize.addOption({value:value[0],text:value[0], optgroup: 'Cost Of Goods Sold'});
                        }else if(value[1] == 'Other Expense'){
                            selectize.addOption({value:value[0],text:value[0], optgroup: 'Other Expense'});
                        }else{

                        }
                    });
                    selectize.refreshOptions();

                    if(setVal != ""){
                        selectize.setValue(setVal);
                    }
            
                },
                error: function(xhr, status, error) {
                console.error(xhr.responseText);
            
                }
            });
        }





        function deleteContact(button) {
      var row = button.parentNode.parentNode;
      row.parentNode.removeChild(row);
  }

  document.querySelector('.add_another').addEventListener('click', function() {
      var table = document.getElementById('tbl').getElementsByTagName('tbody')[1];
      var newRow = table.insertRow(table.rows.length);

      for (var i = 1; i < 9; i++) {
          var cell = newRow.insertCell(i);
          cell.innerHTML = '<input type="text" class="form-control border-1 bg-transparent text-white" name="dynamic[]">';
      }

      var deleteCell = newRow.insertCell(9);
      deleteCell.innerHTML = '<button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button>';
  });

 

  $(document).ready(function() {
  // Attach event listener to input fields
  $('#opa, #cl').on('input', function() {
      // Get values of the input fields
      var openingBal = parseFloat($('#opa').val());
      var creditLimit = parseFloat($('#cl').val());

      // Check if credit limit is greater than opening balance amount
      if (creditLimit > openingBal) {
          // Show custom alert
          $('#custom-alert').fadeIn();

          // Clear the value of #cl
          $('#cl').val('');
      }
  });

  // Close custom alert when close button is clicked
  $('.close-btn').on('click', function() {
      $('#custom-alert').fadeOut();
  });
});


  $(document).ready(function(){

  // Get the CSRF token from the cookie
      function getCookie(name) {
      var cookieValue = null;
      if (document.cookie && document.cookie !== '') {
          var cookies = document.cookie.split(';');
          for (var i = 0; i < cookies.length; i++) {
              var cookie = cookies[i].trim();
              // Does this cookie string begin with the name we want?
              if (cookie.substring(0, name.length + 1) === (name + '=')) {
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue;
      }
      var csrftoken = getCookie('csrftoken');

      // Pan Number Check

      $('#panInput').on('input', function(){
      var panNumber = $(this).val();
      var regex = /[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
      if(regex.test(panNumber)) {
          $('#panMessage').text('PAN number is valid.').css('color', 'green');
          // PAN number is valid, call AJAX to check if it exists
          $.ajax({
          url: "{% url 'customer_check_pan' %}",
          headers: {'X-CSRFToken': csrftoken}, 
          type: 'POST',
          data: {panNumber: panNumber},
          success: function(response) {
              if (response.status == 'exists') {
                  $('#panMessage').text('PAN number already exists.').css({
                      'color': 'red',
                      'font-size': '12px'
                  });
                  
              }
          }
          });
      } else {
          $('#panMessage').text('Please enter a valid PAN number.').css({
              'color': 'red',
              'font-size': '12px'
          });
      }
      });

      // Pna Number Check End 


      // GST Number Check 

      $('#gstInput').on('input', function(){
          var gstNumber = $(this).val();
          var regex = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
          if(regex.test(gstNumber)) {
              $('#gstMessage').text('GST number is valid.').css('color', 'green');
              // GST number is valid, call AJAX to check if it exists
              $.ajax({
                  url: "{% url 'customer_check_gst' %}",
                  headers: {'X-CSRFToken': csrftoken}, 
                  type: 'POST',
                  data: {gstNumber: gstNumber},
                  success: function(response) {
                      if (response.status == 'exists') {
                          $('#gstMessage').text('GST number already exists.').css({
                              'color': 'red',
                              'font-size': '12px'
                          });
                          
                      }
                  }
                  });
          } 
          else {
              $('#gstMessage').text('Please enter a valid GST number.').css({
                  'color': 'red',
                  'font-size': '12px'
              });
          }
          });
  
      // GST Number Check End 

  });

    // Name display 

      
    const Title = document.getElementById('select1');
const fname = document.getElementById('fname');
const laname = document.getElementById('lname');
const vDisplayName = document.getElementById('v_display_name');

// Listen for input events on the initial input fields
Title.addEventListener('input', updateOutputFields);
fname.addEventListener('input', updateOutputFields);
laname.addEventListener('input', updateOutputFields);

// Function to update the output fields
function updateOutputFields() {
  const selectedTitle = Title.value;
  const selectedFname = fname.value;
  const selectedLname = laname.value;

  // Clear existing options
  vDisplayName.innerHTML = '';
// Add new options based on input field values
const option1 = document.createElement('option');
  option1.text = selectedTitle + ' ' + selectedFname + ' ' + selectedLname;
  vDisplayName.add(option1);

 

  const option2 = document.createElement('option');
  option2.text = selectedFname + ' ' + selectedLname;
  vDisplayName.add(option2);

  const option3 = document.createElement('option');
  option3.text = selectedLname + ' ' + selectedFname;
  vDisplayName.add(option3);
}


  function gstPan_function(){
      var x=document.getElementById('GSTT').value
      if(x=="Unregistered Business-not Registered under GST")
      {
          document.getElementById("pan").style.display="block";
          document.getElementById("gst").style.display="none";

          
      }
      else if((x=="Registered Business-Regular Business that is registered under GST") || (x=="Registered Business-Composition Business that is registered under the Composition scheme in GST") || (x=="Overseas- Persons with who you do import or exports of supplies outside india") || (x=="Special Economic Zone"))
      {
          document.getElementById("gst").style.display="block";
          document.getElementById("pan").style.display="block";


      }
  
  }



  $(document).ready(function () {
      $(".toggle1").click(function (e) {
        e.preventDefault();
        $("fieldset1").toggle();
      })
    })
    $(document).ready(function () {
      $(".toggle2").click(function (e) {
        e.preventDefault();
       
        $("fieldset2").toggle(); 
        $("fieldset5").hide();
        $("fieldset6").hide();
        $("fieldset7").hide();


    
      })
    })

    $(document).ready(function () {
      $(".toggle3").click(function (e) {
        e.preventDefault();
        $("fieldset5").toggle();
        $("fieldset2").hide();
        $("fieldset6").hide();
        $("fieldset7").hide();

      })
    })
    $(document).ready(function () {
      $(".toggle4").click(function (e) {
        e.preventDefault();
        $("fieldset6").toggle();
        $("fieldset2").hide();
        $("fieldset5").hide();
        $("fieldset7").hide();
              
      })
    })
    $(document).ready(function () {
      $(".toggle7").click(function (e) {
        e.preventDefault();
        $("fieldset7").toggle();
        $("fieldset2").hide();
        $("fieldset6").hide();
        $("fieldset5").hide();
       

       
      })
    })



  $('document').ready(function () {
      $('.add_another').click(function () {
        $("#tbl").append(`<tr>
          <td>
              <select name="salutation[]" class="salutation form-control bg-transparent border-1 text-white">
                <option value="" class="text-dark">Select</option>
                  <option value="Mr" class="text-dark">Mr.</option>
                  <option class="text-dark" value="Mrs">Mrs.</option>
                  <option class="text-dark" value="Ms">Ms.</option>
                  <option class="text-dark" value="Miss">Miss.</option>
                  <option class="text-dark" value="Dr">Dr.</option>
              </select>  
          </td>
          <td>
              <input type="text" name="first_name[]" class="first_name form-control border-1 bg-transparent text-white"  value="" />
          </td>
          <td>
              <input type="text" name="last_name[]" class="last_name form-control border-1 bg-transparent text-white"   value="" />
          </td>
          <td>
              <input type="email" name="email[]" class="email form-control border-1 bg-transparent text-white" value="" />
          </td>
          <td>
              <input type="tel" pattern="[0-9]{7}" id="twphone" name="wphone[]" class="work_phone form-control border-1 bg-transparent text-white"  value="" />
          </td>
          <td>
              <input type="tel" pattern="[0-9]{10}" id="tmobile" onclick="sample1()" name="mobile[]" class="mobile_phone form-control border-1 bg-transparent text-white"  value="" />
          </td>
          <td>
              <input type="number" onclick="sample()" name="skype[]" class="skype_number form-control border-1 bg-transparent text-white"  value="" />
          </td>
          <td>
              <input type="text" name="designation[]" class="designation form-control border-1 bg-transparent text-white" value="" />
          </td>
          <td>
              <input type="text" name="department[]" class="department form-control border-1 bg-transparent text-white" value="" />
          </td>
          <td><button type="button" class="btn btn-danger" onclick="deleteContact(this)">Delete</button></td>
      </tr>`);
      });
    })

    function fieldset5_function()
    {
      document.getElementById("address").style.display="block";
    }

  

  function myCopyAddressFunction() {
      var checkBox = document.getElementById("myCheckT");
      var textatn = document.getElementById("batten");
      var txtcry = document.getElementById("bctry");
      var txtadrs11 = document.getElementById("badd1");
      var txtcty = document.getElementById("bcty");
      var txtstat = document.getElementById("bste");
      var txtzip = document.getElementById("bzp");
      var txtphone = document.getElementById("bphone_num");
      var txtfx = document.getElementById("bfx");

      var textatn1 = document.getElementById("satten");
      var txtcry1 = document.getElementById("sctry");
      var txtadrs21 = document.getElementById("sadd1");
      var txtcty1 = document.getElementById("scty");
      var txtstat1 = document.getElementById("sste");
      var txtzip1 = document.getElementById("szp");
      var txtphone1 = document.getElementById("sphone_num");
      var txtfx1 = document.getElementById("sfx");
      if (checkBox.checked == true) {
        textatn1.value = textatn.value;
        txtadrs21.value = txtadrs11.value;
        txtcty1.value = txtcty.value;
        txtstat1.value = txtstat.value;
        txtzip1.value = txtzip.value; 
        txtphone1.value = txtphone.value;
        txtfx1.value = txtfx.value;
        



        

      } else {
        txtadrs21.value = "";
        txtcty1.value = "";
        txtstat1.value = "";
        txtzip1.value = "";
        txtphone1.value = "";
        txtfx1.value = "";
        txtcry1.value = "";
        textatn1.value = "";


      }
    }


    function open_table()
    {
      document.getElementById("hid").style.display="block";
      
    }



  

    function bphone_number()
    {
      var a1=document.getElementById("bphone_num").value;
      var b1=document.getElementById("bphone_label");
      var expr=/^[0-9]{10}$/;
      if (!expr.test(a1)) {
          b1.style.color="red";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Invalid Phone Number. Please Enter 10 digit Number";
      }
      else{
          b1.style.color="green";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Valid Phone Number.";

      }
    }

    function sphone_number()
    {
      var a1=document.getElementById("sphone_num").value;
      var b1=document.getElementById("sphone_label");
      var expr=/^[0-9]{10}$/;
      if (!expr.test(a1)) {
          b1.style.color="red";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Invalid Phone Number.";
      }
      else{
          b1.style.color="green";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Valid Phone Number.";

      }
    }

    function fax_number()
    {
      var a1=document.getElementById("bfx").value;
      var b1=document.getElementById("fax_label");
      var expr=/^[0-9]{7}$/;
      if (!expr.test(a1)) {
          b1.style.color="red";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Invalid Fax Number.Please Enter 7 digit Number";
      }
      else{
          b1.style.color="green";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Valid Fax Number.";

      }
    }

    function sfax_number()
    {
      var a1=document.getElementById("sfx").value;
      var b1=document.getElementById("sfax_label");
      var expr=/^[0-9]{7}$/;
      if (!expr.test(a1)) {
          b1.style.color="red";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Invalid Fax Number.";
      }
      else{
          b1.style.color="green";
          b1.style.fontSize="0.750rem";
          b1.innerHTML = "Valid Fax Number.";

      }
    }

  
    function sample()
    {

      var tbldata = document.getElementById("tbl");
      var total_rows = tbldata.rows.length;
      x=document.getElementById("tbl");
      var a1=x.rows[total_rows-1].cells[5].getElementsByTagName('input')[0].value;

      var b1=document.getElementById("tlabel");

      b1.innerHTML = "";

      var expr=/^[0-9]{10}$/;
      if (!expr.test(a1)) {
          b1.style.color="red";
          b1.innerHTML = "Invalid";
          b1.style.fontSize="0.750rem";
      }
      else{
          b1.style.color="green";
          b1.innerHTML = "Valid";
          b1.style.fontSize="0.750rem";

      }

     

    }

    function sample1()
    {

      var tbldata = document.getElementById("tbl");
      var total_rows = tbldata.rows.length;
      x=document.getElementById("tbl");
      var a1=x.rows[total_rows-1].cells[4].getElementsByTagName('input')[0].value;

      var b1=document.getElementById("twph_label");

      b1.innerHTML = "";

      var expr=/^[0-9]{7}$/;
      if (!expr.test(a1)) {
          b1.style.color="red";
          b1.innerHTML = "Invalid";
          b1.style.fontSize="0.750rem";
      }
      else{
          b1.style.color="green";
          b1.innerHTML = "valid";
          b1.style.fontSize="0.750rem";

      }


    }



  function vendor_display()
  {
      var x=document.getElementById("select1").value;
      var y=document.getElementById("fname").value;
      var z=document.getElementById("lname").value;

      document.getElementById("select2").innerHTML=x+" "+y+" "+z
  
      
  }


  // Get the input element
  const inputElement = document.getElementById("tname");

  // Add event listener for input event
  inputElement.addEventListener("input", function() {
      // Convert the input value to uppercase
      this.value = this.value.toUpperCase();
  });


$(document).ready(function() {
  $('#tname').on('blur', function() {
      
      var termName = $(this).val();
     
      $.ajax({
          type: 'GET',
          url:'{% url "check_customer_term_exist" %}',
          data: {
              term_name: termName
          },
          success: function(response) {
              if (response.exists) {
                alert('Term already exists !')
                  $('#message-id').text('Term already exists !');
                  $('#success-message-id').text('');
                
                  $('#tname').val('');
              } else {
                  $('#success-message-id').text('Term name available !');
                  $('#message-id').text('');
              }
              
          },
          error: function(xhr, status, error) {
              console.error('Error:', error);
          }
      });
  });
});

$('#vendor-email').on('input', function() {
      
  var vendorEmail = $(this).val();
  console.log(vendorEmail)
  $.ajax({
      type: 'GET',
      url:'{% url "check_customer_email_exist" %}',
      data: {
          vendor_email: vendorEmail
      },
      success: function(response) {
          if (response.exists) {
              $('#email-message-id').text('Email id already exists !');
              $('#vendor-email').val('');
          }
          else{
              $('#email-message-id').text('');
          }
          
      },
      error: function(xhr, status, error) {
          console.error('Error:', error);
      }
  });
});

$('#workphone').on('input', function() {
      
  var wPhone = $(this).val();
  
  $.ajax({
      type: 'GET',
      url:'{% url "check_customer_work_phone_exist" %}',
      data: {
          w_Phone: wPhone
      },
      success: function(response) {
          if (response.exists) {
              $('#workphone_label').text('Work phone number already exists !');
              $('#workphone').val('');
          }
          else{
              $('#workphone_label').text('');
          }
          
      },
      error: function(xhr, status, error) {
          console.error('Error:', error);
      }
  });
});


$('#mphone').on('input', function() {
      
  var mPhone = $(this).val();
  
  $.ajax({
      type: 'GET',
      url:'{% url "check_customer_phonenumber_exist" %}',
      data: {
          m_Phone: mPhone
      },
      success: function(response) {
          if (response.exists) {
              $('#mphone_label').text('Phone number already exists !');
              $('#mphone').val('');
          }
          else{
              $('#mphone_label').text('');
          }
          
      },
      error: function(xhr, status, error) {
          console.error('Error:', error);
      }
  });
});

  // Work Phone Number Validation 
  $(document).ready(function () {
      $('#workphone').on('input', function () {
          var inputVal = $(this).val();
          var expr = /^[0-9]{7}$/;
          if (expr.test(inputVal)) {
              $('#work-phone-message').text('Valid work phone number').css('color', 'green');
          } else {
              $('#work-phone-message').text('Invalid work phone number').css('color', 'red');
          }
      });
  });

  // Phone Number Validation
  $(document).ready(function () {
      $('#mphone').on('input', function () {
          var inputVal = $(this).val();
          var expr=/^[0-9]{10}$/;
          if (expr.test(inputVal)) {
              $('#phone-message').text('Valid  phone number').css('color', 'green');
          } else {
              $('#phone-message').text('Invalid  phone number').css('color', 'red');
          }
      });
  });

  $(document).on("click","#customerPaymentTermSave",function(){
        var trm = $('#tname').val();
        var dys = $("#tdays").val();
        if (trm !="" && dys !=""){
            $.ajax({
                type : 'POST',
                url:"{% url 'newPaymentTermAjax' %}",
                data:{
                    'term' : trm,
                    'days' : dys,
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                
                success: function(response) {
                    if(response.status){
                        document.getElementById("newTermForm").reset();
                        
                        var dropdown = $('#paytearm-select');
                        dropdown.empty();
                        dropdown.append(`<option value="" selected>Choose</option>`);
                        $.each(response, function(key, value) {
                            for(let i=0; i<value.length; i++){
                                if(value[i].name == trm){
                                    dropdown.append($('<option selected></option>').text(value[i].name).val(value[i].id))
                                }else{
                                    dropdown.append($('<option></option>').text(value[i].name).val(value[i].id))
                                }   
                            }
                        });

                    }else{
                        alert("Something went wrong.!")
                    }
                },         
            });
        }
        else{
            alert('Invalid')
        }
    });


        $(document).on("click", "#newCustomerSave", function(){
      var type = $('input[name="type"]:checked').val();
      var title = $('#select1').val();
      var fName = $('#fname').val();
      var lName = $('#lname').val();
      var placeSupply = $('#PLACE').val();
      var gstType = $("#GSTT").val();
      var gstIN = $("#gstInput").val();
      var panNo = $("#panInput").val();
      var Email = $("#vendor-email").val();
      var Mob = $("#mphone").val();
      var street = $("#badd1").val();
      var city = $("#bcty").val();
      var state = $("#bste").val();
      var pin = $("#bzp").val();
      var country = $("#btry").val();
      var tax_ref = $('input[name="tax1"]:checked').val();
      var tSalutation = []
      var tFirstName = []
      var tLastName = []
      var tEmail = []
      var tWork = []
      var tMobile = []
      var tSkype = []
      var tDesignation = []
      var tDepartment = []

      if(gstType != "" && gstType != "Unregistered Business-not Registered under GST" && gstType != 'Overseas- Persons with who you do import or exports of supplies outside india' && gstIN == ""){
          alert('Fill Enter GSTIN..!')
          return
      }

      $('#tbl tbody tr').each(function(){
        var row = $(this)
        if(row != ""){
            var sal = row.find('.salutation').val();
            var fn = row.find('.first_name').val();
            var ln = row.find('.last_name').val();
            var eml = row.find('.email').val();
            var wrk = row.find('.work_phone').val();
            var mob = row.find('.mobile_phone').val();
            var sky = row.find('.skype_number').val();
            var dep = row.find('.department').val();
            var des = row.find('.designation').val();
            console.log(sal,fn,ln, eml,wrk, mob, sky, dep, des)
            // if(sal == "" && fn == "" && ln == "" && eml == "" && wrk == "" && mob == "" && sky == "" && dep == "" && des == ""){
            //     console.log('No table data')
            // }else{
            //     if(sal == "" || fn == "" || ln == "" || eml == "" || wrk == "" || mob == "" || sky == "" || dep == "" || des == ""){
            //         // alert('Fill All Fields of Contact persons table')
            //         // return
            //     }
            // }
            tSalutation.push(sal);
            tFirstName.push(fn);
            tLastName.push(ln);
            tEmail.push(eml);
            tWork.push(wrk);
            tMobile.push(mob);
            tSkype.push(sky);
            tDesignation.push(des);
            tDepartment.push(dep);
        }
    })
    var cols = [tSalutation,tFirstName,tLastName,tEmail,tWork,tMobile,tSkype,tDesignation,tDepartment]
    var cntactTableLength = $('#tbl tbody tr').length
    var nullExists = false
    if(cntactTableLength == 1 && tSalutation[0] == "" && tFirstName[0] == "" && tLastName[0] == "" && tEmail[0] == "" && tWork[0] == "" && tMobile[0] == "" && tSkype[0] == "" && tDesignation[0] == "" && tDepartment[0] == ""){
        console.log('No table data')
    }else{
        for(i=0; i<cols.length; i++){
            for(j=0; j<cols[i].length; j++){
                if(cols[i][j] == ''){
                    nullExists = true
                }
            }
        }
        // if(sal == "" || fn == "" || ln == "" || eml == "" || wrk == "" || mob == "" || sky == "" || dep == "" || des == ""){
        //     // alert('Fill All Fields of Contact persons table')
        //     // return
        // }
    }
    if(nullExists){
        alert('Fill All Fields of Contact persons table')
        return
    }

      if(fName != "" && lName != "" && placeSupply != "" && gstType != "" && panNo != "" && Email != "" && Mob != "" && tax_ref != undefined){
          $.ajax({
              type : 'POST',
              url:"{% url 'newSalesCustomerAjax' %}",
              data:{
                'type': type,
                'salutation' : title,
                'first_name' : fName,
                'last_name' : lName,
                'company_name' : $('#companyName').val(),
                'v_display_name' : $('#v_display_name').val(),
                'vendor_email' : Email,
                'w_phone' : $('#workphone').val(),
                'm_phone' : Mob,
                'skype_number' : $('#skypeNumber').val(),
                'designation' : $('#design').val(),
                'department' : $('#dept').val(),
                'website' : $('#web').val(),
                'gst' : gstType,
                'remark' : $('#rmrk').val(),
                'pan_number' : panNo,
                'gst_number' : gstIN,
                'source_supply' : placeSupply,
                'currency' : $('#crncy').val(),
                'op_type' : $('input[name="op_type"]:checked').val(),
                'opening_bal' : $('#opa').val(),
                'payment_terms' : $('#paytearm-select').val(),
                'plst' : $('#priceLs').val(),
                'plang' : $('#plang').val(),
                'fbk' : $('#fbk').val(),
                'twtr' : $('#twtr').val(),
                'tax1' : tax_ref,
                'battention' : $('#batten').val(),
                'bcountry' : country,
                'baddress' : street,
                'bcity' : city,
                'bstate' : state,
                'bzip' : pin,
                'bphone' : $('#bphone_num').val(),
                'bfax' : $('#bfx').val(),
                'sattention' : $('#satten').val(),
                's_country' : $('#sctry').val(),
                'saddress' : $('#sadd1').val(),
                'scity' : $('#scty').val(),
                'sstate' : $('#sste').val(),
                'szip' : $('#szp').val(),
                'sphone' : $('#sphone_num').val(),
                'sfax' : $('#sfx').val(),
                'tsalutation[]' : tSalutation,
                'tfirstName[]' : tFirstName,
                'tlastName[]' : tLastName,
                'tEmail[]' : tEmail,
                'tWorkPhone[]' : tWork,
                'tMobilePhone[]' : tMobile,
                'tSkype[]' : tSkype,
                'tDesignation[]' : tDesignation,
                'tDepartment[]' : tDepartment,
                csrfmiddlewaretoken: '{{ csrf_token }}',
              },

              success: function(response) {
                if(response.status){
                    console.log("AJAX Success",response)
                    document.getElementById("newCustomerForm").reset();
                    if($('#newCustomer').hasClass('show')){
                        $("#newCustomer .close_customer_modal").click()
                    }
                    reloadCustomer();
                }else{
                    alert(response.message)
                }
              },
          });
      }else{
          alert('Fill all required fields..!')
          return
      }
  });
  

  function reloadCustomer() {
    console.log('Reloading customers...');
    $.ajax({
        url: "{% url 'getCustomersAjax' %}",
        type: "GET",
        dataType: "json",
        data: {},
        success: function (data) {
            console.log('Ajax Response ->', data);
            var custDropdown = $('#customer_sel')[0].selectize;
            custDropdown.clearOptions();
            custDropdown.addOption({ value: '', text: 'Select Customer', disabled: true });

            $.each(data, function (key, value) {
                const customerDetails = `${value[1]} ${value[2]} ${value[3]}`;
                const ID = `${value[0]}`;
                custDropdown.addOption({ value: ID, text: customerDetails });
            });
            // Reinitialize Selectize
            // Refresh Selectize to apply the changes
            custDropdown.refreshOptions(false);
            custDropdown.setValue(''); // Clear any previous selection
            console.log('Customers RELOADED');
        },
        error: function (xhr, status, error) {
            console.error(xhr.responseText);
        }
    });
      // refreshCustomerDetails();

      if ($('#newpayment').hasClass('show')){
          $('#newpayment .cust_payment_modal_close').click();
      }
  }


  $(document).ready(function() {
        $('#myaccount').selectize();
    });
    $(document).ready(function() {
        $('#selunit').selectize();
    });

    $(document).on("click", "#newUnitSave", function(event) {
        event.preventDefault(); // Prevent the default form submission
        var uName = $("#unitName").val();
        $.ajax({
          type: 'POST',
          url: "{% url 'add_unit' %}",
          data: {
            units: uName,
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          success: function(response) {
            if (response.message === 'success') {
              document.getElementById("unitform").reset();
              if($('#unitmodal').hasClass('show')){
                    $("#unitmodal .close_unit_modal").click()
                }
              reloadUnit(uName);
            } else {
              $("#error-message-container").text("Unit with the same name exists");
            }
          },
        });
      });

      function reloadUnit(unit) {
      
        $.ajax({
                url: "{% url 'getUnitsAjax' %}",
                type: "GET",
                dataType: "json",
                data: $(this).serialize(),
                csrfmiddlewaretoken: '{{ csrf_token }}',
            
                success: function(data) {
                    var setVal = "";
                    var $select = $(document.getElementById('selunit'));
                    var selectize = $select[0].selectize;
                    $.each(data, function(key, value) {
                        if(unit == value[1]){
                            setVal = value[0]
                        }
                        selectize.addOption({value:value[0],text:value[1]});
                        selectize.addItem(value[0]); 
                    });

                    if(setVal != ""){
                        selectize.setValue(setVal);
                    }
            
                },
        
        });
      }

    function showAllSelect() {
        var select1_div = document.getElementById("select1_div");
        var select2_div = document.getElementById("select2_div");
        select1_div.style.display = "block";
        select2_div.style.display = "block";
    }

    function hideAllSelect() {
        var select1_div = document.getElementById("select1_div");
        var select2_div = document.getElementById("select2_div");
        select1_div.style.display = "none";
        select2_div.style.display = "none";
    }

      function toggleFormFields() {
        var formFields = document.getElementById("formFields");
        var checkbox = document.querySelector("input[name=trackstate]");
    
        if (checkbox.checked) {
            formFields.style.display = "block";
        } else {
            formFields.style.display = "none";
        }
        }

        function validateSixDigits(field) {
              // Define the regular expression pattern for exactly six digits
              var pattern = /^\d{6}$/;
      
              // Check if the field matches the pattern
              return pattern.test(field);
          }
      
          function validateInput() {
              var inputField = document.getElementById("myInputField");
              var inputValue = inputField.value;
      
              var validationResultDiv = document.getElementById("validationResult");
      
              if (validateSixDigits(inputValue)) {
                  validationResultDiv.textContent = "Valid";
              } else {
                  validationResultDiv.textContent = "Invalid: The field does not contain six digits.";
              }
          }

// $(document).ready(function () {
//     $("#prof_name").keyup(function () {
//       var x = $('#prof_name').val();
//       reford = "{{reference}}"
//       if (reford != '01') {
//         if (reford != x) {
//           document.getElementById("order_label").style.display = "block"
//           document.getElementById("order_label").style.color = "yellow"
//           document.getElementById("order_label").innerHTML = "Retainer invoice is not Continuous"
//         } else {
//           document.getElementById("order_label").style.display = "block"
//           document.getElementById("order_label").style.color = "green"
//           document.getElementById("order_label").innerHTML = "Retainer invoice is now Continuous"
//         }
//       }
//     });
//   });

  $('#retainer-table').on('click', '.delete-row', function () {
    event.preventDefault();
    $(this).closest('tr').remove();
    calculateTotalAmount();
  });



  
          </script>
       
{% endblock %}