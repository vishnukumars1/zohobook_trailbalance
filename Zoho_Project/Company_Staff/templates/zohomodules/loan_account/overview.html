{% extends 'base.html' %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/print-js/1.6.0/print.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<style>
  .hidden-option {
    display: none;
  }

  a {
    list-style: none;
    color: azure;
  }

  a:hover {
    color: rgb(218, 164, 48);
    text-decoration: none;
  }

  .tab {
    overflow: hidden;
    background-color: transparent;
    width: 300px;
  }

  .tab a {
    font-family: inherit;
    background-color: inherit;
    float: left;
    outline: none;
    cursor: pointer;
    padding: 10px 5px;
    transition: 0.3s;
    color: azure;
    border: none;
  }

  .tab a:hover {
    background-color: #ddd;
    color: rgb(56, 54, 54);
  }

  .tab a.active {
    background-color: #ccc;
    color: rgb(56, 54, 54);
  }

  .tabcontent {
    display: none;
    border-top: none;
  }

  .page {
    background: azure;
    display: block;
    box-shadow: 0 0 0.5cm rgba(0, 0, 0, 0.5);
  }

  .print-only {
    display: none;
    height: auto;
    overflow-y: auto;
    border: none;
    box-shadow: inset 2px 2px 5px 2px rgba(0, 0, 0, 0.3),
          inset -2px -2px 5px 2px rgba(0, 0, 0, 0.3),
          inset 2px -2px 5px 2px rgba(0, 0, 0, 0.3),
          inset -2px 2px 5px 2px rgba(0, 0, 0, 0.3);
  }

  .card-custom {
    background-color: rgba(255, 255, 255, 0.5);
  }

  .card-text {
    margin-bottom: 0.5rem;
  }

  .info-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .info-item {
    display: flex;
    align-items: center;
  }

  .label {
    margin: 0;
    width: 130px; 
  }

  .value {
    margin: 0;
    flex: 1;
  }

  .info-container {
    display: flex;
    justify-content: space-between;
  }

  .info-item {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
  }

 .info-item h6.label {
    margin-left: 10px;
    display: inline-block;
  } 

  .info-item p.value {
    margin-left: 10px;
  }

  .bank-info {
    margin-bottom: 10px;
  }

  .bank-info span {
    padding: 5px; 
  }

  .modal{
    z-index: 9999;
    overflow: scroll;
  }

  .btn-outline-warning:hover{
    color: black;
    font-weight:bolder;
  }


  #Overview tbody tr td{
    border: none;
  }

  .medium_btn{
    font-size: 12px; 
    padding: 10px 20px;
    margin-left: 1px;
  }

  #overview_btn{
    background-color: #ffae1f; 
    color: black; 
    font-weight: bold;
  }

  .modal .btn-outline-warning:hover{
    color: black !important;
  }

  .modal{
    margin-top: 3.5%;
  }
  
  .dropdown-item:hover{
    cursor: pointer;
  }

  .info-label {
    flex: 0 0 50%;
  }

  .info-value {
    flex: 1;
  }

  .bank-row{
    padding-left: 10%;
  }

  ::-webkit-scrollbar{
    display: none;
  }

  .page[size="A4"] {
    overflow: hidden;
  }
  
  @media print {
    html,body {
        height: 100% !important;
        /* width: 100% !important; */
        /* display: block; */
      
      visibility: hidden !important;
      /* height:100%;  */
      overflow:scroll;
    }
    .printContainer {
            visibility: visible !important;/* Override the rule above to only show the printables */ 
            position: absolute;
            z-index: 99999;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 100%;
            font-size: large;
        } 

    header {
      display: none;
    }

    .print-only * {
      visibility: visible;
    }

    .print-only {
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      height:auto;
      page-break-before: always;
      page-break-inside: avoid;
    }
  }

  .small_btn{
    padding: 5px 9px;
    height: 50%;
    margin-top: 1%;
  }

  .xsmall_btn{
    padding: 6px;
    margin-top: 1%;
  }

    /* Style for the date input */
    input[type="date"] {
        /* Change the color of the text */
        color: white; /* Change to the desired color */
    }

    /* Style for the calendar icon */
    input[type="date"]::-webkit-calendar-picker-indicator {
        /* Change the color of the calendar icon */
        filter: invert(1); /* Change to the desired color */
    }

</style>

<div class="body-wrapper">
  <div class="container-fluid">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>
        <li class="breadcrumb-item"><a class="text-warning-emphasis">Cash & Bank</a></li>
        <li class="breadcrumb-item"><a href="{% url 'loan_listing' %}" class="text-warning-emphasis">Loan Account</a></li>
        <li class="breadcrumb-item" aria-current="page" id="over">Overview</li>
        <li class="breadcrumb-item" aria-current="page" id="tran" style="display: none;">Transaction</li>
        <li class="breadcrumb-item" aria-current="page" id="state" style="display: none;">Statement</li>
      </ol>
    </nav>
    <div class="row pt-3">
      <div class="col-md-12">
        <div class="card mb-5">
          <div class="row" style="background-color: #252525;" >
            <!-- Left Side: Table -->
            <div class="col-md-12 col-lg-4" style="background-color: black; border-radius: 1vh;">
              <div class="p-4"> 
                <h6 class="pt-3" style="font-size: 1.8rem; color: white;">Loan Account</h6>
                <div class="d-flex justify-content-between gap-1 mt-2 mr-4">
                  <input class="form-control text-black bg-light mt-4" type="text" id="search" placeholder="Search..." style="margin-right: 10%;">

                  <a class="btn btn-outline-warning small_btn mt-4" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                  <i class="fa fa-sort mt-1" style="font-size: small;"></i>
                  </a>
                  <div class="dropdown-menu ">
                      <a class="dropdown-item text-black" href="{% url 'overview' account.id %}" >All</a>
                      <a class="dropdown-item text-black" onclick="sorttable(0)">Account Holder</a>
                      <a class="dropdown-item text-black" onclick="sorttable(1)">Balance</a>
                  </div>
  
                  <a class="btn btn-outline-warning small_btn mt-4" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                    <i class="fa fa-filter" style="font-size: small;"></i>
                  </a>
                  <div class="dropdown-menu">
                    <a class="dropdown-item text-black" href="{% url 'overview' account.id %}">All</a>
                    <a class="dropdown-item text-black" onclick="filtertable('Active')">Active</a>
                    <a class="dropdown-item text-black" onclick="filtertable('Inactive')">Inactive</a>
                  </div>
                  <a class="btn btn-outline-warning small_btn mt-4" role="button" href="{% url 'add_loan' %}">
                    <i class="fa fa-plus"></i>
                  </a>
                </div>
      
                <div class="row">
                  <div class="col-md-12 mt-2">
                    <div class="table-responsive">
                      <table class="table text-white" id="sidetable">
                        <tbody>
                          {% for b in loan_side %}
                          <tr class='clickable-row' data-href="{% url 'overview' b.bank_holder.id %}" style="cursor: pointer;">
                            
                            <td>
                              
                              <span class="name"><b>{{ b.bank_holder.customer_name }}</b></span><br><br>
                              {{ b.bank_holder.account_number }}
                            </td>
                            <td>
                              <span style="float: right;" class="bal">&#8377;{{ b.balance }}</span><br><br>
                              <span style="float: right;" class="stat">{{b.status}}</span>
                            </td>
                            

                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="col-md-12 col-lg-8">
              <div style="background-color: black; border-radius: 1vh;">
                <div class="card-header p-4">
                  <h6 class="mt-3" style="font-size: 1.8rem; color: white;">All Transactions</h6><br>
                  {% for message in messages %}
                  <h5>
                    <div class="alert alert-danger message text-center" style="color: black;" id="alert_danger">
                      {{ message }}
                      <a type="button" id="alert_close" class="close" data-dismiss="alert" aria-label="Close" style="float: right;">
                        <span aria-hidden="true" style="font-size: large; color: #68020F;">&times;</span>
                      </a>
                    </div>
                  </h5>
                  {% endfor %}
                  <div class="row">
                    <div class="col-md-7">
                      <a class="btn btn-outline-warning xsmall_btn" onclick="changetab('Overview')" id="overview_btn">
                        <i class="fa fa-eye" style="font-weight: bold; font-size: small;" id="overview_icon"></i> 
                        <span style="font-size: small;">Overview</span>
                      </a>
                      <a class="btn btn-outline-warning xsmall_btn mx-2" onclick="changetab('Transaction')" id="transaction_btn">
                        <i class="fa fa-exchange" style="font-weight: bold;  font-size: small;" id="transaction_icon"></i>
                        <span style="font-size: small;">Transaction</span> 
                      </a>
                      <a class="btn btn-outline-warning xsmall_btn" onclick="changetab('Statement')" id="statement_btn">
                        <span class="fa fa-file-word" style="font-weight: bold;  font-size: small;" id="statement_icon"></span> 
                        <span style="font-size: small;">Statement</span>
                      </a>
                      </div>
                      
                    <div class="col-md-5">
                      <div class="d-sm-flex" style="float: right;">
                        <a onclick="ExportToExcel()" class="btn btn-outline-warning small_btn mt-2 d-none " id="exp" title="EXPORT" >
                          <i class='fas fa-file-export' ></i> 
                        </a>
                        <a class="btn btn-outline-warning small_btn mt-2 mx-2" title="EDIT" id="edit_btn" href="{% url 'edit_loanaccount' account.id %}">
                          <i class="fa fa-pencil"></i>
                        </a>
                        <a class="btn btn-outline-warning small_btn mt-2 " href="" data-toggle="modal" id="his" data-target="#commentModal2" data-toggle="tooltip" title="history">
                          <i class="fa-solid fa-clock-rotate-left"></i>
                        </a>
                        <a class="btn btn-outline-warning small_btn mt-2 mx-2 " href="" data-toggle="modal" id="com" data-target="#commentModal" data-toggle="tooltip" title="comment">
                          <i class="far fa-comment"></i>
                        </a>
                        <a class="btn btn-outline-warning small_btn mt-2  " href="{% url 'delete_loan' account_id=loan_info.bank_holder.id %}" title="DELETE" id="delete_btn">
                          <i class="fa fa-trash"></i>
                        </a>
                        <a class="btn btn-outline-warning small_btn mt-2  d-none" title="SHARE" id="share_btn"data-toggle="dropdown" >
                          <i class="fas fa-share"></i>
                        </a>
                        
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                          <a class="dropdown-item text-black" href="{% url 'share_email' account.id %}" data-toggle="modal" title="upload" data-target="#commentModal4" data-toggle="tooltip" title="comment">Mail</a>
                          <a class="dropdown-item text-black" href="#" onclick="shareViaWhatsApp()">whatsapp</a>
                        </div>
                        
                        <!-- <a class="btn btn-outline-warning small_btn mt-2" >
                          <i class="fas fa-paperclip"></i>
                        </a>
                        <div class="dropdown-menu">
                          <a class="dropdown-item text-black" data-toggle="modal" data-target="#bnk_files">Add Document</a>
                          {% if bnk.document != "" %} 
                          <a class="dropdown-item text-black" download href="{{bnk.document.url}}">Download Document</a>
                          {% endif %}
                        </div> -->
                        <a class="btn btn-outline-warning small_btn mt-2 mx-2 d-none" onclick="export_as_pdf()" title="PDF" id="pdf_btn"> 
                          <i class="fa fa-file-pdf"></i>
                        </a>
                        <!-- <a class="btn btn-outline-warning small_btn mt-2 d-none" onclick="window.print()" title="PRINT" id="print_btn">
                          <i class="fa fa-print"></i> 
                        </a> -->
                        <a class="btn btn-outline-warning small_btn mt-2 d-none" onclick="printfun()" title="PRINT" id="print_btn">
                          <i class="fa fa-print"></i> 
                        </a>
                        <a class="btn btn-outline-warning small_btn mt-2 mx-2" href="{% url 'update_status' account.id %}" title="STATUS" >{{loan_info.status}}</a>
                        
                      </div>
                    </div>
                  </div>
                  
                  
                  
                  <div class="row mt-5">
        
                    <div class="d-sm-flex" style="width: 30%;">
                      <input class="form-control text-black bg-light mt-4 d-none" type="text" id="search_tra" placeholder="Search..." style="margin-right: 10%;">
                    </div>
                    <div class="col-md-12 d-flex justify-content-end d-none" id="date-filter" >
                        <form id="date-filter-form" class="d-flex">
                            <div class="d-flex">
                                <!-- <label class="text-white mr-2">From:</label> -->
                                <input type="date" class="form-control form-control-sm text-white bg-black mr-2" id="start-date" name="startdate">
                            </div>
                            <div class="d-flex ">
                                <label class="text-white mr-2">To:</label>
                                <input type="date" class="form-control form-control-sm text-white bg-black mr-2" id="end-date" name="enddate">
                            </div>
                        </form>
                    </div>
                    <div class="col-md-12 d-flex justify-content-end d-none" id="date-fil" >
                      <form id="date-filter-form" class="d-flex">
                          <div class="d-flex">
                              <!-- <label class="text-white mr-2">From:</label> -->
                              <input type="date" class="form-control form-control-sm text-white bg-black mr-2" id="st-date" name="start_date">
                          </div>
                          <div class="d-flex ">
                              <label class="text-white mr-2">To:</label>
                              <input type="date" class="form-control form-control-sm text-white bg-black mr-2" id="en-date" name="end_date">
                          </div>
                      </form>
                  </div>

                </div><br>
                

                
                  <!-- repayment_due -->
                  <div class="modal fade" id="emi_repayment">
                    <div class="modal-dialog modal-lg">
                      <div class="modal-content" style="background:black; border: 1px solid #ffae1f;">
                        <div class="modal-body">
                          <div class="row">
                            <div class="col-md-10 p-4">
                              <h2 class="text-uppercase" style="color: white; font-weight: bolder;">Repayment Due</h2>
                            </div>
                            <div class="col-md-2 p-4">
                              <button type="button" class="btn close" data-dismiss="modal" aria-label="Close" style="float: right;">
                                <span aria-hidden="true" style="color: white; font-weight: bolder;">&times;</span>
                              </button>
                            </div>
                          </div><br>
                          <form action="{% url 'repayment_due_form' account.id %}" method="post" class="needs-validation"  autocomplete="off" id="dueemi">
                            {%csrf_token%}
                            <div class="row">
                              <div class="col-md-6">
                                <label for="dest" style="color: white;">Principal Amount</label>
                                <input type="text" class="form-control text-white bg-black mt-1" id="principal_amount" maxlength="10" name="principal_amount" required >
                              </div>
                              <div class="col-md-6">
                                <label for="date" style="color: white;">Date</label>
                                <input type="date" class="form-control text-white bg-black mt-1" id="date" value="{{ today_date }}"name="date">
                              </div>
                            </div>
        
                            <div class="row mt-3">
                              <div class="col-md-6">
                                <label for="amount" style="color: white;">Interest Amount</label>
                                <input type="number" class="form-control text-white bg-black mt-1" id="interest_amount" name="interest_amount">
                              </div>
                              <div class="col-md-6">
                                <label for="amount" style="color: white;">Total Amount</label>
                                <input type="number" class="form-control text-white bg-black mt-1" id="total_amount"  name="total_amount" readonly>
                              </div>
                              <div class="col-md-6">
                                <label for="origin" style="color: white;">Paid From</label>
                                <select class="form-control text-white bg-black form-select mt-1" id="payment_method" name="payment_method" required>
                                  <option value="" selected hidden>-- Select --</option>
                                  <option value="Cash">Cash</option>
                                  <option value="UPI">UPI</option>
                                  <option value="Cheque">Cheque</option>
                                  {% for bank in banks %}
                                  {% if bank.status == 'Active' %}
                                    <option value="{{ bank.id }}">{{ bank.bnk_name }}-( {{ bank.bnk_acno|slice:'-4:' }})</option>
                                    {% endif %}
                                  {% endfor %}
                                 
                                </select>
                              </div>
                              <div class="col-md-6" id="cheque_details" style="display: none;">
                                <label for="cheque_number" style="color: white;">Cheque Number</label>
                                <input type="text" class="form-control text-white bg-black mt-1" id="cheque_number" name="cheque_number">
                            </div>
                            <div class="col-md-6" id="upi_details" style="display: none;">
                                <label for="upi_id" style="color: white;">UPI ID</label>
                                <input type="text" class="form-control text-white bg-black mt-1" id="upi_id" name="upi_id">
                            </div>
                            <div class="col-md-6" id="acc_details" style="display: none;">
                              <label for="upi_id" style="color: white;">Account Number</label>
                              <input type="text" class="form-control text-white bg-black mt-1" id="acc_no" name="acc_no" readonly>
                          </div>
                              
                            </div>

                            <input type="hidden" id="selectedType" name="type">

                            <div class="row mt-3">
                              <div class="col-md-4"></div>
                              <div class="col-md-4">
                                <div class="d-flex">
                                  <button class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="submit" data-dismiss="modal" id="paySave">Save</button> 
                                  <input class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="reset" value="Reset">
                                </div>
                              </div>
                              <div class="col-md-4"></div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
    
                  <!-- new_loan -->
                  <div class="modal fade" id="additional_loan">
                    <div class="modal-dialog modal-lg">
                      <div class="modal-content" style="background:black; border: 1px solid #ffae1f;">
                        <div class="modal-body">
                          <div class="row">
                            <div class="col-md-10 p-4">
                              <h2 class="text-uppercase" style="color: white; font-weight: bolder;">Issue New Loan</h2>
                            </div>
                            <div class="col-md-2 p-4">
                              <button type="button" class="btn close" data-dismiss="modal" aria-label="Close" style="float: right;">
                                <span aria-hidden="true" style="color: white; font-weight: bolder;">&times;</span>
                              </button>
                            </div>
                          </div><br>
                          <form action="{% url 'new_loan' account.id %}" method="post" class="needs-validation"  autocomplete="off" id="newloan">
                            {%csrf_token%}
                            <div class="row">
                              <div class="col-md-6">
                                <label for="origin" style="color: white;">Balance Loan</label>
                                <input type="text" class="form-control text-white bg-black mt-1" id="balance" name="balance" value="{{ overall_balance }}" readonly>
                              </div>
                              <div class="col-md-6">
                                <label for="origin" style="color: white;">New Loan</label>
                                <input type="number" class="form-control text-white bg-black mt-1" id="principalamount" name="principal_amount" required>
                              </div>
                              
                            </div>
        
                            <div class="row mt-3">
                              <div class="col-md-6">
                                <label for="origin" style="color: white;">Interest Amount</label>
                                <input type="number" class="form-control text-white bg-black mt-1" id="interestamount" name="interest_amount" >
                              </div>
                              
                              <div class="col-md-6">
                                <label for="date" style="color: white;">Date</label>
                                <input type="date" class="form-control text-white bg-black mt-1" id="date" value="{{ today_date }}" name="date">
                              </div>
                            </div>
        
                            <div class="row mt-3">
                              <div class="col-md-6">
                                <label for="amount" style="color: white;">Total Loan</label>
                                <input type="number" class="form-control text-white bg-black mt-1" id="totalamount"  name="total_amount" readonly>
                              </div>
                              <div class="col-md-6">
                                <label for="dest" style="color: white;">Payment Method</label>
                                <select class="form-control text-white bg-black form-select mt-1" id="paymentmethod" name="payment_method" required>
                                  <option value="" hidden>-- Select --</option>
                                  
                                  <option value="Cash">Cash</option>
                                  <option value="UPI">UPI</option>
                                  <option value="Cheque">Cheque</option>
                                  {% for bank in banks %}
                                  {% if bank.status == 'Active' %}
                                        <option value="{{ bank.id }}">{{ bank.bnk_name }}-( {{ bank.bnk_acno|slice:'-4:' }})</option>
                                        {% endif %}
                                        {% endfor %}
                                  
                                </select>
                              </div>
                            </div>
                            <div class="row mt-3" id="chequedetails" style="display: none;">
                              <div class="col-md-6">
                                  <label for="cheque_number" style="color: white;">Cheque Number</label>
                                  <input type="text" class="form-control text-white bg-black mt-1" id="chequenumber" name="cheque_number" >
                              </div>
                          </div>
      
                          <!-- Text box for UPI -->
                          <div class="row mt-3" id="upidetails" style="display: none;">
                              <div class="col-md-6">
                                  <label for="upi_id" style="color: white;">UPI ID</label>
                                  <input type="text" class="form-control text-white bg-black mt-1" id="upiid" name="upi_id">
                              </div>
                              
                          </div>
                          <div class="row mt-3" id="accdetails" style="display: none;">
                            <div class="col-md-6">
                                <label for="upi_id" style="color: white;">Account Number</label>
                                <input type="text" class="form-control text-white bg-black mt-1" id="acc_num" name="acc_num" readonly>
                            </div>
                            
                        </div>
  
                            <input type="hidden" id="selectedTypeC" name="type">
  
                            <div class="row mt-3">
                              <div class="col-md-4"></div>
                              <div class="col-md-4">
                                <div class="d-flex">
                                  <button class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="submit" data-dismiss="modal" id="paySave" style="color: #ffae1f;">Save</button> 
                                  <input class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="reset" value="Reset" style="color: #ffae1f;">
                                </div>
                              </div>
                              <div class="col-md-4"></div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>  
    
                  

                <div id="Overview" style="background-color: #aba9a9;">
                  <div class="row">
                    <h1 class="text-black mt-3" style="text-align: center;">Loan Details</h1>
                    <hr class="text-black" style="margin-left: 5%; margin-right: 5%">
                    <div class="col-md-6 p-4">
                      <div class="bank-row d-md-flex">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Name</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{account.customer_name}}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Loan Status</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.status }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Loan amount</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.loan_amount }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Loan Date</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.loan_date }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Balance Loan</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ overall_balance }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Lender Bank</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.lender_bank }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Received Type</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.payment_method }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Interest</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.interest }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Terms</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.term }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Processing Fee</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.processing_fee }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Processing Method</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.processing_method }}</span>
                        </div>
                      </div>
                      <div class="bank-row d-md-flex mt-5">
                        <div class="col-md-5">
                            <span class="bank-label text-black">Description</span>
                        </div>
                        <div class="col-md-2 text-center">
                            <span class="bnk-colon text-black">:</span>
                        </div>
                        <div class="col-md-5 text-right">
                            <span class="bank-value text-black">{{ loan_info.description }}</span>
                        </div>
                      </div>
                      
                    </div>

                    <div class="col-md-6 p-4">
                      <div style="background-color: #383838; border-radius: 2vh;">
                        <br>
                        <h3 class="text-white" style="text-align: center;">Account Holder</h3>
                        <hr class="text-white" style="margin-left: 5%; margin-right: 5%">
                       
                        <div class="bank-row d-md-flex mt-4">
                          <div class="col-md-5">
                              <span class="bank-label text-white">Account Number</span>
                          </div>
                          <div class="col-md-2 text-center">
                              <span class="bnk-colon text-white">:</span>
                          </div>
                          <div class="col-md-5 text-right">
                              <span class="bank-value text-white">{{account.account_number}}</span>
                          </div>
                        </div>
                        <div class="bank-row d-md-flex mt-4">
                          <div class="col-md-5">
                              <span class="bank-label text-white">Mobile Number</span>
                          </div>
                          <div class="col-md-2 text-center">
                              <span class="bnk-colon text-white">:</span>
                          </div>
                          <div class="col-md-5 text-right">
                              <span class="bank-value text-white">{{account.phone_number}}</span>
                          </div>
                        </div>
                        <div class="bank-row d-md-flex mt-4">
                          <div class="col-md-5">
                              <span class="bank-label text-white">Email</span>
                          </div>
                          <div class="col-md-2 text-center">
                              <span class="bnk-colon text-white">:</span>
                          </div>
                          <div class="col-md-5 text-right">
                              <span class="bank-value text-white">{{account.email}}</span>
                          </div>
                        </div>
                        <div class="bank-row d-md-flex mt-4">
                          <div class="col-md-5">
                              <span class="bank-label text-white">Branch</span>
                          </div>
                          <div class="col-md-2 text-center">
                              <span class="bnk-colon text-white">:</span>
                          </div>
                          <div class="col-md-5 text-right">
                              <span class="bank-value text-white">{{account.branch_name}}</span>
                          </div>
                        </div>
                        <div class="bank-row d-md-flex mt-4">
                          <div class="col-md-5">
                              <span class="bank-label text-white">IFSC Code</span>
                          </div>
                          <div class="col-md-2 text-center">
                              <span class="bnk-colon text-white">:</span>
                          </div>
                          <div class="col-md-5 text-right">
                              <span class="bank-value text-white">{{account.ifsc_code}}</span>
                          </div>
                        </div>
                        <div class="bank-row d-md-flex mt-4">
                          {% if account.swift_code %}
                          <div class="col-md-5">
                              <span class="bank-label text-white">Swift Code</span>
                          </div>
                          <div class="col-md-2 text-center">
                              <span class="bnk-colon text-white">:</span>
                          </div>
                          <div class="col-md-5 text-right">
                              <span class="bank-value text-white">{{account.swift_code}}</span>
                          </div>
                          {%endif%}
                        </div>
                        <br>
                      </div>
                    </div>
                  </div>
                </div>

                <div id="Transaction" style="display: none;">
                  <div class="row mt-4"> 
                    <div class="col-md-6">
                      <div class="info-container"  style="padding-left: 5%;">
                        <div class="info-row d-md-flex">
                            <span class="info-label text-white"><h4 class="text-white">Loan Amount :</h4></span>
                            <span class="info-value text-white"><h4 class="text-white" id="loanAmount">{{ loan_info.loan_amount }}</h4></span>
                        </div>
                        <div class="info-row d-md-flex mt-3">
                            <span class="info-label text-white"><h4 class="text-white">Account Holder: </h4></span>
                            <span class="info-value text-white"><h4 class="text-white">&nbsp;{{ account.customer_name }}</h4></span>
                        </div>
                        <div class="info-row d-md-flex mt-3">
                            <span class="info-label text-white"><h4 class="text-white" style="white-space: nowrap;">Account Number :</h4></span>
                            <span class="info-value text-white"><h4 class="text-white">&nbsp;{{ account.account_number }}</h4></span>
                        </div>
                      </div>
                    </div>
  
                    <div class="col-md-6">
                      <div style="float: right; padding-right: 5%;" class="d-flex">
                        <h4 style="color: white;"> Balance:</h4>
                        <h4 class="text-white" id="totalBalance">{{overall_balance}}</h4>
                        </div>
                      
                        <div class=" form-group">
                          <select class="form-control form-select bg-black text-white" id="selectOption">
                            <option value="" class="hidden-option">Make Payment</option>
                            <option value="Repayment Due">Repayment Due</option>
                            <option value="Issue New Loan">Issue New Loan</option>
                            
                          </select>
                        </div>
                 
                      </div>
                    </div>
                 

                  <div class="table-responsive p-4">      
                    <table class="table tabcontent" style="display: inline-table;" id="transactiontable">
                      <thead>
                        <tr class="text-center text-white" style="font-weight: bold;">
                          <th>#</th>
                          <th>DATE</th>
                          <th>NAME</th>
                          <th>TYPE</th>
                          <th>AMOUNT</th>
                          <th>INTEREST</th>
                          <th>TOTAL AMOUNT</th>
                          <th hidden>Balance</th>
                          <th>ACTION</th>
                        </tr>
                      </thead>
                      <tbody>
                        
                        <tr class="text-white text-center">
                          <td>1</td>
                          <td>{{ loan_info.loan_date}}</td>
                          <td>{{ loan_info.bank_holder.customer_name}}</td>
                          <td>Opening Balance</td>
                          <td>{{ loan_info.loan_amount }}</td>
                          <td>{{ loan_info.interest }}</td>
                          <td>{{ total_amount }}</td>
                          <td hidden>{{ loan_info.loan_amount }}</td>

                          
                          <td>
                            <a class="btn medium_btn" data-toggle="dropdown">
                              <i class="fas fa-ellipsis-v text-warning"></i>
                            </a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item btn text-black" href="{% url 'edit_loanaccount' account.id %}">
                                &nbsp; <i class="fa fa-pencil"></i> &nbsp;&nbsp; <span style="font-size: medium;">Edit</span>
                              </a>
                              <a class="dropdown-item btn text-black" href="{% url 'delete_loan' account_id=loan_info.bank_holder.id %}">
                                &nbsp; <i class="fas fa-trash-alt"></i> &nbsp;&nbsp; <span style="font-size: medium;">Delete</span>
                              </a>
                              <a class="dropdown-item btn text-black" data-toggle="modal" id="his" data-target="#commentModal2" data-toggle="tooltip">
                                &nbsp; <i class="fas fa-history"></i> &nbsp;&nbsp; <span style="font-size: medium;">History</span>
                              </a>
                            </div>
                          </td>
                         
                          
                          
                        </tr>
                        {% for a in repayment_details %}
                        <tr class="text-white text-center">
                          {% with adjusted_counter=forloop.counter0|add:2 %}
                          <td>{{ adjusted_counter }}</td>
                          <td>{{ a.payment_date }}</td>
                          <td>{{ a.loan.bank_holder.customer_name}}</td>
                          <td>{{ a.type}}</td>
                          <td>{{ a.principal_amount }}</td>
                          <td>{{ a.interest_amount }}</td>
                          <td>{{ a.total_amount }}</td>
                          <td hidden>{{ a.balance }}</td>
                          
                          <td>
                            <a class="btn medium_btn" data-toggle="dropdown">
                              <i class="fas fa-ellipsis-v text-warning"></i>
                            </a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item btn text-black" href="{% if a.type == 'EMI paid' %}{% url 'edit_repayment' a.pk %}{% else %}{% url 'edit_additional_loan' a.pk %}{% endif %}">
                                  &nbsp; <i class="fa fa-pencil"></i> &nbsp;&nbsp; <span style="font-size: medium;">Edit</span>
                              </a>
                              <a class="dropdown-item btn text-black" href="{% url 'delete_repaymenttable' a.id %}">
                                &nbsp; <i class="fas fa-trash-alt"></i> &nbsp;&nbsp; <span style="font-size: medium;">Delete</span>
                              </a>
                              <a class="dropdown-item btn text-black" href="" data-toggle="modal" data-target="#historyModal{{ a.id }}">
                                &nbsp; <i class="fas fa-history"></i> &nbsp;&nbsp; <span style="font-size: medium;">History</span>
                            </a>
                            </div>
                          </td>
                        </tr>
                        {% endwith %}
                        {% endfor %}
                      </tbody>
                    </table> 
                  </div>
                </div>
                

                <div class="print-only tabcontent" id="Statement">
                  <div class="page" size="A4">
                    <div class="p-4">
                      <div id="ember2512" class="tooltip-container ember-view ribbon text-ellipsis">
                        <section>
                          <div class="text-center">
                            <h2 class="text-white bg-warning p-3">LOAN STATEMENT</h2>
                          </div>
                        </section>
                        <br>
                        <section class="store-user mt-2">
                          <div class="col-12">
                            <div class="row pb-3">
                              <div class="col-7">
                                <p><b class="text-black">COMPANY</b>,</p>
                                <div style="margin-left: 20%;">
                                  <h3>{{ loan_info.company.company_name }}</h3>
                                  <p class="text-black"> 
                                    {{ loan_info.company.contact }} <br>
                                    {{ loan_info.company.address }} <br>
                                    {{ loan_info.company.city }} <br>
                                    {{ loan_info.company.state|slice:'5:' }},
                                    {{ loan_info.company.country }} <br>
                                    {{ loan_info.company.pincode }}
                                  </p>
                                </div>
                              </div>
                              <div class="col-5">
                                <p><b class="text-black">LOAN</b>,</p>
                                <div style="margin-left: 20%;">
                                  <h3>{{ loan_info.bank_holder.customer_name }}</h3>
                                  <p class="text-black"> 
                                    
                                    {{ loan_info.bank_holder.email }} <br>
                                    {{loan_info.bank_holder.phone_number }}
                                  </p>
                                </div>
                              </div>
                            </div>

                            
                          </div>
                        </section>
                        <section class="store-user mt-5">
                          <div class="col-12">
                              <div class="row bb pb-4">
                                  
                                  <div class="col-9" style="padding-left: 10%;">
                                      <p style="color: #000000; font-weight:bold  ;">Loan Amount</p>
                                      <h5 style="color: #000000;font-weight:bold " id="loanAmounts"> {{ loan_info.loan_amount }}</h5>
                                 
                                   
                                  </div>
                                  <div class="col-3">
                                      <p style="color: #000000;font-weight:bold "> Balance</p>
                                      <h5 style="color: #000000;font-weight:bold " id="totalBalances">{{ overall_balance }}</h5>
                                  </div>
                                  
                             
                              </div>
                              
                          </div>
                      </section>

                        <section class="table-responsive mt-4">
                          <table class=" table table-hover table-bordered border-dark" id="statementtable">
                            <thead class="bg-warning">
                              <tr class="text-center text-white" style="font-weight: bold;">
                                <th style="width: 5%;">#</th>
                                <th>DATE</th>
                                <th>NAME</th>
                                <th>TYPE</th>
                                <th>AMOUNT</th>
                                <th>INTEREST</th>
                                <th>TOTAL AMOUNT</th>
                                <th>BALANCE</th>
                              </tr>
                            </thead>
                            <tbody>
                              
                              <tr class="text-black text-center">
                                
                                  <td>1</td>
                                  <td>{{ loan_info.loan_date}}</td>
                                  <td>{{ loan_info.bank_holder.customer_name}}</td>
                                  <td>Opening Balance</td>
                                  <td>{{ loan_info.loan_amount }}</td>
                                  <td>{{ loan_info.interest }}</td>
                                  <td>{{ total_amount }}</td>
                                  <td>{{ loan_info.loan_amount }}</td>
                              </tr>
                              {% for a ,balance in repayment_details_with_balances %}
                              <tr class="text-black text-center">
                                {% with adjusted_counter=forloop.counter0|add:2 %}
                                <td>{{ adjusted_counter }}</td>
                                <td>{{ a.payment_date }}</td>
                                <td>{{ a.loan.bank_holder.customer_name}}</td>
                                <td>{{ a.type}}</td>
                                <td>{{ a.principal_amount }}</td>
                                <td>{{ a.interest_amount }}</td>
                                <td>{{ a.total_amount }}</td>
                                <td>{{ balance }}</td>
   
                                </tr>
                                {% endwith %}
                                {% endfor %}
                             
                            </tbody>
                          </table><br><br>
                        </section>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div> 
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="commentModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"  aria-hidden="true" style="margin-top: 8vh;">
  <div class="modal-dialog" role="document">
    <div class="modal-content" style="background-color: #3b3b3b;">
      <div class="modal-header">
        <h3 class="modal-title text-light" id="exampleModalLabel">HISTORY</h3>
        <button type="button" class="btn close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" style="font-size: x-large;">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      <div class="container " >
        <table class="table text-light  " style="margin:3px; background-color: #000000;">
          <thead>
            <tr>
              <!-- <th>
                sl
              </th> -->
              <th>
                Date
              </th>
              <th>
                Action
              </th>
              <th>
                By
              </th>
            </tr>
          </thead>
          <tbody>
            {% for i in history %}
            <tr class="table-row">
              <!-- <td>{{forloop.counter}}</td> -->
              <td>{{i.date}}</td>
              <td>{{i.action}}</td>
              <td>{{i.login_details.first_name}} {{i.login_details.Last_name}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-warning" data-dismiss="modal">Close</button>

      </div>
    </div>
  </div>
</div>
</div>

<div class="modal fade" id="commentModal4" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"  aria-hidden="true" style="margin-top: 8vh;">
  <div class="modal-dialog" role="document">
    <div class="modal-content" style="background-color: #3b3b3b;">
      <div class="modal-header">
        <h3 class="modal-title text-light" id="exampleModalLabel">Share details</h3>
        <button type="button" class="btn close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" style="font-size: x-large;">&times;</span>
        </button>
      </div>
      <form action="{% url 'share_email' account.id %}" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-body">
          <input type="email" name="email" required style="color:white;" class="form-control">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-warning" data-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-outline-warning">Share</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-----**********Modal for viewing edit history ********-->
{% for a in repayment_details %}
<div class="modal fade" id="historyModal{{ a.id }}" tabindex="-1" role="dialog" aria-labelledby="historyModalLabel{{ repayment.id }}" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content" style="background-color: #3b3b3b;">
            <div class="modal-header">
                <h5 class="modal-title text-light" id="historyModalLabel{{ a.id }}"> HISTORY </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
              <div class="container " >
                <table class="table text-light  " style="margin:3px; background-color: #000000;">
                  <thead>
                    <tr>
                      <!-- <th>
                        sl
                      </th> -->
                      <th>
                        Date
                      </th>
                      <th>
                        Action
                      </th>
                      <th>
                        By
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    
                    {% for h in repayment_history %}
                    {%if  h.repayment.id == a.id %}
                    <tr class="table-row">
                      <!-- <td>{{forloop.counter}}</td> -->
                      <td>{{h.date}}</td>
                      <td>{{h.action}}</td>
                      <td>{{h.login_details.first_name}} {{h.login_details.Last_name}}</td>
                    </tr>
                    
                    {% endif %}
                    {% endfor %}
                    
                  </tbody>
                </table>
              </div>
            </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-outline-warning" data-dismiss="modal">Close</button>
        
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

        <div class="modal fade" id="commentModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"  aria-hidden="true" style="margin-top: 8vh;">
          <div class="modal-dialog" role="document">
            <div class="modal-content" style="background-color: #3b3b3b;">
              <div class="modal-header">
                <h3 class="modal-title text-light" id="exampleModalLabel">Add Comments</h3>
                <button type="button" class="btn close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true" style="font-size: x-large;">&times;</span>
                </button>
              </div>
              <form action="{% url 'adding_comment' account.id %}" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="modal-body" style="background-color: #3b3b3b;">
                  <textarea type="text" class="form-control text-light" name="comments"></textarea>
                  <div class="container-fluid">
                    <table class="table  text-white" style="margin:3px; background-color: #000000;">
                      <thead>
                        <tr>
                          <th style="text-align: center; font-size: large;">sl no.</th>
                          <th style="text-align: center; font-size: large;">Comments</th>
                          <th style="text-align: center; font-size: large;">By</th>
                          <th style="text-align: center; font-size: large;">Delete</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for c in comment %}
                          <tr class="table-row">
                            <td style="text-align: center;">{{forloop.counter }}</td>
                            <td style="text-align: center;">{{c.comment}}</td>
                            <td style="text-align: center;">{{c.login_details.first_name}} {{c.login_details.last_name}}</td>
                            <td style="text-align: center;">
                              <a class="text-danger" href="{% url 'delete_comment' c.id account.id %}"><i class="fa fa-trash" style="font-size:20px;"></i></a>
                            </td>
                          </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-outline-warning" data-dismiss="modal">Close</button>
                  <button type="submit" class="btn btn-outline-warning">Save</button>
                </div>
              </form>
            </div>
          </div>
        </div>
        
      

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script>
  $(document).ready(function() {
      $('#paymentmethod').change(function() {
          var selectedOption = $(this).val();
          if (selectedOption === 'Cheque') {
              $('#chequedetails').show();
              $('#upidetails').hide();
              $('#accdetails').hide()
          } else if (selectedOption === 'UPI') {
              $('#chequedetails').hide();
              $('#upidetails').show();
              $('#accdetails').hide()
          } else if(selectedOption==='Cash'){
              $('#chequedetails').hide();
              $('#upidetails').hide();
              $('#accdetails').hide()
          } else {
            console.log('Bank selected');
            $('#chequedetails').hide();
            $('#upidetails').hide();
            $('#accdetails').show()
            console.log('selectedOption');
            var bankId = $(this).val();
            $.ajax({
              url: '{% url "full_account_number" 0 %}'.replace('0', bankId),
           type: 'GET',
           
                                            
          success: function(response) {
          console.log('Success:', response);
          data=response.bank
          $('#acc_num').val(data);
          },
          error: function(xhr, status, error) {
          console.error(error);
          }
          });
          }
          });
          });
          $('#newloan').submit(function (e) {
        var selectedOption = $('#paymentmethod').val();
        if (selectedOption === 'UPI') {
            var upiId = $('#upiid').val();
           
            if (!upiId) {
                e.preventDefault(); // Prevent form submission
                alert('UPI ID is required.');
            }
        }else if(selectedOption === 'Cheque') {
            var cheq = $('#chequenumber').val();
            if (!cheq) {
                e.preventDefault(); // Prevent form submission
                alert('Cheque number is required.');
            }
        
        }
    });                                          
</script>

<script>
  $(document).ready(function() {
      $('#payment_method').change(function() {
          var selectedOption = $(this).val();
          if (selectedOption === 'Cheque') {
              $('#cheque_details').show();
              $('#upi_details').hide();
              $('#acc_details').hide()
          } else if (selectedOption === 'UPI') {
              $('#cheque_details').hide();
              $('#upi_details').show();
              $('#acc_details').hide()
          } else if(selectedOption==='Cash'){
              $('#cheque_details').hide();
              $('#upi_details').hide();
              $('#acc_details').hide()
          } else {
            console.log('Bank selected');
            $('#cheque_details').hide();
            $('#upi_details').hide();
            $('#acc_details').show()
            console.log('selectedOption');
            var bankId = $(this).val();
            $.ajax({
            url: '{% url "full_account_number" 0 %}'.replace('0', bankId),
           type: 'GET',
           
                                            
          success: function(response) {
          console.log('Success:', response);
          
          $('#acc_no').val(response.bank);
          },
          error: function(xhr, status, error) {
          console.error(error);
          }
          });
          }
          });
          }); 
          $('#dueemi').submit(function (e) {
        var selectedOption = $('#payment_method').val();
        if (selectedOption === 'UPI') {
            var pupiId = $('#upi_id').val();
            if (!pupiId) {
                e.preventDefault(); // Prevent form submission
                alert('UPI ID is required.');
            }
        }else if(selectedOption === 'Cheque') {
            var pcheq = $('#cheque_number').val();
            if (!pcheq) {
                e.preventDefault(); // Prevent form submission
                alert('Cheque number is required.');
            }
        
        }
    });
 
</script>
<script>
  document.getElementById('st-date').addEventListener('change', updateMinDate);
  function updateMinDate() {
      var selectedDate = document.getElementById('st-date').value;
      document.getElementById('en-date').min = selectedDate;
  }
</script>

<script>
  function filterTableByDate() {
      const fromDate = new Date(document.getElementById('st-date').value);
      const toDate = new Date(document.getElementById('en-date').value);
      const tableRows = document.querySelectorAll('#transactiontable tbody tr');
      let totalBalance = 0;

      tableRows.forEach(row => {
          const dateCell = new Date(row.cells[1].innerText);
          const cellDate = new Date(dateCell.getFullYear(), dateCell.getMonth(), dateCell.getDate());
          const fromDateTime = new Date(fromDate.getFullYear(), fromDate.getMonth(), fromDate.getDate());
          const toDateTime = new Date(toDate.getFullYear(), toDate.getMonth(), toDate.getDate());

          if ((!fromDate || cellDate >= fromDateTime) && (!toDate || cellDate <= toDateTime)) {
              row.style.display = '';
              totalBalance = parseFloat(row.cells[7].innerText); // Assuming balance is in the 7th cell
          } else {
              row.style.display = 'none';
          }
      });

      // Update the balance and loan amount in the HTML
      document.getElementById('totalBalance').innerText = totalBalance; // Adjust as per your data
      document.getElementById('loanAmount').innerText = totalBalance;

      // If both date inputs are cleared, reset table to show all rows and original loan amount
      if (!fromDate && !toDate) {
          tableRows.forEach(row => {
              row.style.display = ''; // Show all rows
          });
          
      }
  }

  // Listen for changes in date inputs
  document.getElementById('st-date').addEventListener('change', filterTableByDate);
  document.getElementById('en-date').addEventListener('change', filterTableByDate);
</script>


<script>
  document.getElementById('start-date').addEventListener('change', updateMinDate);
  function updateMinDate() {
      var selectedDate = document.getElementById('start-date').value;
      document.getElementById('end-date').min = selectedDate;
  }
</script>
<script>
  function filterTableDate() {
      const fromDate = new Date(document.getElementById('start-date').value);
      const toDate = new Date(document.getElementById('end-date').value);
      const tableRows = document.querySelectorAll('#statementtable tbody tr');
      let totalBalances = 0;

      tableRows.forEach(row => {
          const dateCell = new Date(row.cells[1].innerText);
          const cellDate = new Date(dateCell.getFullYear(), dateCell.getMonth(), dateCell.getDate());
          const fromDateTime = new Date(fromDate.getFullYear(), fromDate.getMonth(), fromDate.getDate());
          const toDateTime = new Date(toDate.getFullYear(), toDate.getMonth(), toDate.getDate());

          if ((!fromDate || cellDate >= fromDateTime) && (!toDate || cellDate <= toDateTime)) {
              row.style.display = '';
              totalBalances = parseFloat(row.cells[7].innerText); // Assuming balance is in the 7th cell
          } else {
              row.style.display = 'none';
          }
      });

      // Update the balance and loan amount in the HTML
      document.getElementById('totalBalances').innerText = totalBalances; // Adjust as per your data
      document.getElementById('loanAmounts').innerText = totalBalances;

      // If both date inputs are cleared, reset table to show all rows and original loan amount
      if (!fromDate && !toDate) {
          tableRows.forEach(row => {
              row.style.display = ''; // Show all rows
          });
          
      }
  }

  // Listen for changes in date inputs
  document.getElementById('start-date').addEventListener('change', filterTableDate);
  document.getElementById('end-date').addEventListener('change', filterTableDate);
</script>



<script>
  function ExportToExcel() {
    console.log("transactiontable");
    $('in1').prop
    const table = document.getElementById('transactiontable'); 
    const wb = XLSX.utils.table_to_book(table);

    XLSX.writeFile(wb, 'Transaction.xlsx');
}
</script>
<script>
  function shareViaWhatsApp() {
    // Replace 'Hello, this is a shared message!' with your desired message
    var message = encodeURIComponent(window.location.href);

    // Create the WhatsApp share link
    var whatsappLink = 'https://wa.me/?text=' + message;

    // Open the link in a new tab/window
    window.open(whatsappLink, '_blank');
  }
</script> 
<!-- <script>
  $(document).ready(function() {
      $('#status_btn').click(function(e) {
          e.preventDefault();
          var loanAccountId = '{{ account.id }}'; 
          var currentStatus = $(this).text().trim();
          var newStatus = (currentStatus === 'Active') ? 'Inactive' : 'Active';
          var $button = $(this); // Store reference to the button element

        // Update button text immediately
          $button.text(newStatus);
  
          $.ajax({
              type: 'POST',
              url: '{% url "update_status" account.id  %}',
              data: {
                'account_id': loanAccountId,
                  'csrfmiddlewaretoken': '{{ csrf_token }}'
              },
              success: function(response) {
                $('#status_btn').text(response.new_status);
              },
              error: function(xhr, status, error) {
                $('#status_btn').text(currentStatus);
              }
          });
      });
  });
  </script> -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        var principalInput = document.getElementById('principalamount');
        var interestInput = document.getElementById('interestamount');
        var totalAmountInput = document.getElementById('totalamount');
  
        function calculateTotal() {
            var principal = parseFloat(principalInput.value) || 0;
            var interest = parseFloat(interestInput.value) || 0;
            var total = principal + interest;
            totalAmountInput.value = total.toFixed();
        }
  
        principalInput.addEventListener('input', calculateTotal);
        interestInput.addEventListener('input', calculateTotal);
        calculateTotal(); 
    });
  </script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
      var principalInput = document.getElementById('principal_amount');
      var interestInput = document.getElementById('interest_amount');
      var totalAmountInput = document.getElementById('total_amount');

      function calculateTotal() {
          var principal = parseFloat(principalInput.value) || 0;
          var interest = parseFloat(interestInput.value) || 0;
          var total = principal + interest;
          totalAmountInput.value = total.toFixed();
      }

      principalInput.addEventListener('input', calculateTotal);
      interestInput.addEventListener('input', calculateTotal);
      calculateTotal(); 
  });
</script>
<script>
  $(document).ready(function() {
    show_div = '{{show_div}}'
    if (show_div == 'True'){
      changetab('Transaction')
    }
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var table = document.getElementById('transactiontable');
    var rows = table.querySelectorAll('tbody tr');
    rows.forEach(function(row) {
      var cells = row.querySelectorAll('td');
      if (cells[3].innerText == 'Balance Decrease'){
        text = cells[4].innerText
        cells[4].innerText = parseFloat(-text)
      }
    });
  });

  document.addEventListener('DOMContentLoaded', function() {
    var table = document.getElementById('statementtable');
    var rows = table.querySelectorAll('tbody tr');
    rows.forEach(function(row) {
      var cells = row.querySelectorAll('td');
      if (cells[3].innerText == 'Balance Decrease'){
        text = cells[4].innerText
        cells[4].innerText = parseFloat(-text)
      }
    });
  });
</script>

<script>
  $(document).ready(function() {
    var $rows = $('#sidetable tbody tr');
    $('#search').keyup(function() {
      var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
      $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
      }).hide();
    });
  });
  $('.dropdown-toggle').dropdown();
</script>
<script>
  $(document).ready(function() {
    var $rows = $('#transactiontable tbody tr');
    $('#search_tra').keyup(function() {
      var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
      $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
      }).hide();
    });
  });
  $('.dropdown-toggle').dropdown();
</script>

<script>
 function sorttable(col) {
    var table = document.getElementById('sidetable');
    var tbody = table.querySelector('tbody');
    var rows = Array.from(tbody.querySelectorAll('tr'));
    if (col == 1){
      rows.sort(function(a, b) {
          var balanceA = parseFloat(a.querySelector('.bal').innerText.replace(/[^\d.-]/g, ''));
          var balanceB = parseFloat(b.querySelector('.bal').innerText.replace(/[^\d.-]/g, ''));
          return balanceA - balanceB;
      });
    }else{
      rows.sort(function(a, b) {
          var nameA = a.querySelector('.name').innerText.toLowerCase();
          var nameB = b.querySelector('.name').innerText.toLowerCase();
          return nameA.localeCompare(nameB);
      });
    }
    tbody.innerHTML = '';
    rows.forEach(function(row) {
      tbody.appendChild(row);
    });
  }
</script>

<script>
  function filtertable(key) {
    var rows = document.querySelectorAll('#sidetable tbody tr');
    rows.forEach(function(row) {
        var cell = row.querySelector('.stat');
        var status = cell.innerText.trim();
        if (status === key) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
  }
</script>

<script>
  $('#alert_close').click(function(){
    $('#alert_danger').hide()
  })
</script>

<!-- <script>
  $('#corigin').change(function(){
    $('#cdest').empty();
    $('#cdest').append($('<option selected hidden></option>').text('-- Select a Bank --').val(''));
    var options = $('#corigin option:not(:first-child)');
    options.each(function() {
      if($(this).val() != $('#corigin').val()){
        $('#cdest').append($('<option></option>').text($(this).text()).val($(this).val()));
      }
    });
  })

  $('#btborigin').change(function(){
    val = $('#btbdest').val()
    $('#btbdest').empty();
    $('#btbdest').append($('<option selected hidden></option>').text('-- Select a Bank --').val(''));
    var options = $('#btborigin option:not(:first-child)');
    options.each(function() {
      if($(this).val() != $('#btborigin').val()){
        if($(this).val() == val){
          $('#btbdest').append($('<option selected></option>').text($(this).text()).val($(this).val()));
        }else{
          $('#btbdest').append($('<option></option>').text($(this).text()).val($(this).val()));
        }
      }
    });
  })
</script> -->

<!-- <script>
  function edit_trans_details(id) {
    $.ajax({
      type: "POST", 
      url: "#",
      data: {
        'account_id': id
      },
      beforeSend: function (xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
      },
      success: function (response) {
        if(response.ttype == 'Repayment Due'){
          $('#edit_emi').modal('show');
          document.getElementById('eselectedType').value = 'Repayment Due';
          $('#principal_amount').val(response.trans_id)
          $('#date').val(response.origin)
          $('#interest_amount').val(response.trans_amount)
          $('#total_amount').val(response.trans_adj_date)
          $('#payment_method').val(response.trans_desc)

        }else if(response.ttype == 'Cash to Bank'){
          $('#edit_cash_to_bank').modal('show');
          document.getElementById('eselectedTypeC').value = 'Cash To Bank Transfer';
          $('#ctbid').val(response.trans_id)
          $('#ctbdest').val(response.destination)
          $('#ctbamount').val(response.trans_amount)
          $('#ctbdate').val(response.trans_adj_date)
          $('#ctbdescription').val(response.trans_desc)

        }else if(response.ttype == 'Bank to Bank'){
          $('#edit_bank_to_bank').modal('show');
          document.getElementById('eselectedTypeB').value = 'Bank To Bank Transfer';
          $('#btbid').val(response.trans_id)
          $('#btborigin').val(response.origin)
          $('#btbdest').val(response.destination)
          $('#btbamount').val(response.trans_amount)
          $('#btbdate').val(response.trans_adj_date)
          $('#btbdescription').val(response.trans_desc)
          $('#btbdest').find('option[value="' + response.origin + '"]').remove();

        }else if(response.ttype == 'Bank Adjustment'){
          $('#edit_adjbank').modal('show');
          document.getElementById('eselectedTypeA').value = 'Adjust Bank Balance';
          if(response.trans_adj_type == 'Balance Increase'){
            $('#eadjtype').val('Increase Balance')
          }else{
            $('#eadjtype').val('Reduce Balance')
          }
          $('#adjid').val(response.trans_id)
          $('#eadjacname').val(response.origin)
          $('#adjamount').val(response.trans_amount)
          $('#adjdate').val(response.trans_adj_date)
          $('#adjdescription').val(response.trans_desc)
        }
      },
    });
  }
</script> -->

<!-- <script>
  $("#btcpaysave").click(function () {
    $('#edit_emi').modal('hide');
    $.ajax({
      type: "POST", 
      url: "#",
      data: {
        principal_amount : document.getElementById('principal_amount').value,
        date : document.getElementById('date').value,
        interest_amount : document.getElementById('interest_amount').value,
        total_amount : document.getElementById('total_amount').value,
        payment_method : document.getElementById('payment_method').value,
        type : 'Repayment Due'
      },
      beforeSend: function (xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
      },
      success: function (response) {
        window.location.href = '?Transaction=True';
      },
    });
  });

  $("#ctbpaysave").click(function () {
    $('#edit_cash_to_bank').modal('hide');
    $.ajax({
      type: "POST", 
      url: "#",
      data: {
        id : document.getElementById('ctbid').value,
        dest : document.getElementById('ctbdest').value,
        amount : document.getElementById('ctbamount').value,
        edit_date : document.getElementById('ctbdate').value,
        desc : document.getElementById('ctbdescription').value,
        type : 'Cash To Bank Transfer'
      },
      beforeSend: function (xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
      },
      success: function (response) {
        window.location.href = '?Transaction=True';
      },
    });
  });

  $("#btbpaysave").click(function () {
    $('#edit_bank_to_bank').modal('hide');
    $.ajax({
      type: "POST", 
      url: "#",
      data: {
        id : document.getElementById('btbid').value,
        origin : document.getElementById('btborigin').value,
        dest : document.getElementById('btbdest').value,
        amount : document.getElementById('btbamount').value,
        edit_date : document.getElementById('btbdate').value,
        desc : document.getElementById('btbdescription').value,
        type : 'Bank To Bank Transfer'
      },
      beforeSend: function (xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
      },
      success: function (response) {
        window.location.href = '?Transaction=True';
      },
    });
  });

  $("#adjpaysave").click(function () {
    $('#edit_adjbank').modal('hide');
    $.ajax({
      type: "POST", 
      url: "#",
      data: {
        id : document.getElementById('adjid').value,
        adjacname : document.getElementById('eadjacname').value,
        adjtype : document.getElementById('eadjtype').value,
        amount : document.getElementById('adjamount').value,
        edit_date : document.getElementById('adjdate').value,
        desc : document.getElementById('adjdescription').value,
        type : 'Adjust Bank Balance'
      },
      beforeSend: function (xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
      },
      success: function (response) {
        window.location.href = '?Transaction=True';
      },
    });
  });
</script> -->

<script>
  document.querySelector('#edit_emi .close').addEventListener('click', function() {
    $('#edit_emi').modal('hide');
    window.location.href = '?Transaction=True';
  });

  document.querySelector('#edit_cash_to_bank .close').addEventListener('click', function() {
    $('#edit_cash_to_bank').modal('hide');
    window.location.href = '?Transaction=True';
  });
  
  document.querySelector('#edit_bank_to_bank .close').addEventListener('click', function() {
    $('#edit_bank_to_bank').modal('hide');
    window.location.href = '?Transaction=True';
  });

  document.querySelector('#edit_adjbank .close').addEventListener('click', function() {
    $('#edit_adjbank').modal('hide');
    window.location.href = '?Transaction=True';
  });
</script>

<!-- Bank to Cash -->
<script>
  document.getElementById('selectOption').addEventListener('change', function() {
    var selectedValue = this.value;
    if (selectedValue === 'Repayment Due') {
      $('#emi_repayment').modal('show');
      document.getElementById('selectedType').value = selectedValue;
    } else {
      $('#emi_repayment').modal('hide');
    }
  });

  document.querySelector('#emi_repayment .close').addEventListener('click', function() {
    $('#emi_repayment').modal('hide');
    window.location.href = '?Transaction=True';
  });
</script>

<!-- Cash to Bank -->
<script>
  document.getElementById('selectOption').addEventListener('change', function() {
    var selectedValue = this.value;
    if (selectedValue === 'Issue New Loan') {
      $('#additional_loan').modal('show');
      document.getElementById('selectedTypeC').value = selectedValue;
    } else {
      $('#additional_loan').modal('hide');
    }
  });
  document.querySelector('#additional_loan .close').addEventListener('click', function() {
    $('#additional_loan').modal('hide');
    window.location.href = '?Transaction=True';
  });
</script>

<!-- Bank to Bank -->
<!-- <script>
  document.getElementById('selectOption').addEventListener('change', function() {
    var selectedValue = this.value;
    if (selectedValue === 'Bank To Bank Transfer') {
      $('#bank_to_bank').modal('show');
      document.getElementById('selectedTypeB').value = selectedValue;
    } else {
      $('#bank_to_bank').modal('hide');
    }
  });
  document.querySelector('#bank_to_bank .close').addEventListener('click', function() {
    $('#bank_to_bank').modal('hide');
    window.location.href = '?Transaction=True';
  });
</script> -->

<!-- Adjust Balance -->
<!-- <script>
  document.getElementById('selectOption').addEventListener('change', function() {
    var selectedValue = this.value;
    if (selectedValue === 'Adjust Bank Balance') {
      $('#adjbank').modal('show');
      document.getElementById('selectedTypeA').value = selectedValue;
    } else {
      $('#adjbank').modal('hide');
    }
  });
  document.querySelector('#adjbank .close').addEventListener('click', function() {
    $('#adjbank').modal('hide');
    window.location.href = '?Transaction=True';
  });
</script> -->

<script>
  jQuery(document).ready(function($){
    $(".clickable-row").click(function (){
      window.location = $(this).data("href")
    });
  });
</script>

<script>
  $(document).ready(function() {
    var $rows = $('#table tbody tr');
    $('#search').keyup(function() {
      var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
      $rows.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
      }).hide();
    });
  });

  $(document).ready(function () {
    $("#fileSave").click(function () {
      var formData = new FormData();
      formData.append('id', $("#file_id").val());
      formData.append('file', $("#filess")[0].files[0]); 
      formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');

      $.ajax({
        type: 'POST',
        url: "",
        data: formData,
        processData: false,
        contentType: false,
        success: function (response) {
          document.getElementById("modalAddfile").reset();
          location.reload();
        },
      });
    });
  });
</script>
<script>

  // function printfun() {
  //   var printContents = $("#Statement").clone(); // Clone the content-div to avoid modifying the original content
  //   printContents.find('.hideon-print').remove(); // Remove columns by class name

  //   var $printerDiv = $('<div class="printContainer" id=printContainer></div>');
  //   $printerDiv.html(printContents.html());
  //   $('body').append($printerDiv).addClass("printingContent");
  //   var h1Element = document.createElement("h1");
  //   var head = document.getElementById("printContainer");
  //   head.insertBefore(h1Element, head.firstChild);
  //   window.print();
  //   $printerDiv.remove();
  //   $('body').removeClass("printingContent");


  //}
  function printfun(){
         var printContents = document.getElementById("Statement").innerHTML;
      var $printerDiv = $('<div class="printContainer"></div>'); // create the div that will contain the stuff to be printed
      $printerDiv.html(printContents); // add the content to be printed
      //alert(printContents);
      // $('body').append($printerDiv).addClass("printingContent"); // add the div to body, and make the body aware of printing (we apply a set of css styles to the body to hide its contents)

      window.print(); // call print
      $printerDiv.remove(); // remove the div
      $('body').removeClass("printingContent");
   }
//   function printfun() {
//     // Open a new window for printing
//     var printWindow = window.open('', '_self');
    
//     // Get the content you want to print
//     var contentToPrint = document.getElementById("Statement").innerHTML;
    
//     // Write the content into the new window
//     printWindow.document.write('<html><head><title>Print</title></head><body>' + contentToPrint + '</body></html>');
    
//     // Print the content
//     printWindow.print();
    
//     // Close the new window
//     printWindow.close();
// }
</script>


<script>
  loanpage = '{{loanpage}}'
  if(loanpage == '1'){
    changetab('Transaction')
  }else  if (loanpage == '2'){
    changetab('Statement')
  }else{
    changetab('Overview')
  }
  function changetab(tab) {
    if (tab === "Overview") {
      document.getElementById('Overview').style.display = "block"; 
      document.getElementById('overview_btn').style.backgroundColor = "#ffae1f";    
      document.getElementById('overview_btn').style.color = "black";    
      document.getElementById('overview_btn').style.fontWeight = 'bold';    
      document.getElementById('overview_icon').style.fontWeight = 'bold';
      document.getElementById('Transaction').style.display = "none"; 
      document.getElementById('transaction_btn').style.backgroundColor = "black";    
      document.getElementById('transaction_btn').style.color = "#ffae1f";    
      document.getElementById('transaction_btn').style.fontWeight = 'lighter';
      document.getElementById('transaction_icon').style.fontWeight = 'lighter';
      document.getElementById('Statement').style.display = "none"; 
      document.getElementById('statement_btn').style.backgroundColor = "black";    
      document.getElementById('statement_btn').style.color = "#ffae1f";    
      document.getElementById('statement_btn').style.fontWeight = 'lighter';
      document.getElementById('statement_icon').style.fontWeight = 'lighter';
      document.getElementById('pdf_btn').classList.remove('d-block');
      document.getElementById('pdf_btn').classList.add('d-none');
      document.getElementById('print_btn').classList.remove('d-block');
      document.getElementById('print_btn').classList.add('d-none');
      document.getElementById('edit_btn').classList.remove('d-none');
      document.getElementById('edit_btn').classList.add('d-block');
      document.getElementById('delete_btn').classList.remove('d-none');
      document.getElementById('delete_btn').classList.add('d-block');
      document.getElementById('share_btn').classList.remove('d-block');
      document.getElementById('share_btn').classList.add('d-none');
      document.getElementById('date-filter').classList.remove('d-block');
      document.getElementById('date-filter').classList.add('d-none');
      document.getElementById('date-fil').classList.remove('d-block');
      document.getElementById('date-fil').classList.add('d-none');
      document.getElementById('exp').classList.remove('d-block');
      document.getElementById('exp').classList.add('d-none');
      document.getElementById('search_tra').classList.remove('d-block');
      document.getElementById('search_tra').classList.add('d-none');
     
      document.getElementById('com').style.display = 'block';
      
      document.getElementById('his').style.display = 'block';
      
      document.getElementById('over').style.display = 'block'
      document.getElementById('tran').style.display = 'none'
      document.getElementById('state').style.display = 'none'

    } else if (tab === "Transaction") {
      document.getElementById('Overview').style.display = "none"; 
      document.getElementById('overview_btn').style.backgroundColor = "black";    
      document.getElementById('overview_btn').style.color = "#ffae1f";  
      document.getElementById('overview_btn').style.fontWeight = 'lighter';    
      document.getElementById('overview_icon').style.fontWeight = 'lighter';
      document.getElementById('Transaction').style.display = "block"; 
      document.getElementById('transaction_btn').style.backgroundColor = "#ffae1f";    
      document.getElementById('transaction_btn').style.color = "black";    
      document.getElementById('transaction_btn').style.fontWeight = 'bold';
      document.getElementById('transaction_icon').style.fontWeight = 'bold';
      document.getElementById('Statement').style.display = "none"; 
      document.getElementById('statement_btn').style.backgroundColor = "black";    
      document.getElementById('statement_btn').style.color = "#ffae1f";    
      document.getElementById('statement_btn').style.fontWeight = 'lighter';    
      document.getElementById('statement_icon').style.fontWeight = 'lighter';
      document.getElementById('pdf_btn').classList.remove('d-block');
      document.getElementById('pdf_btn').classList.add('d-none');
      document.getElementById('print_btn').classList.remove('d-block');
      document.getElementById('print_btn').classList.add('d-none');
      document.getElementById('edit_btn').classList.remove('d-block');
      document.getElementById('edit_btn').classList.add('d-none');
      document.getElementById('delete_btn').classList.remove('d-block');
      document.getElementById('delete_btn').classList.add('d-none');
      document.getElementById('share_btn').classList.remove('d-block');
      document.getElementById('share_btn').classList.add('d-none');
      document.getElementById('date-filter').classList.remove('d-block');
      document.getElementById('date-filter').classList.add('d-none');
      document.getElementById('date-fil').classList.remove('d-none');
      document.getElementById('date-fil').classList.add('d-block');
      document.getElementById('exp').classList.add('d-block');
      document.getElementById('exp').classList.remove('d-none');
      document.getElementById('search_tra').classList.add('d-block');
      document.getElementById('search_tra').classList.remove('d-none');
      // document.getElementById('com').classList.add('d-none');
      // document.getElementById('date-filter').classList.add('d-none');
      document.getElementById('com').style.display = 'none';
     
      document.getElementById('his').style.display = 'none';
      
      document.getElementById('over').style.display = 'none'
      document.getElementById('tran').style.display = 'block'
      document.getElementById('state').style.display = 'none'
    } else {
      document.getElementById('Overview').style.display = "none"; 
      document.getElementById('overview_btn').style.backgroundColor = "black";    
      document.getElementById('overview_btn').style.color = "#ffae1f";  
      document.getElementById('overview_btn').style.fontWeight = 'lighter';    
      document.getElementById('overview_icon').style.fontWeight = 'lighter';
      document.getElementById('Statement').style.display = "block"; 
      document.getElementById('Transaction').style.display = "none"; 
      document.getElementById('transaction_btn').style.backgroundColor = "black";    
      document.getElementById('transaction_btn').style.color = "#ffae1f";    
      document.getElementById('transaction_btn').style.fontWeight = 'lighter';
      document.getElementById('transaction_icon').style.fontWeight = 'lighter';
      document.getElementById('statement_btn').style.backgroundColor = "#ffae1f";    
      document.getElementById('statement_btn').style.color = "black";    
      document.getElementById('statement_btn').style.fontWeight = 'bold';    
      document.getElementById('statement_icon').style.fontWeight = 'bold';
      document.getElementById('pdf_btn').classList.remove('d-none');
      document.getElementById('pdf_btn').classList.add('d-block');
      document.getElementById('print_btn').classList.remove('d-none');
      document.getElementById('print_btn').classList.add('d-block');
      document.getElementById('edit_btn').classList.remove('d-block');
      document.getElementById('edit_btn').classList.add('d-none');
      document.getElementById('delete_btn').classList.remove('d-block');
      document.getElementById('delete_btn').classList.add('d-none');
      document.getElementById('share_btn').classList.remove('d-none');
      document.getElementById('share_btn').classList.add('d-block');
      document.getElementById('date-filter').classList.remove('d-none');
      document.getElementById('date-filter').classList.add('d-block');
      document.getElementById('date-fil').classList.remove('d-block');
      document.getElementById('date-fil').classList.add('d-none');
      document.getElementById('exp').classList.remove('d-block');
      document.getElementById('exp').classList.add('d-none');
      document.getElementById('search_tra').classList.add('d-none');
      document.getElementById('search_tra').classList.remove('d-block');
      // document.getElementById('com').classList.remove('d-none');
      // document.getElementById('date-filter').classList.add('d-none');
      document.getElementById('com').style.display = 'none';
      document.getElementById('his').style.display = 'none';
      document.getElementById('exp').style.display = 'none';
      document.getElementById('over').style.display = 'none'
      document.getElementById('tran').style.display = 'none'
      document.getElementById('state').style.display = 'block'
    }
  }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<script>
  function export_as_pdf() {
    const content = document.getElementById('Statement');
    html2pdf().from(content).save('statement.pdf');
  }
</script>
{% endblock %}
